{"url":"https://api.github.com/repos/owncloud/core/issues/5803","labels_url":"https://api.github.com/repos/owncloud/core/issues/5803/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/5803/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/5803/events","html_url":"https://github.com/owncloud/core/pull/5803","id":22449238,"number":5803,"title":"[wip/discussion] replace part files","user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":5,"created_at":"2013-11-11t13:48:29z","updated_at":"2013-11-26t17:27:14z","closed_at":"2013-11-14t19:46:05z","pull_request":{"html_url":"https://github.com/owncloud/core/pull/5803","diff_url":"https://github.com/owncloud/core/pull/5803.diff","patch_url":"https://github.com/owncloud/core/pull/5803.patch"},"body":"don't merge this pull request! it is work in progress and need some discussion!\r\n\r\ncc @deepdiver1975 @butonic @icewind1991 @pvince81 \r\n\r\nthis is more or less a skeleton  to replace the part files with some flags in the file cache as discussed with jã¶rn during the developer meeting in stuttgart. it still misses the file cache code to set/get the flags.\r\n\r\nthe main idea was to hide files as long as they are not complete and only show them if the upload was completed. this works nicely for new files but during implementation and discussion with vincent i discovered some other issues with this approach:\r\n\r\nhow do we handle file updates? right now a file update gets written to the part file and moved to the original file once the part file is completed. without the .part files we would write to the real file directly. during this file operation we could either set the file state to \"incomplete\" which would result in following problem:\r\n\r\n- during upload the file would disappear from the web interface and from possible webdav mounts which would be quite irritating for the user.\r\n- it could even happen that the sync client would delete the local copy of the file because he would think that the file is gone. \r\n\r\nor we would keep the file state \"completed\":\r\n\r\n- the file would stay in the web interface\r\n- but which file size would we show to the user during upload?\r\n- what would happen if the user tries to download/open the file during upload?\r\n\r\nregarding pull request  #5447, i don't think the switch from part files to the flags would solve the issue. we would still have the problem that we could assemble two parallel upload to the same target file. so here we would still need some kind of part files with a random id.\r\n\r\nright now i'm no longer sure if this is really the right approach. especially if we would have to introduce some kind of part files again to solve #5447 after we replaced them with the flags.\r\n\r\ndid i missed something? what do you think?","closed_by":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false}}