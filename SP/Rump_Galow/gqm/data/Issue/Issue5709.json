{"url":"https://api.github.com/repos/owncloud/core/issues/5709","labels_url":"https://api.github.com/repos/owncloud/core/issues/5709/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/5709/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/5709/events","html_url":"https://github.com/owncloud/core/issues/5709","id":22153547,"number":5709,"title":"ldap sometimes binds, sometimes fails, and never can login","user":{"login":"sakuramboo","id":1666914,"avatar_url":"https://gravatar.com/avatar/5c19d9042db8046437d7d34eeb97fd22?d=https%3a%2f%2fidenticons.github.com%2f9ff0777fe1f32efb89cddef43d66a035.png&r=x","gravatar_id":"5c19d9042db8046437d7d34eeb97fd22","url":"https://api.github.com/users/sakuramboo","html_url":"https://github.com/sakuramboo","followers_url":"https://api.github.com/users/sakuramboo/followers","following_url":"https://api.github.com/users/sakuramboo/following{/other_user}","gists_url":"https://api.github.com/users/sakuramboo/gists{/gist_id}","starred_url":"https://api.github.com/users/sakuramboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sakuramboo/subscriptions","organizations_url":"https://api.github.com/users/sakuramboo/orgs","repos_url":"https://api.github.com/users/sakuramboo/repos","events_url":"https://api.github.com/users/sakuramboo/events{/privacy}","received_events_url":"https://api.github.com/users/sakuramboo/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3auser_ldap","name":"app:user_ldap","color":"02d7e1"}],"state":"closed","assignee":null,"milestone":null,"comments":19,"created_at":"2013-11-05t21:44:07z","updated_at":"2013-11-07t16:49:22z","closed_at":"2013-11-07t16:49:22z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"root@owncloud:~# dpkg-query -s php5 owncloud apache2 | grep -e package -e version\r\npackage: php5\r\nversion: 5.4.4-14+deb7u5\r\npackage: owncloud\r\nversion: 5.0.13-0\r\npackage: apache2\r\nversion: 2.2.22-13\r\nroot@owncloud:~# cat /etc/debian_version\r\n7.2\r\n\r\nit seems that sometimes the ldap bind will succeed, but not always. here is what i see in the logs.\r\n\r\n\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: -1: can't contact ldap server\",\"level\":3,\"time\":\"2013-11-05t19:51:39+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: -1: can't contact ldap server\",\"level\":3,\"time\":\"2013-11-05t19:51:39+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"connection could not be established\",\"level\":3,\"time\":\"2013-11-05t19:51:39+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: -1: can't contact ldap server\",\"level\":3,\"time\":\"2013-11-05t19:55:34+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: -1: can't contact ldap server\",\"level\":3,\"time\":\"2013-11-05t19:55:34+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"connection could not be established\",\"level\":3,\"time\":\"2013-11-05t19:55:34+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: -1: can't contact ldap server\",\"level\":3,\"time\":\"2013-11-05t19:55:34+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"connection could not be established\",\"level\":3,\"time\":\"2013-11-05t19:55:34+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: -1: can't contact ldap server\",\"level\":3,\"time\":\"2013-11-05t19:57:44+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: -1: can't contact ldap server\",\"level\":3,\"time\":\"2013-11-05t19:57:44+00:00\"}\r\n{\"app\":\"user_ldap\",\"message\":\"connection could not be established\",\"level\":3,\"time\":\"2013-11-05t19:57:44+00:00\"}\r\n\r\nbut, it doesn't always fail. the times it does not fail, nothing appears in the logs, test connection will tell me it succeeded, but trying to login with an ldap account still fails and nothing on the ad event viewer tells me a login attempt even happened (though the bind account does authenticate and succeeds).\r\n\r\nsome of the things i have noticed...\r\n\r\nif i make a change to any setting that deals with the dn's, i must also change the host address or the test connection will fail. i don't have to actually change the host entry, i just need to delete a character and put it back and it will succeed.\r\n\r\ntesting ldap lookups with ldapsearch succeeds every time.","closed_by":{"login":"sakuramboo","id":1666914,"avatar_url":"https://gravatar.com/avatar/5c19d9042db8046437d7d34eeb97fd22?d=https%3a%2f%2fidenticons.github.com%2f9ff0777fe1f32efb89cddef43d66a035.png&r=x","gravatar_id":"5c19d9042db8046437d7d34eeb97fd22","url":"https://api.github.com/users/sakuramboo","html_url":"https://github.com/sakuramboo","followers_url":"https://api.github.com/users/sakuramboo/followers","following_url":"https://api.github.com/users/sakuramboo/following{/other_user}","gists_url":"https://api.github.com/users/sakuramboo/gists{/gist_id}","starred_url":"https://api.github.com/users/sakuramboo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sakuramboo/subscriptions","organizations_url":"https://api.github.com/users/sakuramboo/orgs","repos_url":"https://api.github.com/users/sakuramboo/repos","events_url":"https://api.github.com/users/sakuramboo/events{/privacy}","received_events_url":"https://api.github.com/users/sakuramboo/received_events","type":"user","site_admin":false}}