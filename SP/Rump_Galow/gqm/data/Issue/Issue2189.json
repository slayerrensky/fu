{"url":"https://api.github.com/repos/owncloud/core/issues/2189","labels_url":"https://api.github.com/repos/owncloud/core/issues/2189/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2189/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2189/events","html_url":"https://github.com/owncloud/core/pull/2189","id":11799208,"number":2189,"title":"fix versioning for the sync client - distinguish between touch and write operation","user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-03-08t10:28:07z","updated_at":"2013-03-08t11:05:28z","closed_at":"2013-03-08t11:05:28z","pull_request":{"html_url":"https://github.com/owncloud/core/pull/2189","diff_url":"https://github.com/owncloud/core/pull/2189.diff","patch_url":"https://github.com/owncloud/core/pull/2189.patch"},"body":"fix for issue #2111 \r\nthe sync client always performs two operations if he updates a file. first he writes the file to the server and than he triggers a touch() to correct the timestamp.\r\n\r\nthe problem: writing the file and touch() both triggers a \"write\" hook which makes it impossible for apps like the file versioning to distinguish between the two operation which leads to version duplicates.\r\n\r\nsolution: i updated the touch operation to send a 'touch' signal by default in case if someone always needs to listen to the touch operation and add the \"write' signal only when the touch operation creates a new file.\r\n\r\ni looked at the code where we use touch(). it is used in the trash bin and versioning app, for both this changes are ok. our sabre connector uses it to set the timestamp, that's why i introduced the changes so it should be safe too. the files app uses it to create a new file but than the write hook will be added, so it should be also safe.\r\n\r\nplease review it, especially @icewind1991 \r\n\r\n","closed_by":{"login":"raydiation","id":195053,"avatar_url":"https://gravatar.com/avatar/aa0d7b7302e0d7f4f9513c23b571383a?d=https%3a%2f%2fidenticons.github.com%2faf0a25e27510f77d97634a6bbe653b13.png&r=x","gravatar_id":"aa0d7b7302e0d7f4f9513c23b571383a","url":"https://api.github.com/users/raydiation","html_url":"https://github.com/raydiation","followers_url":"https://api.github.com/users/raydiation/followers","following_url":"https://api.github.com/users/raydiation/following{/other_user}","gists_url":"https://api.github.com/users/raydiation/gists{/gist_id}","starred_url":"https://api.github.com/users/raydiation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raydiation/subscriptions","organizations_url":"https://api.github.com/users/raydiation/orgs","repos_url":"https://api.github.com/users/raydiation/repos","events_url":"https://api.github.com/users/raydiation/events{/privacy}","received_events_url":"https://api.github.com/users/raydiation/received_events","type":"user","site_admin":false}}