{"url":"https://api.github.com/repos/owncloud/core/issues/5956","labels_url":"https://api.github.com/repos/owncloud/core/issues/5956/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/5956/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/5956/events","html_url":"https://github.com/owncloud/core/issues/5956","id":22958543,"number":5956,"title":"json_encode warnings in logs","user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"open","assignee":null,"milestone":null,"comments":5,"created_at":"2013-11-19t23:15:21z","updated_at":"2013-12-16t14:40:04z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### steps to reproduce (there might be other ways but here is how i got one consistently)\r\n1. mount an sftp storage\r\n2. navigate into the storage's folder\r\n3. upload either pictures or videos\r\n\r\n### expected result\r\nno log warnings\r\n\r\n### actual result\r\n\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php warning:  json_encode(): invalid utf-8 sequence in argument in /srv/www/htdocs/owncloud/lib/private/log/owncloud.php on line 72, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php stack trace:, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   1. {main}() /srv/www/htdocs/owncloud/index.php:0, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   2. oc::handlerequest() /srv/www/htdocs/owncloud/index.php:30, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   3. oc_router->match() /srv/www/htdocs/owncloud/lib/base.php:666, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   4. call_user_func() /srv/www/htdocs/owncloud/lib/private/router.php:127, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   5. __lambda_func() /srv/www/htdocs/owncloud/lib/private/router.php:127, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   6. require_once() /srv/www/htdocs/owncloud/lib/private/route.php(121) : runtime-created function:1, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   7. oc\\\\preview->show() /srv/www/htdocs/owncloud/core/ajax/preview.php:36, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   8. oc\\\\preview->showpreview() /srv/www/htdocs/owncloud/lib/private/preview.php:450, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php   9. oc\\\\preview->getpreview() /srv/www/htdocs/owncloud/lib/private/preview.php:439, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  10. oc_image->__construct() /srv/www/htdocs/owncloud/lib/private/preview.php:383, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  11. oc_image->load() /srv/www/htdocs/owncloud/lib/private/image.php:68, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  12. oc_image->loadfromfile() /srv/www/htdocs/owncloud/lib/private/image.php:384, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  13. oc_log::write() /srv/www/htdocs/owncloud/lib/private/image.php:419, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  14. call_user_func() /srv/www/htdocs/owncloud/lib/private/legacy/log.php:47, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  15. oc\\\\log->debug() /srv/www/htdocs/owncloud/lib/private/legacy/log.php:47, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  16. oc\\\\log->log() /srv/www/htdocs/owncloud/lib/private/log.php:112, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  17. oc_log_owncloud::write() /srv/www/htdocs/owncloud/lib/private/log.php:134, referer: http://localhost/owncloud/index.php/apps/files\r\n\t[wed nov 20 00:09:03 2013] [error] [client 127.0.0.1] php  18. json_encode() /srv/www/htdocs/owncloud/lib/private/log/owncloud.php:72, referer: http://localhost/owncloud/index.php/apps/files\r\n\r\ni have the feeling that it's maybe trying to log binary image data lib/private/image.php:419 when creating the preview.\r\n\r\ncan you have a look @georgehrke ?\r\n\r\n","closed_by":null}