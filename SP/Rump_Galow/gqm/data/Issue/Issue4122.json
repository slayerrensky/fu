{"url":"https://api.github.com/repos/owncloud/core/issues/4122","labels_url":"https://api.github.com/repos/owncloud/core/issues/4122/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4122/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4122/events","html_url":"https://github.com/owncloud/core/issues/4122","id":16950240,"number":4122,"title":"ideas on encryption","user":{"login":"grmrgecko","id":167167,"avatar_url":"https://gravatar.com/avatar/ba4d35596d7b588305f420e852168ed5?d=https%3a%2f%2fidenticons.github.com%2f9495a73d0c497ddc6c818c19672ad976.png&r=x","gravatar_id":"ba4d35596d7b588305f420e852168ed5","url":"https://api.github.com/users/grmrgecko","html_url":"https://github.com/grmrgecko","followers_url":"https://api.github.com/users/grmrgecko/followers","following_url":"https://api.github.com/users/grmrgecko/following{/other_user}","gists_url":"https://api.github.com/users/grmrgecko/gists{/gist_id}","starred_url":"https://api.github.com/users/grmrgecko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grmrgecko/subscriptions","organizations_url":"https://api.github.com/users/grmrgecko/orgs","repos_url":"https://api.github.com/users/grmrgecko/repos","events_url":"https://api.github.com/users/grmrgecko/events{/privacy}","received_events_url":"https://api.github.com/users/grmrgecko/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3afiles_encryption","name":"app:files_encryption","color":"02d7e1"},{"url":"https://api.github.com/repos/owncloud/core/labels/discussion","name":"discussion","color":"fbca04"},{"url":"https://api.github.com/repos/owncloud/core/labels/enhancement","name":"enhancement","color":"02e10c"}],"state":"open","assignee":null,"milestone":null,"comments":1,"created_at":"2013-07-18t23:52:41z","updated_at":"2013-12-13t07:30:50z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"i just read http://blog.schiessle.org/2013/05/28/introduction-to-the-new-owncloud-encryption-app/\r\n\r\nreading it, it sounds like the encryption keys for files are randomly generated. why not change the encryption key to be based on the file contents using a hash. example, use sha256 to hash the file, and use the resulted hash as the encryption key for the file.\r\n\r\nusing the hash as an encryption key makes it possible to do some de-duplication of files. if the file being uploaded has the same hash, then it's not needed to be uploaded again. of course, you'll use a salt to make the hash stronger. but you won't be using random salts for each file as it is needed to be the same for de-duplication. you'll have 2 salts. one for the de-dup hash, and the other for the encryption hash.\r\n\r\nfor de-dup, you'll have a database with the folder structure for each user. the name of files, the encryption key which was encrypted with the user public key and so on. you will then make the data folder be based on file hashes. due to filesystem limits, you'll have to split them into folders somehow... maybe have the first part of the hash be a folder name. this hash will be the one salted for de-dup.\r\n\r\nthe web based interface should allow the users to disable viewing files via the web based interface and anything else that has the server decrypt the files. make sure the clients for ios/android/linux/mac/windows supports decryption and encryption client side. making this be a trust no one solution.\r\n\r\ni do not know if my idea is too crazy, but it's an idea. my implementation thoughts may be wrong, but it gets the idea across.","closed_by":null}