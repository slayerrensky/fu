{"url":"https://api.github.com/repos/owncloud/core/issues/6437","labels_url":"https://api.github.com/repos/owncloud/core/issues/6437/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/6437/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/6437/events","html_url":"https://github.com/owncloud/core/issues/6437","id":24350291,"number":6437,"title":"share activity has wrong file information when shared file is in a subfolder","user":{"login":"sufflope","id":4585916,"avatar_url":"https://gravatar.com/avatar/3b832e4097777d0706a3b9aa8d1097f6?d=https%3a%2f%2fidenticons.github.com%2f447981519c43221610529a5e47d555c7.png&r=x","gravatar_id":"3b832e4097777d0706a3b9aa8d1097f6","url":"https://api.github.com/users/sufflope","html_url":"https://github.com/sufflope","followers_url":"https://api.github.com/users/sufflope/followers","following_url":"https://api.github.com/users/sufflope/following{/other_user}","gists_url":"https://api.github.com/users/sufflope/gists{/gist_id}","starred_url":"https://api.github.com/users/sufflope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sufflope/subscriptions","organizations_url":"https://api.github.com/users/sufflope/orgs","repos_url":"https://api.github.com/users/sufflope/repos","events_url":"https://api.github.com/users/sufflope/events{/privacy}","received_events_url":"https://api.github.com/users/sufflope/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"open","assignee":null,"milestone":null,"comments":2,"created_at":"2013-12-16t13:53:45z","updated_at":"2013-12-17t11:05:17z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\ni should see an activity with correct file thumbnail and link, when sharing a file which is in a subfolder\r\n\r\n### actual behaviour\r\ni see an activity but no thumbnail and a link to files root\r\n\r\n```\r\nowncloud=> select * from oc_activity;\r\n activity_id | timestamp  | priority | type |   user   | affecteduser |  app  |    subject    |            subjectparams            | message | messageparams |        file        |                            link                            \r\n-------------+------------+----------+------+----------+--------------+-------+---------------+-------------------------------------+---------+---------------+--------------------+------------------------------------------------------------\r\n           1 | 1234 |       30 |    4 | me | me     | files | you shared %s | a:1:{i:0;s:17:\"image.jpg\";} |         | a:0:{}        | /image.jpg | https://owncloud.mydomain/index.php/apps/files?dir=%2f\r\n```\r\n\r\nafter changing file to correct path (/images/subfolder/image.jpg) i see the thumbnail. i have not touched the link since i am not sure whether it should be a link to the folder or the file itself.\r\n\r\n### steps to reproduce\r\n1. share a file using the public url system\r\n2. go to activity stream\r\n3. look at generated activity\r\n\r\n### server configuration\r\noperating system: fedora 19\r\n\r\nweb server: apache 2.4.6\r\n\r\ndatabase: postgresql 9.2.6\r\n\r\nphp version: 5.5.7\r\n\r\nowncloud version: (see owncloud admin page) 6.0.0a\r\n\r\nupdated from an older owncloud or fresh install: fresh install\r\n\r\nlist of activated app: default ones\r\n\r\nthe content of config/config.php: (without the database password and passwordsalt)\r\n```\r\n<?php\r\n$config = array (\r\n  'instanceid' => 'oc1234',\r\n  'passwordsalt' => 'toto',\r\n  'datadirectory' => '/srv/owncloud/latest/data',\r\n  'dbtype' => 'pgsql',\r\n  'version' => '6.0.0.14',\r\n  'dbname' => 'owncloud',\r\n  'dbhost' => 'localhost',\r\n  'dbtableprefix' => 'oc_',\r\n  'dbuser' => 'owncloud',\r\n  'dbpassword' => 'pass',\r\n  'installed' => true,\r\n);\r\n```","closed_by":null}