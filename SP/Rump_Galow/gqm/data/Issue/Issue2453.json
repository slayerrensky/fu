{"url":"https://api.github.com/repos/owncloud/core/issues/2453","labels_url":"https://api.github.com/repos/owncloud/core/issues/2453/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2453/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2453/events","html_url":"https://github.com/owncloud/core/issues/2453","id":12186849,"number":2453,"title":"[5.0] endless db-queries","user":{"login":"jcdevaux","id":3909065,"avatar_url":"https://gravatar.com/avatar/885fec5229329a31849bd89d2997e6da?d=https%3a%2f%2fidenticons.github.com%2ff9ac17a72e5e59e5412eda15cd4ce1cd.png&r=x","gravatar_id":"885fec5229329a31849bd89d2997e6da","url":"https://api.github.com/users/jcdevaux","html_url":"https://github.com/jcdevaux","followers_url":"https://api.github.com/users/jcdevaux/followers","following_url":"https://api.github.com/users/jcdevaux/following{/other_user}","gists_url":"https://api.github.com/users/jcdevaux/gists{/gist_id}","starred_url":"https://api.github.com/users/jcdevaux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jcdevaux/subscriptions","organizations_url":"https://api.github.com/users/jcdevaux/orgs","repos_url":"https://api.github.com/users/jcdevaux/repos","events_url":"https://api.github.com/users/jcdevaux/events{/privacy}","received_events_url":"https://api.github.com/users/jcdevaux/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":33,"created_at":"2013-03-19t15:55:04z","updated_at":"2013-08-08t15:46:26z","closed_at":"2013-08-08t15:46:26z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"hi,\r\n\r\nas @deepdiver1975 suggested <a href=\"https://github.com/owncloud/core/issues/2399#issuecomment-15113669\">here</a>, i create a new issue.\r\n\r\n<h1>expected behaviour</h1>\r\n\r\nonly a couple of queries\r\n\r\n<h1>actual behaviour</h1>\r\n\r\na lot of queries (log files is >32mib in less then five minutes)\r\nthe only way to stop that hell fall is to restart the web server or the db server.\r\n\r\n<h1>steps to reproduce</h1>\r\n\r\ndo anything on owncloud\r\n\r\n<h1>server configuration</h1>\r\n\r\noperating system: ubuntu 12.04 lts\r\nweb server: apache 2.2.22\r\ndatabase: mysql ver 14.14 distrib 5.5.29, for debian-linux-gnu (x86_64) using readline 6.2\r\nphp version: php 5.3.10-1ubuntu3.6 with suhosin-patch\r\nowncloud version: 5.0\r\n\r\n<h1>client configuration</h1>\r\n\r\nbrowser: chrome 25.0.1364.172 m\r\n\r\noperating system: windows 7\r\n\r\n<h1>logs</h1>\r\n\r\n\r\ninfinite repetition of queries :\r\n\r\n              100 query     select * from `oc_users` where lower(`uid`) = lower('group-board')\r\n              100 query     select count(*) from `oc_users` where lower(`uid`) = lower('group-board') limit 3\r\n              100 query     select `id` from `oc_mimetypes` where `mimetype` = 'httpd/unix-directory'\r\n              100 query     select `fileid`, `name`, `mimetype` from `oc_filecache` where `parent` in ('12')\r\n              100 query     select `fileid`, `name`, `mimetype` from `oc_filecache` where `parent` in ('15')\r\n              100 query     select `uid` from `oc_group_user` where `gid` = 'group-board' and `uid` like '%'\r\n              100 query     select `configvalue` from `oc_preferences` where `userid` = 'user2' and `appid` = 'files_sharing' and `configkey` = 'etag'\r\n              100 query     update `oc_preferences` set `configvalue` = '514849be3ae3b' where `userid` = 'user2' and `appid` = 'files_sharing' and `configkey` = 'etag'\r\n              100 query     select `configvalue` from `oc_appconfig` where `appid` = 'core' and `configkey` = 'shareapi_enabled'\r\n              100 query     select `oc_share`.`id`, `item_type`, `oc_share`.`parent`, `share_type`, `share_with`, `file_source`, `path`, `permissions`, `stime`, `expiration`, `token`, `storage` from `oc_share` inner join `oc_filecache` on `file_source` = `oc_filecache`.`fileid` and `uid_owner` = 'user2' and `share_type` != '2' and ( `file_source` = '15' or `item_type` in ('folder'))\r\n              100 query     select `configvalue` from `oc_preferences` where `userid` = 'user3' and `appid` = 'files_sharing' and `configkey` = 'etag'\r\n              100 query     update `oc_preferences` set `configvalue` = '514849be46df3' where `userid` = 'user3' and `appid` = 'files_sharing' and `configkey` = 'etag'\r\n              100 query     select `configvalue` from `oc_appconfig` where `appid` = 'core' and `configkey` = 'shareapi_enabled'\r\n              100 query     select `oc_share`.`id`, `item_type`, `oc_share`.`parent`, `share_type`, `share_with`, `file_source`, `path`, `permissions`, `stime`, `expiration`, `token`, `storage` from `oc_share` inner join `oc_filecache` on `file_source` = `oc_filecache`.`fileid` and `uid_owner` = 'user3' and `share_type` != '2' and ( `file_source` = '15' or `item_type` in ('folder'))\r\n              100 query     select `configvalue` from `oc_preferences` where `userid` = 'user1' and `appid` = 'files_sharing' and `configkey` = 'etag'\r\n              100 query     update `oc_preferences` set `configvalue` = '514849be61594' where `userid` = 'user1' and `appid` = 'files_sharing' and `configkey` = 'etag'\r\n              100 query     select `configvalue` from `oc_appconfig` where `appid` = 'core' and `configkey` = 'shareapi_enabled'\r\n              100 query     select `oc_share`.`id`, `item_type`, `oc_share`.`parent`, `share_type`, `share_with`, `file_source`, `path`, `permissions`, `stime`, `expiration`, `token`, `storage` from `oc_share` inner join `oc_filecache` on `file_source` = `oc_filecache`.`fileid` and `uid_owner` = 'user1' and `share_type` != '2' and ( `file_source` = '15' or `item_type` in ('folder'))\r\n              100 query     select `id` from `oc_storages` where `numeric_id` = '2'","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}