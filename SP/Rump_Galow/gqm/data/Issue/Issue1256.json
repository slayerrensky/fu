{"url":"https://api.github.com/repos/owncloud/core/issues/1256","labels_url":"https://api.github.com/repos/owncloud/core/issues/1256/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1256/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1256/events","html_url":"https://github.com/owncloud/core/issues/1256","id":10165365,"number":1256,"title":"php warning:  mkdir(): permission denied","user":{"login":"mmattel","id":3321281,"avatar_url":"https://gravatar.com/avatar/2d576241f3ac901ec52f1ec4a9c3b77b?d=https%3a%2f%2fidenticons.github.com%2f62fba4fe6711d41fdbfc7ccc04efb8f4.png&r=x","gravatar_id":"2d576241f3ac901ec52f1ec4a9c3b77b","url":"https://api.github.com/users/mmattel","html_url":"https://github.com/mmattel","followers_url":"https://api.github.com/users/mmattel/followers","following_url":"https://api.github.com/users/mmattel/following{/other_user}","gists_url":"https://api.github.com/users/mmattel/gists{/gist_id}","starred_url":"https://api.github.com/users/mmattel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmattel/subscriptions","organizations_url":"https://api.github.com/users/mmattel/orgs","repos_url":"https://api.github.com/users/mmattel/repos","events_url":"https://api.github.com/users/mmattel/events{/privacy}","received_events_url":"https://api.github.com/users/mmattel/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":5,"created_at":"2013-01-21t17:45:23z","updated_at":"2013-08-06t22:53:48z","closed_at":"2013-08-06t22:53:48z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"oc 4.5.5 on ubuntu 12.04, external storage via smb\r\n\r\nwhen i start the server (reboot) or restart apache, in some circumstances i can for a long time not logon. i do not even get a web response from owncloud. looking to apaches error log i saw, following error:\r\n\r\n--> php warning:  mkdir(): permission denied in /mnt/www/owncloud/lib/cache/fileglobal.php on line 14, referer: https://www.xxxxxxx/owncloud/settings/admin.php\r\n\r\nthis error message is not really useful, because you do not know why in detail the error was raised. parsing the code of fileglobal.php, the statement mkdir in line 14 is the root cause. i changed the code to following printing the \"cache_dir\" which causes the error:\r\n\r\n                        if(!mkdir($cache_dir)) {\r\n                                error_log(print_r($cache_dir,true));\r\n                        }\r\n\r\nthis prints out in addition the path and file to be created causing the error.\r\n\r\n--> /mnt/www/php/tmp/owncloud-50f983ecb3047/, referer: https://www.xxxxxxx/owncloud/settings/admin.php\r\n\r\ntrying to look to the path, i found out, that the folder \"php\" in /mnt/www/ did not exist...\r\noc was fresh installed, nothing has been \"tweaked\" in the www path of oc.\r\n\r\nactions:\r\n\r\n1.) expanding the code in fileglobal.php line 14 from mkdir($cache_dir) to catch and print more details of the raising error to the apache error log\r\n\r\n2.) expanding the mkdir command to recursive creation\r\n     (http://php.net/manual/de/function.mkdir.php)\r\n\r\ncode suggestion:\r\n\r\n                        if(!mkdir($cache_dir, 0, true)) {\r\n                                error_log(print_r($cache_dir,true));\r\n                        }\r\n3.) creating during the install a php and tmp folder in the ./owncloud directory and set the permissions properly\r\n\r\nbest regards\r\nmartin","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}