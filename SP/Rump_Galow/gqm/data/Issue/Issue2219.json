{"url":"https://api.github.com/repos/owncloud/core/issues/2219","labels_url":"https://api.github.com/repos/owncloud/core/issues/2219/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2219/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2219/events","html_url":"https://github.com/owncloud/core/issues/2219","id":11849966,"number":2219,"title":"can't change shared file by another user","user":{"login":"solidrockit","id":1295310,"avatar_url":"https://gravatar.com/avatar/e0ce8773b75122aee8e14d6912d43dc4?d=https%3a%2f%2fidenticons.github.com%2ff3b2264f3db517ccfaa7898f776eb1cd.png&r=x","gravatar_id":"e0ce8773b75122aee8e14d6912d43dc4","url":"https://api.github.com/users/solidrockit","html_url":"https://github.com/solidrockit","followers_url":"https://api.github.com/users/solidrockit/followers","following_url":"https://api.github.com/users/solidrockit/following{/other_user}","gists_url":"https://api.github.com/users/solidrockit/gists{/gist_id}","starred_url":"https://api.github.com/users/solidrockit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/solidrockit/subscriptions","organizations_url":"https://api.github.com/users/solidrockit/orgs","repos_url":"https://api.github.com/users/solidrockit/repos","events_url":"https://api.github.com/users/solidrockit/events{/privacy}","received_events_url":"https://api.github.com/users/solidrockit/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":5,"created_at":"2013-03-10t08:53:04z","updated_at":"2013-03-13t11:32:11z","closed_at":"2013-03-10t15:19:06z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nwhen an user (owner) shares a file with another user (collaborator) and provides him modification permission, collaborator should have ability to change it and the changed file should be available to owner using sync client. if versioning is available, only the last version should be shared between users. \r\n\r\n### actual behaviour\r\ncollaborator changed file doesn't propagate to the owner and a conflict file appears in collaborator's folder (mapped to shared using sync client).\r\n\r\n### steps to reproduce\r\n1. testuser03 create a text file (shared file.txt) in windows 7. sync client uploads it to oc server.\r\n2. testuser03 change the file. sync client uploads the file and another version is created.\r\n3. testuser03 gives full control to testuser01 through oc web interface.\r\n4. in windows xp, the sync client downloads the file to the local folder mapped to \"shared\".\r\n5. testuser01 modifies the file in windows xp.\r\n6. testuser03 can't see changes made by testuser01.\r\n7. testuser01 modifies the shared file in opensuse, with the same behaviour.\r\n\r\nsometimes (server or clien restart, but not fully verified) an conflict file appears, but not always. \r\n\r\n### server configuration\r\noperating system:\r\n\r\nlinux ec03 3.0.42-0.7-ec2 #1 smp tue oct 9 11:58:45 utc 2012 (a8dc443) x86_64 x86_64 x86_64 gnu/linux\r\n\r\nsuse linux enterprise server 11 (x86_64)\r\nversion = 11\r\npatchlevel = 2\r\n\r\nweb server: \r\n\r\napache2-prefork-2.2.12-1.30.1\r\napache2-mod_php53-5.3.8-0.39.1\r\napache2-2.2.12-1.30.1\r\napache2-utils-2.2.12-1.30.1\r\n\r\ndatabase:\r\n\r\nlibmysqlclient15-5.0.96-0.4.1\r\nphp53-mysql-5.3.8-0.39.1\r\nmysql-5.0.96-0.4.1\r\nmysql-client-5.0.96-0.4.\r\n\r\nphp version:\r\n\r\nphp53-xmlwriter-5.3.8-0.39.1\r\napache2-mod_php53-5.3.8-0.39.1\r\nphp53-mbstring-5.3.8-0.39.1\r\nphp53-ctype-5.3.8-0.39.1\r\nphp53-json-5.3.8-0.39.1\r\nphp53-zlib-5.3.8-0.39.1\r\nphp53-pdo-5.3.8-0.39.1\r\nphp53-pear-5.3.8-0.39.1\r\nphp53-mysql-5.3.8-0.39.1\r\nphp53-tokenizer-5.3.8-0.39.1\r\nphp53-sqlite-5.3.8-0.39.1\r\nphp53-zip-5.3.8-0.39.1\r\nphp53-gd-5.3.8-0.39.1\r\nphp53-curl-5.3.8-0.39.1\r\nphp53-5.3.8-0.39.1\r\nphp53-iconv-5.3.8-0.39.1\r\nphp53-dom-5.3.8-0.39.1\r\nphp53-xmlreader-5.3.8-0.39.1\r\nphp53-openssl-5.3.8-0.39.1\r\nphp53-ldap-5.3.8-0.39.1\r\n\r\nphp --version\r\nphp 5.3.8 (cli)\r\ncopyright (c) 1997-2011 the php group\r\nzend engine v2.3.0, copyright (c) 1998-2011 zend technologies\r\n\r\nowncloud version:\r\n\r\n4.5.7 fresh install\r\n4.5.5 upgraded from 4.5.1\r\n4.5.7 upgraded from 4.5.5\r\n\r\nworked on 4.5.1!\r\n\r\n### client configuration\r\nbrowser:\r\n\r\nna\r\n\r\noperating system an sync clients\r\n\r\ntestuser03 -> windows 7; oc sync client 1.2.1\r\ntestuser01 -> windows xp; oc sync client 1.2.1\r\ntestuser01 -> opensuse 12.2; oc sync client 1.2.1  (and 1.1.1)\r\n\r\n### logs\r\n#### web server error log\r\n\r\nthese errors repeats continously:\r\n\r\n```\r\n[sun mar 10 08:37:15 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851407,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093716.txt.v1362851407): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:15 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851513,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093716.txt.v1362851513): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:15 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362853755,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093716.txt.v1362853755): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:15 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362900508,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093716.txt.v1362900508): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:15 2013] [error] [client 87.217.198.189] php notice:  undefined index: size in /srv/www/vhosts/demooc.solid-rock-it.com/lib/filecache/update.php on line 214\r\n[sun mar 10 08:37:39 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851407,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093739.txt.v1362851407): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:39 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851513,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093739.txt.v1362851513): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:39 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362853755,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093739.txt.v1362853755): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:39 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362900508,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093739.txt.v1362900508): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:39 2013] [error] [client 87.217.198.189] php notice:  undefined index: size in /srv/www/vhosts/demooc.solid-rock-it.com/lib/filecache/update.php on line 214\r\n[sun mar 10 08:37:45 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851407,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093746.txt.v1362851407): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:45 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851513,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093746.txt.v1362851513): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:45 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362853755,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093746.txt.v1362853755): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:45 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362900508,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093746.txt.v1362900508): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:37:45 2013] [error] [client 87.217.198.189] php notice:  undefined index: size in /srv/www/vhosts/demooc.solid-rock-it.com/lib/filecache/update.php on line 214\r\n[sun mar 10 08:38:11 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851407,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093811.txt.v1362851407): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n\r\n\r\n...........\r\n\r\n\r\n[sun mar 10 08:38:11 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851513,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093811.txt.v1362851513): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:38:11 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362853755,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093811.txt.v1362853755): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:38:11 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362900508,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093811.txt.v1362900508): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:38:11 2013] [error] [client 87.217.198.189] php notice:  undefined index: size in /srv/www/vhosts/demooc.solid-rock-it.com/lib/filecache/update.php on line 214\r\n[sun mar 10 08:38:15 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851407,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093815.txt.v1362851407): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:38:15 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851513,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-093815.txt.v1362851513): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\nfile.txt.v1362900508,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-094115.txt.v1362900508): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:41:15 2013] [error] [client 87.217.198.189] php notice:  undefined index: size in /srv/www/vhosts/demooc.solid-rock-it.com/lib/filecache/update.php on line 214\r\n[sun mar 10 08:41:22 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851407,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-094122.txt.v1362851407): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:41:22 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362851513,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-094122.txt.v1362851513): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:41:22 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362853755,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-094122.txt.v1362853755): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:41:22 2013] [error] [client 87.217.198.189] php warning:  rename(/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file.txt.v1362900508,/srv/www/vhosts/demooc.solid-rock-it.com/data/testuser01/files_versions//shared/shared file_conflict-20130310-094122.txt.v1362900508): no such file or directory in /srv/www/vhosts/demooc.solid-rock-it.com/apps/files_versions/lib/hooks.php on line 70\r\n[sun mar 10 08:41:22 2013] [error] [client 87.217.198.189] php notice:  undefined index: size in /srv/www/vhosts/demooc.solid-rock-it.com/lib/filecache/update.php on line 214\r\n\r\n```\r\n\r\n#### owncloud log (data/owncloud.log)\r\n```\r\nthese errors repeats continously:\r\n\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093315.txt\",\"level\":3,\"time\":1362904395}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093315.txt\",\"level\":3,\"time\":1362904395}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093323.txt\",\"level\":3,\"time\":1362904402}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093323.txt\",\"level\":3,\"time\":1362904402}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093345.txt\",\"level\":3,\"time\":1362904425}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093345.txt\",\"level\":3,\"time\":1362904425}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093354.txt\",\"level\":3,\"time\":1362904434}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093354.txt\",\"level\":3,\"time\":1362904434}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093415.txt\",\"level\":3,\"time\":1362904455}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093415.txt\",\"level\":3,\"time\":1362904455}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093426.txt\",\"level\":3,\"time\":1362904465}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093426.txt\",\"level\":3,\"time\":1362904466}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093445.txt\",\"level\":3,\"time\":1362904485}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093445.txt\",\"level\":3,\"time\":1362904485}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093457.txt\",\"level\":3,\"time\":1362904497}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093457.txt\",\"level\":3,\"time\":1362904497}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093515.txt\",\"level\":3,\"time\":1362904515}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093515.txt\",\"level\":3,\"time\":1362904515}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093529.txt\",\"level\":3,\"time\":1362904529}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093529.txt\",\"level\":3,\"time\":1362904529}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093545.txt\",\"level\":3,\"time\":1362904545}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093545.txt\",\"level\":3,\"time\":1362904545}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093601.txt\",\"level\":3,\"time\":1362904560}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093601.txt\",\"level\":3,\"time\":1362904560}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093615.txt\",\"level\":3,\"time\":1362904575}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093615.txt\",\"level\":3,\"time\":1362904575}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/shared file_conflict-20130310-093634.txt\",\"level\":3,\"time\":1362904594}\r\n```","closed_by":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false}}