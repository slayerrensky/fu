{"url":"https://api.github.com/repos/owncloud/core/issues/2742","labels_url":"https://api.github.com/repos/owncloud/core/issues/2742/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2742/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2742/events","html_url":"https://github.com/owncloud/core/issues/2742","id":12841182,"number":2742,"title":"renaming local external storage folder fails and local copy is corrupted or deleted","user":{"login":"anakimana","id":4067853,"avatar_url":"https://gravatar.com/avatar/b7dda5d68391db5f065d71bc925a0e95?d=https%3a%2f%2fidenticons.github.com%2f9b79d27061f10a55cce4482c55a067a7.png&r=x","gravatar_id":"b7dda5d68391db5f065d71bc925a0e95","url":"https://api.github.com/users/anakimana","html_url":"https://github.com/anakimana","followers_url":"https://api.github.com/users/anakimana/followers","following_url":"https://api.github.com/users/anakimana/following{/other_user}","gists_url":"https://api.github.com/users/anakimana/gists{/gist_id}","starred_url":"https://api.github.com/users/anakimana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anakimana/subscriptions","organizations_url":"https://api.github.com/users/anakimana/orgs","repos_url":"https://api.github.com/users/anakimana/repos","events_url":"https://api.github.com/users/anakimana/events{/privacy}","received_events_url":"https://api.github.com/users/anakimana/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"},{"url":"https://api.github.com/repos/owncloud/core/labels/windows+server","name":"windows server","color":"0b02e1"}],"state":"closed","assignee":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"milestone":null,"comments":1,"created_at":"2013-04-05t11:08:47z","updated_at":"2013-08-07t18:17:51z","closed_at":"2013-08-07t18:17:51z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nhovering over the shared folder (external storage, local, d:\\serverfolders\\share, all users) gives the options for \"rename, download, share\". clicking on rename, it should rename the folder and leave contents intact.\r\n\r\n### actual behaviour\r\nas soon as you press enter, a window pops up titled \"error moving file\" with message \"unable to rename file\".  navigating in windows server to the location reveals that either 1) the folder with all subfolders & files is now a file with same name as before but no file extension and 0 bytes in size, or 2) the folder is completely gone.\r\n\r\n### steps to reproduce\r\n1. create external folder link under admin section with these or similar settings: folder name: (whatever), external storage type: local, configuration: d:\\serverfolders\\share, applicable: all users\r\n2. click on the files nav button on left edge of web interface\r\n3. hover over the folder setup in step 1, click rename, add a character to name, press enter.\r\n\r\n### server configuration\r\noperating system: windows server 2012 essentials\r\n\r\nweb server: iis 8.0\r\n\r\ndatabase: mysql 5.6.10.1\r\n\r\nphp version: 5.4.13\r\n\r\nowncloud version: 5.0.3\r\n\r\n### client configuration\r\nbrowser: internet explorer 10\r\n\r\noperating system: windows server 2012 essentials\r\n\r\n### logs\r\n#### web server error log\r\n\r\n#software: microsoft internet information services 8.0\r\n#version: 1.0\r\n#date: 2013-04-05 10:57:03\r\n#fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(user-agent) cs(referer) sc-status sc-substatus sc-win32-status time-taken\r\n2013-04-05 10:57:03 ::1 get /cloud/data/htaccesstest.txt - 80 - ::1 - - 200 0 0 0\r\n2013-04-05 10:57:03 ::1 propfind /cloud/remote.php/webdav/ - 80 - ::1 - - 401 0 0 218\r\n2013-04-05 10:57:03 ::1 get /cloud/index.php/settings/admin - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 200 0 0 2718\r\n2013-04-05 10:57:04 ::1 get /cloud/remote.php/core.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 304 0 0 203\r\n2013-04-05 10:57:04 ::1 get /cloud/index.php/apps/files_external/css/settings.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 304 0 0 265\r\n2013-04-05 10:57:04 ::1 get /cloud/index.php/core/js/config.js - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 200 0 0 468\r\n2013-04-05 10:57:04 ::1 get /cloud/remote.php/core.js 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 304 0 0 671\r\n2013-04-05 10:57:04 ::1 get /cloud/index.php/core/routes.json - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 304 0 0 203\r\n2013-04-05 10:57:04 ::1 get /cloud/cron.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 200 0 0 234\r\n2013-04-05 10:57:19 ::1 post /cloud/index.php/apps/files_external/ajax/addmountpoint.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 200 0 0 234\r\n2013-04-05 10:57:19 192.168.1.141 propfind /cloud/remote.php/webdav/clientsync - 443 - 192.168.1.142 csyncoc/0.70.5+neon/0.29.6 - 401 0 0 140\r\n2013-04-05 10:57:19 192.168.1.141 get /cloud/status.php - 443 - 192.168.1.142 mirall-1.2.3 - 200 0 0 187\r\n2013-04-05 10:57:19 192.168.1.141 propfind /cloud/remote.php/webdav/clientsync - 443 - 192.168.1.142 csyncoc/0.70.5+neon/0.29.6 - 404 0 0 234\r\n2013-04-05 10:57:19 192.168.1.141 get /cloud/status.php - 443 - 192.168.1.142 mirall-1.2.3 - 200 0 0 265\r\n2013-04-05 10:57:24 ::1 get /cloud/index.php/apps/files - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/settings/admin 200 0 0 406\r\n2013-04-05 10:57:24 ::1 get /cloud/remote.php/core.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 304 0 0 187\r\n2013-04-05 10:57:24 ::1 get /cloud/index.php/core/js/config.js - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 200 0 0 234\r\n2013-04-05 10:57:24 ::1 get /cloud/index.php/apps/files/css/files.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 304 0 0 437\r\n2013-04-05 10:57:24 ::1 get /cloud/remote.php/core.js 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 304 0 0 625\r\n2013-04-05 10:57:24 ::1 get /cloud/index.php/core/routes.json - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 304 0 0 218\r\n2013-04-05 10:57:25 ::1 get /cloud/index.php/core/ajax/share.php fetch=getitemssharedstatuses&itemtype=file 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 200 0 0 437\r\n2013-04-05 10:57:25 ::1 post /cloud/index.php/core/ajax/translations.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 200 0 0 593\r\n2013-04-05 10:57:25 ::1 get /cloud/cron.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 200 0 0 656\r\n2013-04-05 10:57:25 ::1 post /cloud/index.php/core/ajax/translations.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 200 0 0 218\r\n2013-04-05 10:57:27 ::1 get /cloud/index.php/apps/files/ajax/scan.php fallback=true&fallback_id=0&force=false&dir=&requesttoken=ad95a0c2a908427fb689 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 200 0 0 1407\r\n2013-04-05 10:57:33 ::1 get /cloud/index.php/apps/files dir=//distprop2 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files 200 0 0 375\r\n2013-04-05 10:57:33 ::1 get /cloud/index.php/apps/files/css/files.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 304 0 0 218\r\n2013-04-05 10:57:33 ::1 get /cloud/remote.php/core.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 304 0 0 390\r\n2013-04-05 10:57:33 ::1 get /cloud/index.php/core/js/config.js - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 200 0 0 437\r\n2013-04-05 10:57:33 ::1 get /cloud/remote.php/core.js 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 304 0 0 640\r\n2013-04-05 10:57:33 ::1 get /cloud/index.php/core/routes.json - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 304 0 0 218\r\n2013-04-05 10:57:35 ::1 post /cloud/index.php/core/ajax/translations.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 200 0 0 406\r\n2013-04-05 10:57:35 ::1 get /cloud/cron.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 200 0 0 500\r\n2013-04-05 10:57:35 ::1 get /cloud/index.php/core/ajax/share.php fetch=getitemssharedstatuses&itemtype=file 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 200 0 0 609\r\n2013-04-05 10:57:35 ::1 post /cloud/index.php/core/ajax/translations.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 200 0 0 343\r\n2013-04-05 10:57:35 ::1 get /cloud/index.php/apps/files/ajax/scan.php fallback=true&fallback_id=0&force=false&dir=&requesttoken=ad95a0c2a908427fb689 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 200 0 0 250\r\n2013-04-05 10:57:38 ::1 get /cloud/index.php/apps/files dir= 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir=//distprop2 200 0 0 359\r\n2013-04-05 10:57:38 ::1 get /cloud/remote.php/core.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 304 0 0 203\r\n2013-04-05 10:57:38 ::1 get /cloud/index.php/apps/files/css/files.css 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 304 0 0 250\r\n2013-04-05 10:57:38 ::1 get /cloud/index.php/core/js/config.js - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 453\r\n2013-04-05 10:57:38 ::1 get /cloud/remote.php/core.js 285e19f20beded7d215102b49d5c09a0 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 304 0 0 656\r\n2013-04-05 10:57:38 ::1 get /cloud/index.php/core/routes.json - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 304 0 0 218\r\n2013-04-05 10:57:39 ::1 get /cloud/cron.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 250\r\n2013-04-05 10:57:39 ::1 post /cloud/index.php/core/ajax/translations.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 421\r\n2013-04-05 10:57:39 ::1 get /cloud/index.php/core/ajax/share.php fetch=getitemssharedstatuses&itemtype=file 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 609\r\n2013-04-05 10:57:39 ::1 post /cloud/index.php/core/ajax/translations.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 343\r\n2013-04-05 10:57:39 ::1 get /cloud/index.php/apps/files/ajax/scan.php fallback=true&fallback_id=0&force=false&dir=&requesttoken=ad95a0c2a908427fb689 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 234\r\n2013-04-05 10:57:48 192.168.1.141 get /cloud/status.php - 443 - 192.168.1.142 mirall-1.2.3 - 200 0 0 187\r\n2013-04-05 10:57:48 192.168.1.141 propfind /cloud/remote.php/webdav/clientsync - 443 - 192.168.1.142 csyncoc/0.70.5+neon/0.29.6 - 401 0 0 140\r\n2013-04-05 10:57:48 192.168.1.141 propfind /cloud/remote.php/webdav/clientsync - 443 - 192.168.1.142 csyncoc/0.70.5+neon/0.29.6 - 404 0 0 250\r\n2013-04-05 10:57:48 192.168.1.141 get /cloud/status.php - 443 - 192.168.1.142 mirall-1.2.3 - 200 0 0 234\r\n2013-04-05 10:57:54 ::1 get /cloud/index.php/apps/files/ajax/rename.php dir=%2f&newname=1distprop2&file=distprop2 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 924\r\n2013-04-05 10:57:54 ::1 post /cloud/index.php/core/ajax/translations.php - 80 - ::1 mozilla/5.0+(compatible;+msie+10.0;+windows+nt+6.2;+wow64;+trident/6.0) http://localhost/cloud/index.php/apps/files?dir= 200 0 0 203\r\n2013-04-05 10:58:17 192.168.1.141 get /cloud/status.php - 443 - 192.168.1.142 mirall-1.2.3 - 200 0 0 156\r\n2013-04-05 10:58:17 192.168.1.141 propfind /cloud/remote.php/webdav/clientsync - 443 - 192.168.1.142 csyncoc/0.70.5+neon/0.29.6 - 401 0 0 140\r\n2013-04-05 10:58:17 192.168.1.141 propfind /cloud/remote.php/webdav/clientsync - 443 - 192.168.1.142 csyncoc/0.70.5+neon/0.29.6 - 404 0 0 218\r\n2013-04-05 10:58:17 192.168.1.141 get /cloud/status.php - 443 - 192.168.1.142 mirall-1.2.3 - 200 0 0 187\r\n\r\n\r\n#### owncloud log (data/owncloud.log)\r\n\r\n{\"app\":\"php\",\"message\":\"stat(): stat failed for d:\\\\serverfolders\\\\share2 at c:\\\\program files\\\\windows server\\\\bin\\\\webapps\\\\site\\\\cloud\\\\lib\\\\files\\\\storage\\\\mappedlocal.php#74\",\"level\":2,\"time\":1365159422}\r\n{\"app\":\"search_lucene\",\"message\":\"failed to extract meta information for \\/admin\\/files\\/rdistprop2: unable to determine file format\",\"level\":2,\"time\":1365159445}\r\n{\"app\":\"php\",\"message\":\"fopen(d:\\\\serverfolders\\\\share3): failed to open stream: permission denied at c:\\\\program files\\\\windows server\\\\bin\\\\webapps\\\\site\\\\cloud\\\\lib\\\\files\\\\storage\\\\mappedlocal.php#173\",\"level\":2,\"time\":1365159474}","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}