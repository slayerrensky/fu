{"url":"https://api.github.com/repos/owncloud/core/issues/3570","labels_url":"https://api.github.com/repos/owncloud/core/issues/3570/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3570/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3570/events","html_url":"https://github.com/owncloud/core/issues/3570","id":15023290,"number":3570,"title":"owncloud client cannot connect to apache tomcat because content-type comparison is hard-coded","user":{"login":"christoph-mueller-crixp","id":4585184,"avatar_url":"https://gravatar.com/avatar/a3aabbd49df102c2609c124e515176de?d=https%3a%2f%2fidenticons.github.com%2ff331bf7b7a74d320fa0057adf450dbba.png&r=x","gravatar_id":"a3aabbd49df102c2609c124e515176de","url":"https://api.github.com/users/christoph-mueller-crixp","html_url":"https://github.com/christoph-mueller-crixp","followers_url":"https://api.github.com/users/christoph-mueller-crixp/followers","following_url":"https://api.github.com/users/christoph-mueller-crixp/following{/other_user}","gists_url":"https://api.github.com/users/christoph-mueller-crixp/gists{/gist_id}","starred_url":"https://api.github.com/users/christoph-mueller-crixp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/christoph-mueller-crixp/subscriptions","organizations_url":"https://api.github.com/users/christoph-mueller-crixp/orgs","repos_url":"https://api.github.com/users/christoph-mueller-crixp/repos","events_url":"https://api.github.com/users/christoph-mueller-crixp/events{/privacy}","received_events_url":"https://api.github.com/users/christoph-mueller-crixp/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":1,"created_at":"2013-06-01t05:37:08z","updated_at":"2013-06-01t09:14:59z","closed_at":"2013-06-01t09:10:17z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nowncloud should correctly parse content-type (http entity-header field as\r\ndefined by rfc 2616, section 14.17) so that connections to apache tomcat\r\nare possible). see also http://www.w3.org/protocols/rfc2616/rfc2616-sec14.html\r\n\r\n### actual behaviour\r\ncurrently, connections to apache tomcat are not possible because\r\nthe owncloud client does not properly parse the content-type;\r\nthe owncloud client simply compares the content-type returned\r\nby the webdav server with a hard-coded constant string, namely\r\n\"application/xml; charset=utf-8\"; the actual code in the client\r\nreads as follows:\r\n\r\ncontent_type = ne_get_response_header( request, \"content-type\" );\r\n\r\nif( !(content_type && c_streq(content_type, \"application/xml; charset=utf-8\") ) ) {\r\n  ...\r\n  \r\nwhile the above code works fine with apache httpd, it unfortunately fails\r\nwith apache tomcat, because the latter returns a content-type of the form\r\nof \"application/xml;charset=utf-8\" (note that owncloud client expects a\r\nblank right after the semicolon separating mimetype \"application/xml\"\r\nand charset \"charset=utf-8\" whereas apache tomcat's content-type does\r\nnot include such a blank:\r\n\r\ncontent-type returned by apache httpd:  \"application/xml; charset=utf-8\"\r\ncontent-type returned by apache tomcat: \"application/xml;charset=utf-8\"\r\n\r\nit is obvious, that both apache httpd and apache tomcat deliver a perfectly\r\nlegal content-type that fulfills all the requirements specified in the rfc.\r\nowncloud client, however, only accepts the content-type delivered by\r\napache httpd.\r\n\r\nwe suspect that there are other webdav servers that do not return\r\na content-type as it is hard-coded into the owncloud client, and\r\nhence the fine owncloud client cannot connect to such webdav servers.\r\n\r\n\r\n\r\n### steps to reproduce\r\nwe have analyzed the above describe behaviour while trying to connect\r\nvarious versions of the owncloud client with the opencrx webdav server\r\n(www.opencrx.org). the problem cannot be reproduced when the owncloud\r\nclient is used against the owncloud server (see description of \r\nexpected behavior above).\r\n\r\n### server configuration\r\n(the only relevant information is apache tomcat 7.0.39)\r\n\r\noperating system: centos 6.4\r\nweb server: apache tomee v1.5.2 (includes apache tomcat 7.0.39)\r\ndatabase: postgresql v.9.2\r\nphp version: (emulated by opencrx server v2.12)\r\nowncloud version: (emulated by opencrx server 2.12)\r\n\r\n### owncloud client\r\noperating system: ubuntu 13.04\r\nclient version: 1.2.1 (as available in the repository)\r\n\r\n### additional information\r\nwe're glad to help test new/beta client versions against apache tomcat.\r\nplesae contact us at christoph.mueller@crixp.com\r\n\r\n\r\nissue moved to  https://github.com/owncloud/mirall/issues/658","closed_by":{"login":"kabum","id":245432,"avatar_url":"https://gravatar.com/avatar/a1dea19f88f38ea0b5b5b4d19d5b3107?d=https%3a%2f%2fidenticons.github.com%2f53d8cbb3dbc087a02951dec47438ccdf.png&r=x","gravatar_id":"a1dea19f88f38ea0b5b5b4d19d5b3107","url":"https://api.github.com/users/kabum","html_url":"https://github.com/kabum","followers_url":"https://api.github.com/users/kabum/followers","following_url":"https://api.github.com/users/kabum/following{/other_user}","gists_url":"https://api.github.com/users/kabum/gists{/gist_id}","starred_url":"https://api.github.com/users/kabum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kabum/subscriptions","organizations_url":"https://api.github.com/users/kabum/orgs","repos_url":"https://api.github.com/users/kabum/repos","events_url":"https://api.github.com/users/kabum/events{/privacy}","received_events_url":"https://api.github.com/users/kabum/received_events","type":"user","site_admin":false}}