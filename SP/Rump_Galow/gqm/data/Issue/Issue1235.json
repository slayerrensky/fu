{"url":"https://api.github.com/repos/owncloud/core/issues/1235","labels_url":"https://api.github.com/repos/owncloud/core/issues/1235/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1235/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1235/events","html_url":"https://github.com/owncloud/core/issues/1235","id":10124388,"number":1235,"title":"centralize configuration in appinfo/info.xml","user":{"login":"raydiation","id":195053,"avatar_url":"https://gravatar.com/avatar/aa0d7b7302e0d7f4f9513c23b571383a?d=https%3a%2f%2fidenticons.github.com%2faf0a25e27510f77d97634a6bbe653b13.png&r=x","gravatar_id":"aa0d7b7302e0d7f4f9513c23b571383a","url":"https://api.github.com/users/raydiation","html_url":"https://github.com/raydiation","followers_url":"https://api.github.com/users/raydiation/followers","following_url":"https://api.github.com/users/raydiation/following{/other_user}","gists_url":"https://api.github.com/users/raydiation/gists{/gist_id}","starred_url":"https://api.github.com/users/raydiation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raydiation/subscriptions","organizations_url":"https://api.github.com/users/raydiation/orgs","repos_url":"https://api.github.com/users/raydiation/repos","events_url":"https://api.github.com/users/raydiation/events{/privacy}","received_events_url":"https://api.github.com/users/raydiation/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/enhancement","name":"enhancement","color":"02e10c"}],"state":"open","assignee":{"login":"raydiation","id":195053,"avatar_url":"https://gravatar.com/avatar/aa0d7b7302e0d7f4f9513c23b571383a?d=https%3a%2f%2fidenticons.github.com%2faf0a25e27510f77d97634a6bbe653b13.png&r=x","gravatar_id":"aa0d7b7302e0d7f4f9513c23b571383a","url":"https://api.github.com/users/raydiation","html_url":"https://github.com/raydiation","followers_url":"https://api.github.com/users/raydiation/followers","following_url":"https://api.github.com/users/raydiation/following{/other_user}","gists_url":"https://api.github.com/users/raydiation/gists{/gist_id}","starred_url":"https://api.github.com/users/raydiation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raydiation/subscriptions","organizations_url":"https://api.github.com/users/raydiation/orgs","repos_url":"https://api.github.com/users/raydiation/repos","events_url":"https://api.github.com/users/raydiation/events{/privacy}","received_events_url":"https://api.github.com/users/raydiation/received_events","type":"user","site_admin":false},"milestone":null,"comments":20,"created_at":"2013-01-19t12:12:04z","updated_at":"2013-07-11t01:53:00z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"the discussion was started in https://github.com/owncloud/core/pull/1214\r\n\r\nat the moment app developers have to configure their app settings in various different places . this includes: navigation entry settings, versions for schema updates, classloader and checks for enabled apps, etc\r\n\r\nsometimes you have to do this using php, sometimes its xml and sometimes its just a plain file with a number in it. this is inconsistent and takes more energy to document and understand. also by using php for things that get loaded before all apps, the risk is high that one syntax error in one app can break every app.\r\n\r\nwe came up with the following additions to the info.xml file\r\n    \r\n```xml\r\n<?xml version=\"1.0\"?>\r\n<app>\r\n    <id>myapp</id>\r\n    <name>my app</name>\r\n    <description>my app description</description>\r\n    <version>1.0</version>\r\n    <licences>\r\n        <licence>agpl</licence>\r\n    </licences>\r\n    <authors>\r\n        <author>\r\n            <name>myname</name>\r\n            <email>my@email.com</email>\r\n        </author>\r\n    </authors>\r\n\r\n    <require>5.0</require>\r\n\r\n    <admin linktype=\"route\">myapp_index</admin>\r\n\r\n    <search>\r\n        <provider>\\oca\\myapp\\searchprovider</provider>\r\n    </search>\r\n\r\n    <share>\r\n        <backend>\\oca\\myapp\\sharebackend</backend>\r\n    </share>\r\n\r\n    <backgroundjobs>\r\n        <job runtype=\"worker\">\\oca\\myapp\\backgroundjob</job>\r\n    </backgroundjobs>\r\n\r\n    <dependencies>\r\n        <app>appframework</app>\r\n    </dependencies>\r\n</app>\r\n```\r\n\r\nheres my schema file which validates the xml:\r\n```xml\r\n<xs:schema attributeformdefault=\"unqualified\" elementformdefault=\"qualified\" xmlns:xs=\"http://www.w3.org/2001/xmlschema\">\r\n\r\n  <!-- types -->\r\n  <xs:simpletype name=\"notempty\">\r\n    <xs:restriction base=\"xs:string\">\r\n      <xs:minlength value=\"1\"/>\r\n    </xs:restriction>\r\n  </xs:simpletype>\r\n\r\n  <xs:simpletype name=\"version\">\r\n    <xs:restriction base=\"xs:string\">\r\n      <xs:pattern value=\"[0-9]+(\\.[0-9]+)*\"/>\r\n    </xs:restriction>\r\n  </xs:simpletype>\r\n\r\n  <xs:simpletype name=\"email\">\r\n    <xs:restriction base=\"xs:string\">\r\n      <xs:pattern value=\"[a-za-z0-9_\\-\\.]+@[a-za-z0-9_\\-\\.]+\\..+\"/>\r\n    </xs:restriction>\r\n  </xs:simpletype>\r\n\r\n  <xs:simpletype name=\"loweralpha\">\r\n    <xs:restriction base=\"xs:string\">\r\n      <xs:pattern value=\"[a-z]+\"/>\r\n    </xs:restriction>\r\n  </xs:simpletype>\r\n\r\n  <!-- actual xml -->\r\n  <xs:element name=\"app\">\r\n    <xs:complextype>\r\n      <xs:all>\r\n\r\n        <xs:element name=\"id\" type=\"loweralpha\" />\r\n        <xs:element name=\"name\" type=\"notempty\" />\r\n        <xs:element name=\"description\" type=\"notempty\" />\r\n        <xs:element name=\"version\" type=\"version\" />\r\n\r\n        <!-- allow one or more licences -->\r\n        <xs:element name=\"licences\">\r\n          <xs:complextype>\r\n            <xs:sequence>\r\n              <xs:element name=\"licence\" minoccurs=\"1\" maxoccurs=\"unbounded\" type=\"notempty\" />\r\n            </xs:sequence>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n        <!-- allow one or more authors -->\r\n        <xs:element name=\"authors\">\r\n          <xs:complextype>\r\n            <xs:sequence>\r\n              <xs:element name=\"author\">\r\n                <xs:complextype>\r\n                  <xs:all>\r\n                    <xs:element name=\"name\" type=\"notempty\" />\r\n                    <xs:element name=\"email\" type=\"email\" />\r\n                  </xs:all>\r\n                </xs:complextype>\r\n              </xs:element>\r\n            </xs:sequence>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n        <!-- minimum owncloud version -->\r\n        <xs:element name=\"require\" type=\"version\" />\r\n\r\n        <!-- if the app can be used as a webapp for instance by gnome web -->\r\n        <xs:element name=\"webapp\" type=\"xs:boolean\" minoccurs=\"0\" maxoccurs=\"1\"/>\r\n\r\n        <!-- if the app is in the installed tar, 3rdparty apps must set false -->\r\n        <xs:element name=\"shipped\" type=\"xs:boolean\" minoccurs=\"0\" maxoccurs=\"1\"/>\r\n\r\n        <!-- if the app should be enabled by default -->\r\n        <xs:element name=\"default-enable\" type=\"xs:boolean\" minoccurs=\"0\" maxoccurs=\"1\"/>\r\n        \r\n        <!-- types can be given and be only of value: \r\n          * filesystem\r\n          * prelogin \r\n          * authentication\r\n          * logging\r\n        -->\r\n        <xs:element name=\"types\" minoccurs=\"0\" maxoccurs=\"1\">\r\n          <xs:complextype>\r\n            <xs:sequence>\r\n              <xs:element name=\"type\" minoccurs=\"1\" maxoccurs=\"unbounded\">\r\n                <xs:simpletype>\r\n                  <xs:restriction base=\"xs:string\">\r\n                    <xs:enumeration value=\"filesystem\" />\r\n                    <xs:enumeration value=\"prelogin\" />\r\n                    <xs:enumeration value=\"authentication\" />\r\n                    <xs:enumeration value=\"logging\" />\r\n                  </xs:restriction>\r\n                </xs:simpletype>\r\n              </xs:element>\r\n            </xs:sequence>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n        <!-- contains the link to the admin settings page and can specify a\r\n        link or a route -->\r\n        <xs:element name=\"admin\" minoccurs=\"0\" maxoccurs=\"1\">\r\n          <xs:complextype>\r\n            <xs:simplecontent>\r\n              <xs:extension base=\"notempty\">\r\n                <xs:attribute name=\"linktype\" use=\"required\">\r\n                  <xs:simpletype>\r\n                    <xs:restriction base=\"xs:string\">\r\n                      <xs:enumeration value=\"file\" />\r\n                      <xs:enumeration value=\"route\" />\r\n                    </xs:restriction>\r\n                  </xs:simpletype>\r\n                </xs:attribute>\r\n              </xs:extension>\r\n            </xs:simplecontent>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n        <!-- can be specified and contains a list of search provider classes-->\r\n        <xs:element name=\"search\" minoccurs=\"0\" maxoccurs=\"1\">\r\n          <xs:complextype>\r\n            <xs:sequence>\r\n              <xs:element name=\"provider\" type=\"notempty\" minoccurs=\"1\" maxoccurs=\"unbounded\"></xs:element>\r\n            </xs:sequence>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n        <!-- can be specified and contains a list of share backend classes-->\r\n        <xs:element name=\"share\" minoccurs=\"0\" maxoccurs=\"1\">\r\n          <xs:complextype>\r\n            <xs:sequence>\r\n              <xs:element name=\"backend\" type=\"notempty\" minoccurs=\"1\" maxoccurs=\"unbounded\"></xs:element>\r\n            </xs:sequence>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n        <!-- allows to specify app dependencies -->\r\n        <xs:element name=\"dependencies\" minoccurs=\"0\" maxoccurs=\"1\">\r\n          <xs:complextype>\r\n            <xs:sequence>\r\n              <xs:element name=\"app\" type=\"notempty\" minoccurs=\"1\" maxoccurs=\"unbounded\"/>\r\n            </xs:sequence>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n        <!-- allows to specify background jobs of type:\r\n          * worker\r\n          * regular\r\n          * queue \r\n        -->\r\n        <xs:element name=\"backgroundjobs\" minoccurs=\"0\" maxoccurs=\"1\">\r\n          <xs:complextype>\r\n            <xs:sequence>\r\n              <xs:element name=\"job\" minoccurs=\"1\" maxoccurs=\"unbounded\">\r\n                <xs:complextype>\r\n                  <xs:simplecontent>\r\n                    <xs:extension base=\"notempty\">\r\n                      <xs:attribute name=\"runtype\" use=\"required\">\r\n                        <xs:simpletype>\r\n                          <xs:restriction base=\"xs:string\">\r\n                            <xs:enumeration value=\"regular\" />\r\n                            <xs:enumeration value=\"worker\" />\r\n                            <xs:enumeration value=\"queue\" />\r\n                          </xs:restriction>\r\n                        </xs:simpletype>\r\n                      </xs:attribute>\r\n                    </xs:extension>\r\n                  </xs:simplecontent>\r\n                </xs:complextype>\r\n              </xs:element>\r\n            </xs:sequence>\r\n          </xs:complextype>\r\n        </xs:element>\r\n\r\n      </xs:all>\r\n    </xs:complextype>\r\n  </xs:element>\r\n\r\n\r\n</xs:schema>\r\n```","closed_by":{"login":"raydiation","id":195053,"avatar_url":"https://gravatar.com/avatar/aa0d7b7302e0d7f4f9513c23b571383a?d=https%3a%2f%2fidenticons.github.com%2faf0a25e27510f77d97634a6bbe653b13.png&r=x","gravatar_id":"aa0d7b7302e0d7f4f9513c23b571383a","url":"https://api.github.com/users/raydiation","html_url":"https://github.com/raydiation","followers_url":"https://api.github.com/users/raydiation/followers","following_url":"https://api.github.com/users/raydiation/following{/other_user}","gists_url":"https://api.github.com/users/raydiation/gists{/gist_id}","starred_url":"https://api.github.com/users/raydiation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raydiation/subscriptions","organizations_url":"https://api.github.com/users/raydiation/orgs","repos_url":"https://api.github.com/users/raydiation/repos","events_url":"https://api.github.com/users/raydiation/events{/privacy}","received_events_url":"https://api.github.com/users/raydiation/received_events","type":"user","site_admin":false}}