{"url":"https://api.github.com/repos/owncloud/core/issues/3513","labels_url":"https://api.github.com/repos/owncloud/core/issues/3513/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3513/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3513/events","html_url":"https://github.com/owncloud/core/issues/3513","id":14825678,"number":3513,"title":"[4.5.11] some ldap users not shown in share  dialog","user":{"login":"gufete","id":3624134,"avatar_url":"https://gravatar.com/avatar/8101a21703698ae0a9be0767b157396d?d=https%3a%2f%2fidenticons.github.com%2ff68e2b24587ec97bdb43ca5f6440f56d.png&r=x","gravatar_id":"8101a21703698ae0a9be0767b157396d","url":"https://api.github.com/users/gufete","html_url":"https://github.com/gufete","followers_url":"https://api.github.com/users/gufete/followers","following_url":"https://api.github.com/users/gufete/following{/other_user}","gists_url":"https://api.github.com/users/gufete/gists{/gist_id}","starred_url":"https://api.github.com/users/gufete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gufete/subscriptions","organizations_url":"https://api.github.com/users/gufete/orgs","repos_url":"https://api.github.com/users/gufete/repos","events_url":"https://api.github.com/users/gufete/events{/privacy}","received_events_url":"https://api.github.com/users/gufete/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3auser_ldap","name":"app:user_ldap","color":"02d7e1"},{"url":"https://api.github.com/repos/owncloud/core/labels/v4.5.x","name":"v4.5.x","color":"dddddd"}],"state":"closed","assignee":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"milestone":null,"comments":19,"created_at":"2013-05-28t07:49:12z","updated_at":"2013-10-22t21:37:29z","closed_at":"2013-10-22t21:37:29z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"hello \r\n\r\nwe are running owncloud 4.5.11+mysql on centos 6 x64. we have a ldap backend. we have ldap cache ttl of 24 hours and run the follwing script in cron daily:\r\n<pre>\r\n#!/usr/bin/php\r\nrequire_once '/var/www/html/owncloud/lib/base.php';\r\n// clean cache\r\n$ldap = new \\oca\\user_ldap\\lib\\connection('user_ldap');\r\n$ldap->clearcache();\r\n// sync\r\n$get_search = 'x';\r\n$limit = 0;\r\n$offset = 0;\r\n$users = oc_user::getusers($get_search, $limit, $offset);\r\n\r\n</pre>\r\n\r\ni can see all ldap users in the oc_ldap_user_mapping table. the problem happens when user a tries to share a file with another user. most of them can be found in the autocomplete share dialog, but other ones do not appear, but they are in the oc_ldap_user_mapping table in mysql. \r\n\r\nexample:\r\n\r\nuser a wants to share a file with user b or user c. in the share dialog user b appears, but not user c, and both are in the oc_ldap_user_mapping table:\r\n\r\n<pre>\r\nmysql> select * from oc_ldap_user_mapping where ldap_dn='uid=userb,o=mysite,dc=we,dc=es';\r\n\r\n+--------------------------------+---------------+----------------+\r\n| ldap_dn                        | owncloud_name | directory_uuid |\r\n+--------------------------------+---------------+----------------+\r\n| uid=userb,o=mysite,dc=we,dc=es | userb         |                |\r\n+--------------------------------+---------------+----------------+\r\n1 row in set (0.00 sec)\r\n\r\nmysql> select * from oc_ldap_user_mapping where ldap_dn='uid=userb,o=mysite.es,dc=we,dc=es';\r\n\r\n+----------------------------- --+---------------+----------------+\r\n| ldap_dn                        | owncloud_name | directory_uuid |\r\n+--------------------------------+---------------+----------------+\r\n| uid=userc,o=mysite,dc=we,dc=es | userc         |                |\r\n+--------------------------------+---------------+----------------+\r\n</pre>\r\n\r\nany hint?","closed_by":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false}}