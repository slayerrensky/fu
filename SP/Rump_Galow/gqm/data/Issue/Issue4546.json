{"url":"https://api.github.com/repos/owncloud/core/issues/4546","labels_url":"https://api.github.com/repos/owncloud/core/issues/4546/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4546/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4546/events","html_url":"https://github.com/owncloud/core/issues/4546","id":18404143,"number":4546,"title":"chucks are saved even if incomplete.","user":{"login":"ogoffart","id":959326,"avatar_url":"https://gravatar.com/avatar/3d5bb00e84aa3200aea132e92300cdb4?d=https%3a%2f%2fidenticons.github.com%2f03e6f725155bf82c3986f0199d4d59ab.png&r=x","gravatar_id":"3d5bb00e84aa3200aea132e92300cdb4","url":"https://api.github.com/users/ogoffart","html_url":"https://github.com/ogoffart","followers_url":"https://api.github.com/users/ogoffart/followers","following_url":"https://api.github.com/users/ogoffart/following{/other_user}","gists_url":"https://api.github.com/users/ogoffart/gists{/gist_id}","starred_url":"https://api.github.com/users/ogoffart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ogoffart/subscriptions","organizations_url":"https://api.github.com/users/ogoffart/orgs","repos_url":"https://api.github.com/users/ogoffart/repos","events_url":"https://api.github.com/users/ogoffart/events{/privacy}","received_events_url":"https://api.github.com/users/ogoffart/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"milestone":{"url":"https://api.github.com/repos/owncloud/core/milestones/3","labels_url":"https://api.github.com/repos/owncloud/core/milestones/3/labels","id":199679,"number":3,"title":"owncloud 6","description":"","creator":{"login":"lukasreschke","id":878997,"avatar_url":"https://gravatar.com/avatar/f080e75d370a4d8e550983a4898bcf3b?d=https%3a%2f%2fidenticons.github.com%2ff12e47d5bb5359a9f58e8217413be790.png&r=x","gravatar_id":"f080e75d370a4d8e550983a4898bcf3b","url":"https://api.github.com/users/lukasreschke","html_url":"https://github.com/lukasreschke","followers_url":"https://api.github.com/users/lukasreschke/followers","following_url":"https://api.github.com/users/lukasreschke/following{/other_user}","gists_url":"https://api.github.com/users/lukasreschke/gists{/gist_id}","starred_url":"https://api.github.com/users/lukasreschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukasreschke/subscriptions","organizations_url":"https://api.github.com/users/lukasreschke/orgs","repos_url":"https://api.github.com/users/lukasreschke/repos","events_url":"https://api.github.com/users/lukasreschke/events{/privacy}","received_events_url":"https://api.github.com/users/lukasreschke/received_events","type":"user","site_admin":false},"open_issues":19,"closed_issues":645,"state":"open","created_at":"2012-10-22t21:38:51z","updated_at":"2013-12-18t11:11:18z","due_on":null},"comments":2,"created_at":"2013-08-22t10:03:49z","updated_at":"2013-10-16t16:26:18z","closed_at":"2013-10-14t13:39:32z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\n\r\nwhen the connection is closed while a chunk is being uploadec , the chunk should be dropped \r\n\r\n### actual behaviour\r\n\r\ndropping the connection while a chunk is uploaded will save the incomplete chunk. in particular, if the connection is dropped while the last chunk is uploaded, it will create the incomplete file.\r\n\r\n### steps to reproduce\r\n\r\n1. open the sync client\r\n2. create a big file (eg 20mib) in the sync folder ( `dd if=/dev/urandom of=./file3.dd bs=1024 count=20000` )\r\n3. observe the progress (if you have the version 1.4 of the client, you see a nice progress bar,  and you can limit the upload rate to make it easize).  and when the last chunk is being uploaded  (eg, 15mib out of 20mib), kill the client (ctrl+c or xkill)\r\n4. observe that the file is on the server but incomplete.\r\n\r\n### server configuration\r\n\r\nowncloud version: stable5\r\n\r\n### how to fix it:\r\n\r\nhttps://github.com/owncloud/core/blob/master/lib/connector/sabre/directory.php#l77 already check that a put contains the same lenght as the content-lenght,   but it does not do it for chunking a fes lines earlier.\r\n","closed_by":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false}}