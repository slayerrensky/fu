{"url":"https://api.github.com/repos/owncloud/core/issues/6067","labels_url":"https://api.github.com/repos/owncloud/core/issues/6067/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/6067/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/6067/events","html_url":"https://github.com/owncloud/core/issues/6067","id":23323017,"number":6067,"title":"backgroundwatcher keeps trying to scan non-existing files which results in warnings","user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-11-26t15:44:25z","updated_at":"2013-12-03t11:41:16z","closed_at":"2013-11-29t11:08:41z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"after disabling the encryption app and decrypting all files the backgroundwatcher still tries to scan keyfiles which no longer exists and write warnings to the log file regularly:\r\n\r\n```\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php warning:  filemtime(): stat failed for /home/src/owncloud/web/oc/data/schiesbn/files_encryption/share-keys/foo/bar (restored 2)/lauflernwagen.txt.user2.sharekey in /home/src/owncloud/web/oc/lib/private/files/storage/local.php on line 127, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php stack trace:, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   1. {main}() /home/src/owncloud/web/oc/cron.php:0, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   2. oc\\\\backgroundjob\\\\job->execute() /home/src/owncloud/web/oc/cron.php:112, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   3. oc\\\\backgroundjob\\\\legacy\\\\regularjob->run() /home/src/owncloud/web/oc/lib/private/backgroundjob/job.php:21, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   4. call_user_func() /home/src/owncloud/web/oc/lib/private/backgroundjob/legacy/regularjob.php:13, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   5. oc\\\\files\\\\cache\\\\backgroundwatcher::checknext() /home/src/owncloud/web/oc/lib/private/backgroundjob/legacy/regularjob.php:13, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   6. oc\\\\files\\\\cache\\\\backgroundwatcher::checkupdate() /home/src/owncloud/web/oc/lib/private/files/cache/backgroundwatcher.php:83, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   7. oc\\\\files\\\\cache\\\\watcher->checkupdate() /home/src/owncloud/web/oc/lib/private/files/cache/backgroundwatcher.php:50, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   8. oc\\\\files\\\\storage\\\\local->hasupdated() /home/src/owncloud/web/oc/lib/private/files/cache/watcher.php:47, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php   9. oc\\\\files\\\\storage\\\\local->filemtime() /home/src/owncloud/web/oc/lib/private/files/storage/local.php:299, referer: http://localhost/oc/index.php/apps/files\r\n[tue nov 26 16:36:32 2013] [error] [client ::1] php  10. filemtime() /home/src/owncloud/web/oc/lib/private/files/storage/local.php:127, referer: http://localhost/oc/index.php/apps/files\r\n```\r\n\r\ni would expect the the scanner removes files from the cache if they no longer exists or do something else to handle the situation without producing errors/warnings.\r\n\r\n@icewind1991 any idea what we could do here?","closed_by":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false}}