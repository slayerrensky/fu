{"url":"https://api.github.com/repos/owncloud/core/issues/2772","labels_url":"https://api.github.com/repos/owncloud/core/issues/2772/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2772/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2772/events","html_url":"https://github.com/owncloud/core/issues/2772","id":12885021,"number":2772,"title":"base.php:init() sets up user backends before they are all loaded","user":{"login":"sshambar","id":640696,"avatar_url":"https://gravatar.com/avatar/fcbcb48341b2936fdd244f8dc6c78c38?d=https%3a%2f%2fidenticons.github.com%2fd6d4ef7d212d1895ccf6d7ff8e63710e.png&r=x","gravatar_id":"fcbcb48341b2936fdd244f8dc6c78c38","url":"https://api.github.com/users/sshambar","html_url":"https://github.com/sshambar","followers_url":"https://api.github.com/users/sshambar/followers","following_url":"https://api.github.com/users/sshambar/following{/other_user}","gists_url":"https://api.github.com/users/sshambar/gists{/gist_id}","starred_url":"https://api.github.com/users/sshambar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshambar/subscriptions","organizations_url":"https://api.github.com/users/sshambar/orgs","repos_url":"https://api.github.com/users/sshambar/repos","events_url":"https://api.github.com/users/sshambar/events{/privacy}","received_events_url":"https://api.github.com/users/sshambar/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"open","assignee":null,"milestone":null,"comments":22,"created_at":"2013-04-06t23:30:18z","updated_at":"2013-12-05t16:46:29z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"owncloud 5.0.3\r\n\r\noc_user:setupbackends() is called in base.php:504 in init(), but for many entrypoints (login page, ajax, public etc) $runtime_noapps = true, which delays the loading of apps (including authentication type).  this leads to some user_backends generating errors such as:\r\n\r\n{\"app\":\"core\",\"message\":\"user backend oc_user_imap not found.\",\"level\":3,\"time\":1365280042}\r\n\r\nthis could be fixed by loading authentication apps even when $runtime_noapps = false (eg. oc_app::loadapps('authentication'); ), updating all the entry points to set $runtime_apptypes = 'authentication', or just eliminating the early call to setupbackends() -- which should be called later anyway when a login is detected (or on the login form).\r\n\r\nthe simple change below appears to eliminate the error log, and still allow owncloud to work as expected:\r\n\r\n```diff\r\n--- lib/base.php-orig   2013-04-03 01:03:26.000000000 -0700\r\n+++ lib/base.php        2013-04-06 16:19:34.164411663 -0700\r\n@@ -500,9 +500,6 @@\r\n                        }\r\n                }\r\n \r\n-               //setup extra user backends\r\n-               oc_user::setupbackends();\r\n-\r\n                self::registercachehooks();\r\n                self::registerfilesystemhooks();\r\n                self::registersharehooks();\r\n```\r\n","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}