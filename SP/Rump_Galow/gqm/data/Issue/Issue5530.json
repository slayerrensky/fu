{"url":"https://api.github.com/repos/owncloud/core/issues/5530","labels_url":"https://api.github.com/repos/owncloud/core/issues/5530/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/5530/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/5530/events","html_url":"https://github.com/owncloud/core/issues/5530","id":21537777,"number":5530,"title":"shared, encrypted files broke after renaming","user":{"login":"torstent","id":5767413,"avatar_url":"https://gravatar.com/avatar/c5057ddb0af64c71d4e7da86c6912c4e?d=https%3a%2f%2fidenticons.github.com%2fb897638c7934ea975c7f05daad497b68.png&r=x","gravatar_id":"c5057ddb0af64c71d4e7da86c6912c4e","url":"https://api.github.com/users/torstent","html_url":"https://github.com/torstent","followers_url":"https://api.github.com/users/torstent/followers","following_url":"https://api.github.com/users/torstent/following{/other_user}","gists_url":"https://api.github.com/users/torstent/gists{/gist_id}","starred_url":"https://api.github.com/users/torstent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/torstent/subscriptions","organizations_url":"https://api.github.com/users/torstent/orgs","repos_url":"https://api.github.com/users/torstent/repos","events_url":"https://api.github.com/users/torstent/events{/privacy}","received_events_url":"https://api.github.com/users/torstent/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"open","assignee":null,"milestone":null,"comments":3,"created_at":"2013-10-24t17:23:09z","updated_at":"2013-11-13t19:24:54z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"owncloud-version: 5\r\n\r\nshort description:\r\nif a user renames a shared file, nor him or someone else is able to open the file again.\r\n\r\nreproduction steps:\r\n1) user john is the owncloud admin and enables the encryption app on an empty never-touched owncloud-instance. he also creates a new group \"developers\" and another user \"carl\". carl is not an admin. john and carl are both in group \"developers\"\r\n2) john creates a folder \"pictures\" and uploads a file (e.g. pic1.jpg) in that folder\r\n3) john shares folder \"pictures\" with the group \"developers\" and grants edit rights (but not the right to delete)\r\n4) john can open pic1.jpg\r\n5) john logs out\r\n6) carl logs in on the same pc\r\n7) carls opens the folder \"pictures\" and views the file \"pic1.jpg\"\r\n8) carl now renames \"pic1.jpg\" to \"nice_view.jpg\"\r\n9) carl tries to open \"nice_view.jpg\" but get the folloing error message: \r\n\"the requested content cannot be loaded.\r\nplease try again later.\"\r\n10) carl logs out\r\n11) john logs in\r\n12) carl tries to open \"nice_view.jpg\" but get the folloing error message: \r\n\"the requested content cannot be loaded.\r\nplease try again later.\"\r\n\r\nlogs:\r\n{\"app\":\"php\",\"message\":\"encryption key not found for \\\"\\/carl\\/files\\/shared\\/pictures\\/nice_view.jpg\\\" during attempted read via stream at \\/data\\/234\\/html\\/owncloud\\/apps\\/files_encryption\\/lib\\/stream.php#187\",\"level\":4,\"time\":\"2013-10-24t17:19:30+00:00\"}","closed_by":null}