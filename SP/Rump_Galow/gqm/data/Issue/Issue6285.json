{"url":"https://api.github.com/repos/owncloud/core/issues/6285","labels_url":"https://api.github.com/repos/owncloud/core/issues/6285/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/6285/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/6285/events","html_url":"https://github.com/owncloud/core/issues/6285","id":24026739,"number":6285,"title":"update from oc6 beta4 to rc3 fails","user":{"login":"sufflope","id":4585916,"avatar_url":"https://gravatar.com/avatar/3b832e4097777d0706a3b9aa8d1097f6?d=https%3a%2f%2fidenticons.github.com%2f447981519c43221610529a5e47d555c7.png&r=x","gravatar_id":"3b832e4097777d0706a3b9aa8d1097f6","url":"https://api.github.com/users/sufflope","html_url":"https://github.com/sufflope","followers_url":"https://api.github.com/users/sufflope/followers","following_url":"https://api.github.com/users/sufflope/following{/other_user}","gists_url":"https://api.github.com/users/sufflope/gists{/gist_id}","starred_url":"https://api.github.com/users/sufflope/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sufflope/subscriptions","organizations_url":"https://api.github.com/users/sufflope/orgs","repos_url":"https://api.github.com/users/sufflope/repos","events_url":"https://api.github.com/users/sufflope/events{/privacy}","received_events_url":"https://api.github.com/users/sufflope/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-12-10t10:50:24z","updated_at":"2013-12-12t10:01:53z","closed_at":"2013-12-12t10:01:53z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nmanually update from oc6 beta4 to rc3\r\n\r\n### actual behaviour\r\ninstance is stuck on upgrade page with \"please reload the page.\" error message, and errors in owncloud.log\r\n\r\n### steps to reproduce\r\n1. install oc6 beta3\r\n2. update to beta4\r\n3. try to update to rc3\r\n\r\n### server configuration\r\noperating system: fedora 19\r\n\r\nweb server: apache 2.4.6\r\n\r\ndatabase: postgresql 9.2.5\r\n\r\nphp version: 5.5.6\r\n\r\nowncloud version: 6 beta4 initially\r\n\r\nupdated from an older owncloud or fresh install: installed from beta3, updated to beta4\r\n\r\nlist of activated app: as long as i remember, default apps + bookmarks\r\n\r\nthe content of config/config.php:\r\n```\r\n<?php\r\n$config = array (\r\n  'instanceid' => 'ocjgjv657nbm',\r\n  'passwordsalt' => 'deadbeef',\r\n  'datadirectory' => '/srv/owncloud/owncloud/data',\r\n  'dbtype' => 'pgsql',\r\n  'version' => '6.0.0.6',\r\n  'dbname' => 'owncloud',\r\n  'dbhost' => 'localhost',\r\n  'dbtableprefix' => 'oc_',\r\n  'dbuser' => 'owncloud',\r\n  'dbpassword' => 'pwd',\r\n  'installed' => true,\r\n  'forcessl' => false,\r\n  'theme' => '',\r\n  'maintenance' => false,\r\n);\r\n```\r\n\r\n### logs\r\n#### web server error log\r\n```\r\n[tue dec 10 11:47:16.133457 2013] [:error] [pid 29667] [client 1.2.3.4:20804] php fatal error:  method oc_l10n_string::__tostring() must not throw an exception in /srv/owncloud/owncloud/lib/private/app.php on line 0, referer: https://owncloud.domain/index.php/apps/files\r\n```\r\n\r\n#### owncloud log (data/owncloud.log)\r\n```\r\n{\"app\":\"core\",\"message\":\"failed to update database structure (exception 'pdoexception' with message 'sqlstate[42601]: syntax error: 7 erreur:  erreur de syntaxe \\u00e0 la fin de l'entr\\u00e9e\\nline 1: alter table \\\"oc_pictures_images_cache\\\" alter width set \\n                                                               ^' in \\/srv\\/owncloud\\/owncloud\\/3rdparty\\/doctrine\\/dbal\\/lib\\/doctrine\\/dbal\\/connection.php:742\\nstack trace:\\n#0 [internal function]: pdo->query('alter table \\\"oc...')\\n#1 \\/srv\\/owncloud\\/owncloud\\/3rdparty\\/doctrine\\/dbal\\/lib\\/doctrine\\/dbal\\/connection.php(742): call_user_func_array(array, array)\\n#2 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/db\\/mdb2schemamanager.php(152): doctrine\\\\dbal\\\\connection->query('alter table \\\"oc...')\\n#3 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/db\\/mdb2schemamanager.php(91): oc\\\\db\\\\mdb2schemamanager->executeschemachange(object(doctrine\\\\dbal\\\\schema\\\\schemadiff))\\n#4 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/db.php(373): oc\\\\db\\\\mdb2schemamanager->updatedbfromstructure('\\/srv\\/owncloud\\/o...')\\n#5 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(965): oc_db::updatedbfromstructure('\\/srv\\/owncloud\\/o...')\\n#6 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(867): oc_app::updateapp('gallery')\\n#7 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(92): oc_app::checkupgrade('gallery')\\n#8 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(66): oc_app::loadapp('gallery')\\n#9 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/util.php(36): oc_app::loadapps(array)\\n#10 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/files\\/filesystem.php(800): oc_util::setupfs()\\n#11 \\/srv\\/owncloud\\/owncloud\\/lib\\/autoloader.php(143): require_once('\\/srv\\/owncloud\\/o...')\\n#12 [internal function]: oc\\\\autoloader->load('oc\\\\files\\\\filesy...')\\n#13 \\/srv\\/owncloud\\/owncloud\\/apps\\/search_lucene\\/appinfo\\/app.php(74): spl_autoload_call('oc\\\\files\\\\filesy...')\\n#14 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(93): require_once('\\/srv\\/owncloud\\/o...')\\n#15 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(971): oc_app::loadapp('search_lucene')\\n#16 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(867): oc_app::updateapp('search_lucene')\\n#17 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(92): oc_app::checkupgrade('search_lucene')\\n#18 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(66): oc_app::loadapp('search_lucene')\\n#19 \\/srv\\/owncloud\\/owncloud\\/lib\\/base.php(689): oc_app::loadapps()\\n#20 \\/srv\\/owncloud\\/owncloud\\/index.php(30): oc::handlerequest()\\n#21 {main}\\n\\nnext exception 'doctrine\\\\dbal\\\\dbalexception' with message 'an exception occurred while executing 'alter table \\\"oc_pictures_images_cache\\\" alter width set ':\\n\\nsqlstate[42601]: syntax error: 7 erreur:  erreur de syntaxe \\u00e0 la fin de l'entr\\u00e9e\\nline 1: alter table \\\"oc_pictures_images_cache\\\" alter width set \\n                                                               ^' in \\/srv\\/owncloud\\/owncloud\\/3rdparty\\/doctrine\\/dbal\\/lib\\/doctrine\\/dbal\\/dbalexception.php:47\\nstack trace:\\n#0 \\/srv\\/owncloud\\/owncloud\\/3rdparty\\/doctrine\\/dbal\\/lib\\/doctrine\\/dbal\\/connection.php(744): doctrine\\\\dbal\\\\dbalexception::driverexceptionduringquery(object(pdoexception), 'alter table \\\"oc...')\\n#1 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/db\\/mdb2schemamanager.php(152): doctrine\\\\dbal\\\\connection->query('alter table \\\"oc...')\\n#2 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/db\\/mdb2schemamanager.php(91): oc\\\\db\\\\mdb2schemamanager->executeschemachange(object(doctrine\\\\dbal\\\\schema\\\\schemadiff))\\n#3 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/db.php(373): oc\\\\db\\\\mdb2schemamanager->updatedbfromstructure('\\/srv\\/owncloud\\/o...')\\n#4 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(965): oc_db::updatedbfromstructure('\\/srv\\/owncloud\\/o...')\\n#5 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(867): oc_app::updateapp('gallery')\\n#6 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(92): oc_app::checkupgrade('gallery')\\n#7 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(66): oc_app::loadapp('gallery')\\n#8 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/util.php(36): oc_app::loadapps(array)\\n#9 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/files\\/filesystem.php(800): oc_util::setupfs()\\n#10 \\/srv\\/owncloud\\/owncloud\\/lib\\/autoloader.php(143): require_once('\\/srv\\/owncloud\\/o...')\\n#11 [internal function]: oc\\\\autoloader->load('oc\\\\files\\\\filesy...')\\n#12 \\/srv\\/owncloud\\/owncloud\\/apps\\/search_lucene\\/appinfo\\/app.php(74): spl_autoload_call('oc\\\\files\\\\filesy...')\\n#13 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(93): require_once('\\/srv\\/owncloud\\/o...')\\n#14 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(971): oc_app::loadapp('search_lucene')\\n#15 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(867): oc_app::updateapp('search_lucene')\\n#16 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(92): oc_app::checkupgrade('search_lucene')\\n#17 \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php(66): oc_app::loadapp('search_lucene')\\n#18 \\/srv\\/owncloud\\/owncloud\\/lib\\/base.php(689): oc_app::loadapps()\\n#19 \\/srv\\/owncloud\\/owncloud\\/index.php(30): oc::handlerequest()\\n#20 {main})\",\"level\":4,\"time\":\"2013-12-10t10:47:16+00:00\"}\r\n{\"app\":\"php\",\"message\":\"method oc_l10n_string::__tostring() must not throw an exception at \\/srv\\/owncloud\\/owncloud\\/lib\\/private\\/app.php#0\",\"level\":3,\"time\":\"2013-12-10t10:47:16+00:00\"}\r\n```","closed_by":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false}}