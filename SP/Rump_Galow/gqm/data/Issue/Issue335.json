{"url":"https://api.github.com/repos/owncloud/core/issues/335","labels_url":"https://api.github.com/repos/owncloud/core/issues/335/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/335/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/335/events","html_url":"https://github.com/owncloud/core/pull/335","id":8232849,"number":335,"title":"sharing folder sync stable45","user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":6,"created_at":"2012-11-09t10:32:46z","updated_at":"2012-11-13t18:37:03z","closed_at":"2012-11-13t15:28:03z","pull_request":{"html_url":"https://github.com/owncloud/core/pull/335","diff_url":"https://github.com/owncloud/core/pull/335.diff","patch_url":"https://github.com/owncloud/core/pull/335.patch"},"body":"this fixes the problem we had while syncing the shared folder (issue #260) for stable45. for master we will wait until the new file cache is in place.\r\n\r\n- the main problem was that the etags where stored for each virtual \"shared-folder-path\" but not for the real physical path. to detect changes from every user with access to the file i now store only the real path in the properties table.\r\n\r\n- since i need to get the origin file source of a shared folder/file i created a new class  oc_files_sharing_util which provides public access to the necessary code originally implemented in oc_filestorage_shared. for now i just copied the necessary functions over to the new class to avoid unwanted side effects.\r\n\r\n- since it is quite hard and expensive to find all users which have access to a particular file i decided to always modify the etag for the shared folder.  this means that for every check the sync client will look in the root sync dir and the root of the shared folder for changes.\r\n\r\n@dragotin and @danimo please also have a look at it and test it with the desktop client.","closed_by":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false}}