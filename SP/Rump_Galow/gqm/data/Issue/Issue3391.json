{"url":"https://api.github.com/repos/owncloud/core/issues/3391","labels_url":"https://api.github.com/repos/owncloud/core/issues/3391/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3391/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3391/events","html_url":"https://github.com/owncloud/core/issues/3391","id":14425587,"number":3391,"title":"ampache xml server returns invalid url & incomplete headers","user":{"login":"leo-andres","id":4450672,"avatar_url":"https://gravatar.com/avatar/86b90d85e715fe27aa68d297f5af5582?d=https%3a%2f%2fidenticons.github.com%2f7e5b3820c4a66804c521a3380f392f55.png&r=x","gravatar_id":"86b90d85e715fe27aa68d297f5af5582","url":"https://api.github.com/users/leo-andres","html_url":"https://github.com/leo-andres","followers_url":"https://api.github.com/users/leo-andres/followers","following_url":"https://api.github.com/users/leo-andres/following{/other_user}","gists_url":"https://api.github.com/users/leo-andres/gists{/gist_id}","starred_url":"https://api.github.com/users/leo-andres/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leo-andres/subscriptions","organizations_url":"https://api.github.com/users/leo-andres/orgs","repos_url":"https://api.github.com/users/leo-andres/repos","events_url":"https://api.github.com/users/leo-andres/events{/privacy}","received_events_url":"https://api.github.com/users/leo-andres/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":1,"created_at":"2013-05-16t20:38:55z","updated_at":"2013-05-16t20:57:05z","closed_at":"2013-05-16t20:57:05z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"owncloud 5.0.6 on ubuntu server, php 5.3.5\r\nclient: tomahawk 0.7 + latest ampache plugin\r\n\r\ntomahawk can't download any files because the url reported in the xml data is invalid.\r\ncorrect url: http://cloud \r\nowncloud output: http&# 058;&# 047;&# 047;cloud (spaces added by me, note the ascii-encoding)\r\n\r\ni removed the xmlentities function in /owncloud/apps/media/lib/ampache.php, line 178:\r\n$songdata['url'] = xmlentities($url);\r\nowncloud now returns the url in the correct format.\r\n\r\nanother issue are the http-headers: tomahawk uses the http status code to check for expired sessions.\r\nowncloud always responds \"http 200/ok\" and outputs \"invalid login\" in the xml data (which isn't checked by tomahawk)\r\n\r\ni changed the error template /owncloud/apps/media/templates/ampache/error.php\r\nto send a second http header (not sure if this is really needed):\r\n> header(\"http/1.0 401 unauthorized\");\r\n\r\ntomahawk no works without any mayor issues! i think there is some more work on the xml-encoding needed.","closed_by":{"login":"tanghus","id":533222,"avatar_url":"https://gravatar.com/avatar/e625b634822713b2e346ff7c67d26775?d=https%3a%2f%2fidenticons.github.com%2f6d9c90af1c12f5a88e4d5f216bbc1979.png&r=x","gravatar_id":"e625b634822713b2e346ff7c67d26775","url":"https://api.github.com/users/tanghus","html_url":"https://github.com/tanghus","followers_url":"https://api.github.com/users/tanghus/followers","following_url":"https://api.github.com/users/tanghus/following{/other_user}","gists_url":"https://api.github.com/users/tanghus/gists{/gist_id}","starred_url":"https://api.github.com/users/tanghus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanghus/subscriptions","organizations_url":"https://api.github.com/users/tanghus/orgs","repos_url":"https://api.github.com/users/tanghus/repos","events_url":"https://api.github.com/users/tanghus/events{/privacy}","received_events_url":"https://api.github.com/users/tanghus/received_events","type":"user","site_admin":false}}