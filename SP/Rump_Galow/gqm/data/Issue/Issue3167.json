{"url":"https://api.github.com/repos/owncloud/core/issues/3167","labels_url":"https://api.github.com/repos/owncloud/core/issues/3167/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3167/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3167/events","html_url":"https://github.com/owncloud/core/issues/3167","id":13757878,"number":3167,"title":"deleting user (with symlink from files) and recreating shows old file cache","user":{"login":"unhammer","id":56868,"avatar_url":"https://gravatar.com/avatar/34705ed266661f7b1eb991235572850a?d=https%3a%2f%2fidenticons.github.com%2f6f9c3bf293c914cc0443b2419fd346ae.png&r=x","gravatar_id":"34705ed266661f7b1eb991235572850a","url":"https://api.github.com/users/unhammer","html_url":"https://github.com/unhammer","followers_url":"https://api.github.com/users/unhammer/followers","following_url":"https://api.github.com/users/unhammer/following{/other_user}","gists_url":"https://api.github.com/users/unhammer/gists{/gist_id}","starred_url":"https://api.github.com/users/unhammer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/unhammer/subscriptions","organizations_url":"https://api.github.com/users/unhammer/orgs","repos_url":"https://api.github.com/users/unhammer/repos","events_url":"https://api.github.com/users/unhammer/events{/privacy}","received_events_url":"https://api.github.com/users/unhammer/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3afiles","name":"app:files","color":"02d7e1"}],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-04-29t12:35:18z","updated_at":"2013-08-08t14:59:07z","closed_at":"2013-08-08t14:59:07z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\ndeleting and recreating a user should leave it as if user was newly created.\r\n\r\n### actual behaviour\r\nold folders and symlink show up, even songs from that symlink still play.\r\n\r\n### steps to reproduce\r\n1. create a user\r\n2. upload some files into regular oc folders\r\n3. make a symlink $datadir/user/files/music â†’ /home/me/music\r\n4. rm $datadir/user/files/music\r\n5. delete user\r\n6. create user again\r\n7. notice old folders and symlink still showing (but interface not reacting to clicks there)\r\n\r\n### server configuration\r\noperating system: arch linux\r\n\r\nweb server: apache 2.2.24-1\r\n\r\ndatabase: sqlite\r\n\r\nphp version: 5.4.14-1\r\n\r\nowncloud version: 5.0.5-1\r\n\r\n### client configuration\r\nbrowser: firefox 20.0.1-2\r\n\r\noperating system: arch linux\r\n\r\n### logs\r\n#### web server error log\r\n```\r\n[empty]\r\n```\r\n\r\n#### owncloud log (data/owncloud.log)\r\n```\r\n{\"app\":\"php\",\"message\":\"curl_setopt(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/util.php#754\",\"level\":2,\"time\":1367237196}\r\n{\"app\":\"php\",\"message\":\"curl_setopt(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/util.php#754\",\"level\":2,\"time\":1367237196}\r\n{\"app\":\"php\",\"message\":\"curl_setopt_array(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/3rdparty\\/sabre\\/dav\\/client.php#462\",\"level\":2,\"time\":1367237213}\r\n{\"app\":\"php\",\"message\":\"opendir(\\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/cache\\/): failed to open dir: no such file or directory at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#40\",\"level\":2,\"time\":1367237240}\r\n{\"app\":\"php\",\"message\":\"readdir() expects parameter 1 to be resource, boolean given at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/cache\\/file.php#88\",\"level\":2,\"time\":1367237240}\r\n{\"app\":\"php\",\"message\":\"curl_setopt_array(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/3rdparty\\/sabre\\/dav\\/client.php#462\",\"level\":2,\"time\":1367237321}\r\n{\"app\":\"php\",\"message\":\"curl_setopt(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/util.php#754\",\"level\":2,\"time\":1367237347}\r\n{\"app\":\"php\",\"message\":\"curl_setopt(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/util.php#754\",\"level\":2,\"time\":1367237347}\r\n{\"app\":\"php\",\"message\":\"curl_setopt(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/util.php#754\",\"level\":2,\"time\":1367237348}\r\n{\"app\":\"php\",\"message\":\"curl_setopt(): curlopt_followlocation cannot be activated when an open_basedir is set at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/util.php#754\",\"level\":2,\"time\":1367237348}\r\n{\"app\":\"search_lucene\",\"message\":\"failed to extract meta information for \\/rot\\/files\\/: could not open \\\"\\/usr\\/share\\/webapps\\/owncloud\\/data\\/rot\\/files\\/\\\" (does not exist, or is not a file)\",\"level\":2,\"time\":1367237493}\r\n{\"app\":\"search_lucene\",\"message\":\"failed to extract meta information for \\/rot\\/files\\/: could not open \\\"\\/usr\\/share\\/webapps\\/owncloud\\/data\\/rot\\/files\\/\\\" (does not exist, or is not a file)\",\"level\":2,\"time\":1367237494}\r\n{\"app\":\"search_lucene\",\"message\":\"failed to extract meta information for \\/rot\\/files\\/: could not open \\\"\\/usr\\/share\\/webapps\\/owncloud\\/data\\/rot\\/files\\/\\\" (does not exist, or is not a file)\",\"level\":2,\"time\":1367237494}\r\n{\"app\":\"php\",\"message\":\"fopen(\\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/musikk): failed to open stream: no such file or directory at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#146\",\"level\":2,\"time\":1367238123}\r\n{\"app\":\"php\",\"message\":\"filesize(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/les at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#74\",\"level\":2,\"time\":1367238221}\r\n{\"app\":\"php\",\"message\":\"filesize(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/les at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#74\",\"level\":2,\"time\":1367238221}\r\n{\"app\":\"php\",\"message\":\"copy(\\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/les): failed to open stream: no such file or directory at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#143\",\"level\":2,\"time\":1367238221}\r\n{\"app\":\"php\",\"message\":\"filemtime(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/les at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#92\",\"level\":2,\"time\":1367238221}\r\n{\"app\":\"php\",\"message\":\"filemtime(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/les at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#92\",\"level\":2,\"time\":1367238225}\r\n{\"app\":\"php\",\"message\":\"filesize(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/m at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#74\",\"level\":2,\"time\":1367238226}\r\n{\"app\":\"php\",\"message\":\"filesize(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/m at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#74\",\"level\":2,\"time\":1367238226}\r\n{\"app\":\"php\",\"message\":\"copy(\\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/m): failed to open stream: no such file or directory at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#143\",\"level\":2,\"time\":1367238226}\r\n{\"app\":\"php\",\"message\":\"filemtime(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/m at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#92\",\"level\":2,\"time\":1367238226}\r\n{\"app\":\"php\",\"message\":\"filemtime(): stat failed for \\/usr\\/share\\/webapps\\/owncloud\\/data\\/username\\/files\\/m at \\/usr\\/share\\/webapps\\/owncloud\\/lib\\/files\\/storage\\/local.php#92\",\"level\":2,\"time\":1367238227}\r\n```\r\n","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}