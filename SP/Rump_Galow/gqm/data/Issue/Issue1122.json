{"url":"https://api.github.com/repos/owncloud/core/issues/1122","labels_url":"https://api.github.com/repos/owncloud/core/issues/1122/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1122/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1122/events","html_url":"https://github.com/owncloud/core/issues/1122","id":9769789,"number":1122,"title":"issue in public share of zip files","user":{"login":"marcolinuz","id":3216500,"avatar_url":"https://gravatar.com/avatar/7108b98ddd2067063d11e3c08e674383?d=https%3a%2f%2fidenticons.github.com%2f5c6bcbc7be0dc2077244c916dfe8e3d4.png&r=x","gravatar_id":"7108b98ddd2067063d11e3c08e674383","url":"https://api.github.com/users/marcolinuz","html_url":"https://github.com/marcolinuz","followers_url":"https://api.github.com/users/marcolinuz/followers","following_url":"https://api.github.com/users/marcolinuz/following{/other_user}","gists_url":"https://api.github.com/users/marcolinuz/gists{/gist_id}","starred_url":"https://api.github.com/users/marcolinuz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcolinuz/subscriptions","organizations_url":"https://api.github.com/users/marcolinuz/orgs","repos_url":"https://api.github.com/users/marcolinuz/repos","events_url":"https://api.github.com/users/marcolinuz/events{/privacy}","received_events_url":"https://api.github.com/users/marcolinuz/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":1,"created_at":"2013-01-08t14:35:48z","updated_at":"2013-01-08t15:57:09z","closed_at":"2013-01-08t15:57:09z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"release: owncloud 4.5.5\r\n\r\nissue: opening a public link that points to a zip file causes the download page to refresh automatically and redirect the used to the login page.. making the download impossible unless the user manually disables javascript.\r\n\r\ncause: it seems that by accessing a zip file from the public sharing page, the system tries to make a preview of its content. unfortunately, since it's needed the authentication in order to see the \"files\" app (that is the app that opens and surfs zip files), the unauthenticated user (namely the normal public user) is redirected to the login page and can't download the file.\r\n\r\ntemporary solution: \r\nmodified the file \"apps/files_sharing/js/public.js\" using this patch:\r\n<pre>\r\n--- public_ori.js\t2013-01-08 16:22:56.000000000 +0100\r\n+++ public.js\t2013-01-08 16:37:31.000000000 +0100\r\n@@ -23,7 +23,8 @@\r\n\t\t\t\t\t$('table').remove();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n-\t\t\t\taction($('#filename').val());\r\n+\t\t\t\tif (mimetype.substr(mimetype.indexof('/')+1) != 'zip')\r\n+\t\t\t\t\taction($('#filename').val());\r\n \t\t\t}\r\n \t\t}\r\n\t\tfileactions.register('dir', 'open', oc.permission_read, '', function(filename) {\r\n</pre>\r\n\r\nhow to reproduce the issue:\r\n1- log into owncloud and upload a non-empty zip file.\r\n2- share the file with a public link\r\n3- copy the link on the clipboard\r\n4- log out from owncloud\r\n5- paste the link on the browser and try to access it in order to download the zip file\r\n\r\nnote: i have the \"allow sharing zip files\" function enabled.\r\n\r\nthanks for reading.","closed_by":{"login":"lukasreschke","id":878997,"avatar_url":"https://gravatar.com/avatar/f080e75d370a4d8e550983a4898bcf3b?d=https%3a%2f%2fidenticons.github.com%2ff12e47d5bb5359a9f58e8217413be790.png&r=x","gravatar_id":"f080e75d370a4d8e550983a4898bcf3b","url":"https://api.github.com/users/lukasreschke","html_url":"https://github.com/lukasreschke","followers_url":"https://api.github.com/users/lukasreschke/followers","following_url":"https://api.github.com/users/lukasreschke/following{/other_user}","gists_url":"https://api.github.com/users/lukasreschke/gists{/gist_id}","starred_url":"https://api.github.com/users/lukasreschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukasreschke/subscriptions","organizations_url":"https://api.github.com/users/lukasreschke/orgs","repos_url":"https://api.github.com/users/lukasreschke/repos","events_url":"https://api.github.com/users/lukasreschke/events{/privacy}","received_events_url":"https://api.github.com/users/lukasreschke/received_events","type":"user","site_admin":false}}