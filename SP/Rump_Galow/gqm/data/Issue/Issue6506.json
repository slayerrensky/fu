{"url":"https://api.github.com/repos/owncloud/core/issues/6506","labels_url":"https://api.github.com/repos/owncloud/core/issues/6506/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/6506/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/6506/events","html_url":"https://github.com/owncloud/core/issues/6506","id":24541786,"number":6506,"title":"big davs file transfer crashes owncloud 6","user":{"login":"stefan-kamps","id":6220876,"avatar_url":"https://gravatar.com/avatar/543696e2fb1c7410388da3092c266467?d=https%3a%2f%2fidenticons.github.com%2fe4f8c959eeb1eb42711a593981c789ec.png&r=x","gravatar_id":"543696e2fb1c7410388da3092c266467","url":"https://api.github.com/users/stefan-kamps","html_url":"https://github.com/stefan-kamps","followers_url":"https://api.github.com/users/stefan-kamps/followers","following_url":"https://api.github.com/users/stefan-kamps/following{/other_user}","gists_url":"https://api.github.com/users/stefan-kamps/gists{/gist_id}","starred_url":"https://api.github.com/users/stefan-kamps/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefan-kamps/subscriptions","organizations_url":"https://api.github.com/users/stefan-kamps/orgs","repos_url":"https://api.github.com/users/stefan-kamps/repos","events_url":"https://api.github.com/users/stefan-kamps/events{/privacy}","received_events_url":"https://api.github.com/users/stefan-kamps/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":5,"created_at":"2013-12-19t07:58:41z","updated_at":"2013-12-20t13:10:27z","closed_at":"2013-12-20t12:59:13z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\na week ago i installed owncloud 6 on a hosting server (using a 50gb plan) and configured an admin and 2 users. i activated file encryption for all accounts.\r\nthen i wanted to upload a chunk of my photo collection to one of the user accounts via davs from my notebook (ubuntu 13.04). the chunk consisted of about 5.000 photos (approx. 20 gb) stored on an external usb-hdd. the filenames of the photos consist of a mix of latin and cyrillic characters.\r\n\r\n### actual behaviour\r\nafter uploading about 4 gb of the 20gb the file transfer stopped. when trying to login into any of the owncloud accounts i get the following error message:\r\n\r\nan exception occurred while executing 'update \"oc_appconfig\" set\r\n\"configvalue\" = ? where \"appid\" = ? and \"configkey\" = ?':\r\nsqlstate[hy000]: general error: 14 unable to open database file\r\n\r\ni.e. my owncloud is bricked.\r\n\r\n### steps to reproduce\r\nsince my owncloud is bricked, i cannot reproduce the error.\r\n\r\n### server configuration\r\noperating system:\r\n\r\nweb server: \r\n\r\ndatabase:\r\n\r\nphp version: 5.4\r\n\r\nowncloud version: 6.0.0 (stable)\r\n\r\nupdated from an older owncloud or fresh install:\r\nfresh install\r\nlist of activated app: encryption\r\n\r\nthe content of config/config.php: (without the database password and passwordsalt)\r\n\r\n<?php\r\n$config = array (\r\n  'instanceid' => 'oc3d14b18418',\r\n  'passwordsalt' => '-----',\r\n  'datadirectory' => '/homepages/1/d506616056/htdocs/wsb7562527301/owncloud/data',\r\n  'dbtype' => 'sqlite3',\r\n  'version' => '6.0.0.13',\r\n  'installed' => true,\r\n  'forcessl' => true,\r\n  'maxzipinputsize' => 838860800,\r\n  'allowzipdownload' => true,\r\n);\r\n\r\nare you using external storage, if yes which one: no\r\n\r\n### client configuration\r\nbrowser: firefox 25.0.1\r\n\r\noperating system:\r\nubuntu 13.04\r\n\r\n### logs\r\n#### web server error log\r\n```\r\ninsert your webserver log here\r\n```\r\n\r\n#### owncloud log (data/owncloud.log)\r\nthe following is the last part of the owncloud.log before the crash:\r\n\r\n...\r\n{\"app\":\"php\",\"message\":\"finfo::buffer(): failed identify data 12:cannot allocate 11977464 bytes (cannot allocate memory)image\\/jpeg at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":2,\"time\":\"2013-12-18t22:28:57+00:00\"}\r\n{\"app\":\"php\",\"message\":\"finfo::buffer(): failed identify data 12:cannot allocate 11250096 bytes (cannot allocate memory)image\\/jpeg at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":2,\"time\":\"2013-12-18t22:29:03+00:00\"}\r\n{\"app\":\"php\",\"message\":\"finfo::buffer(): failed identify data 12:cannot allocate 11276172 bytes (cannot allocate memory)image\\/jpeg at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":2,\"time\":\"2013-12-18t22:29:09+00:00\"}\r\n{\"app\":\"php\",\"message\":\"finfo::buffer(): failed identify data 12:cannot allocate 10741092 bytes (cannot allocate memory)image\\/jpeg at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":2,\"time\":\"2013-12-18t22:29:15+00:00\"}\r\n{\"app\":\"php\",\"message\":\"finfo::buffer(): failed identify data 12:cannot allocate 13335388 bytes (cannot allocate memory)image\\/jpeg at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":2,\"time\":\"2013-12-18t22:29:22+00:00\"}\r\n{\"app\":\"php\",\"message\":\"finfo::buffer(): failed identify data 12:cannot allocate 13907928 bytes (cannot allocate memory)image\\/jpeg at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":2,\"time\":\"2013-12-18t22:29:28+00:00\"}\r\n{\"app\":\"php\",\"message\":\"finfo::buffer(): failed identify data 12:cannot allocate 14240852 bytes (cannot allocate memory)image\\/jpeg at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":2,\"time\":\"2013-12-18t22:29:35+00:00\"}\r\n{\"app\":\"hook\",\"message\":\"error while running hook (oc\\\\preview::post_write): encryption library: decryption (symmetric) of content failed\",\"level\":3,\"time\":\"2013-12-18t22:29:41+00:00\"}\r\n{\"app\":\"php\",\"message\":\"out of memory (allocated 10485760) (tried to allocate 28385280 bytes) at \\/homepages\\/1\\/d506616056\\/htdocs\\/wsb7562527301\\/owncloud\\/lib\\/private\\/image.php#523\",\"level\":3,\"time\":\"2013-12-18t22:29:42+00:00\"}\r\n{\"app\":\"cron\",\"message\":\"an exception occurred while executing 'update \\\"oc_jobs\\\" set \\\"last_run\\\" = ? where \\\"id\\\" = ?':\\n\\nsqlstate[hy000]: general error: 14 unable to open database file\",\"level\":4,\"time\":\"2013-12-18t23:12:02+00:00\"}\r\n{\"app\":\"index\",\"message\":\"exception: an exception occurred while executing 'update \\\"oc_appconfig\\\" set \\\"configvalue\\\" = ? where \\\"appid\\\" = ? and \\\"configkey\\\" = ?':\\n\\nsqlstate[hy000]: general error: 14 unable to open database file\",\"level\":4,\"time\":\"2013-12-18t23:12:21+00:00\"}\r\n{\"app\":\"index\",\"message\":\"exception: an exception occurred while executing 'update \\\"oc_appconfig\\\" set \\\"configvalue\\\" = ? where \\\"appid\\\" = ? and \\\"configkey\\\" = ?':\\n\\nsqlstate\r\n\r\n#### browser log\r\n```\r\ninsert your browser log here, this could for example include:\r\n\r\na) the javascript console log\r\nb) the network log \r\nc) ...\r\n```","closed_by":{"login":"stefan-kamps","id":6220876,"avatar_url":"https://gravatar.com/avatar/543696e2fb1c7410388da3092c266467?d=https%3a%2f%2fidenticons.github.com%2fe4f8c959eeb1eb42711a593981c789ec.png&r=x","gravatar_id":"543696e2fb1c7410388da3092c266467","url":"https://api.github.com/users/stefan-kamps","html_url":"https://github.com/stefan-kamps","followers_url":"https://api.github.com/users/stefan-kamps/followers","following_url":"https://api.github.com/users/stefan-kamps/following{/other_user}","gists_url":"https://api.github.com/users/stefan-kamps/gists{/gist_id}","starred_url":"https://api.github.com/users/stefan-kamps/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stefan-kamps/subscriptions","organizations_url":"https://api.github.com/users/stefan-kamps/orgs","repos_url":"https://api.github.com/users/stefan-kamps/repos","events_url":"https://api.github.com/users/stefan-kamps/events{/privacy}","received_events_url":"https://api.github.com/users/stefan-kamps/received_events","type":"user","site_admin":false}}