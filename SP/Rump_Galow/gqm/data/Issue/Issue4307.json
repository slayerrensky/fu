{"url":"https://api.github.com/repos/owncloud/core/issues/4307","labels_url":"https://api.github.com/repos/owncloud/core/issues/4307/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4307/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4307/events","html_url":"https://github.com/owncloud/core/issues/4307","id":17598536,"number":4307,"title":"db constraint problem in lib/files/cache/cache.php","user":{"login":"acfbuerger","id":3958886,"avatar_url":"https://gravatar.com/avatar/887cfff61be1a30c114a2f6baa55a017?d=https%3a%2f%2fidenticons.github.com%2f4d8f249a0a92a3fb087b784693704954.png&r=x","gravatar_id":"887cfff61be1a30c114a2f6baa55a017","url":"https://api.github.com/users/acfbuerger","html_url":"https://github.com/acfbuerger","followers_url":"https://api.github.com/users/acfbuerger/followers","following_url":"https://api.github.com/users/acfbuerger/following{/other_user}","gists_url":"https://api.github.com/users/acfbuerger/gists{/gist_id}","starred_url":"https://api.github.com/users/acfbuerger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acfbuerger/subscriptions","organizations_url":"https://api.github.com/users/acfbuerger/orgs","repos_url":"https://api.github.com/users/acfbuerger/repos","events_url":"https://api.github.com/users/acfbuerger/events{/privacy}","received_events_url":"https://api.github.com/users/acfbuerger/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-08-03t18:53:13z","updated_at":"2013-10-18t09:47:56z","closed_at":"2013-10-18t09:47:56z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nuser can log in.\r\n\r\n### actual behaviour\r\nserver sends empty reply, postgresql complains about constraint violation.\r\n\r\n### steps to reproduce\r\ntry to login -- works (rather: fails) only for some user accounts. maybe a db upgrade problem?\r\n\r\nthe problem is in lib/files/cache/cache.php, the insert into filecache may lack a value for the column \"unencrypted_size\", which causes a db constraint violation error as this column must not be null. i fixed this temporarily by inserting:\r\n\r\n                        $data['unencrypted_size'] = isset($data['encrypted']) ? ((int)$data['unencrypted_size']) : ((int)$data['size']);\r\n\r\naround line 204.\r\n\r\n### server configuration\r\noperating system:\r\nubuntu 12.04\r\n\r\nweb server: \r\napache2\r\n\r\ndatabase:\r\npostgresql\r\n\r\nphp version:\r\nfrom ubuntu\r\n\r\nowncloud version:\r\n5.0.9 from tar archive","closed_by":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false}}