{"url":"https://api.github.com/repos/owncloud/core/issues/2600","labels_url":"https://api.github.com/repos/owncloud/core/issues/2600/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2600/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2600/events","html_url":"https://github.com/owncloud/core/issues/2600","id":12520251,"number":2600,"title":"custom ldap port ignored when using ldaps://","user":{"login":"k4k","id":524645,"avatar_url":"https://gravatar.com/avatar/d2370393332e368172e3c4010c60583e?d=https%3a%2f%2fidenticons.github.com%2f43224029fd81008db71a32b3d37e8c30.png&r=x","gravatar_id":"d2370393332e368172e3c4010c60583e","url":"https://api.github.com/users/k4k","html_url":"https://github.com/k4k","followers_url":"https://api.github.com/users/k4k/followers","following_url":"https://api.github.com/users/k4k/following{/other_user}","gists_url":"https://api.github.com/users/k4k/gists{/gist_id}","starred_url":"https://api.github.com/users/k4k/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4k/subscriptions","organizations_url":"https://api.github.com/users/k4k/orgs","repos_url":"https://api.github.com/users/k4k/repos","events_url":"https://api.github.com/users/k4k/events{/privacy}","received_events_url":"https://api.github.com/users/k4k/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3auser_ldap","name":"app:user_ldap","color":"02d7e1"},{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"milestone":null,"comments":8,"created_at":"2013-03-27t16:28:14z","updated_at":"2013-07-26t07:04:05z","closed_at":"2013-06-03t22:45:17z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nldap requests should use the custom port specified in the advanced configuration for regardless of whether the ldap url has ldaps:// in front or not\r\n\r\n### actual behaviour\r\nrequests are being sent over port 636 even though i have specified 3269 in the advanced configuration\r\n\r\n### steps to reproduce\r\n1. specify ldap url similar to ldaps://example.org\r\n2. under advanced, specify a port other than 636\r\n3. in a console on the server, run ```tcpdump port 636```\r\n4. click \"test configuration\" on the ldap configuration page\r\n\r\n### server configuration\r\noperating system: redhat enterprise linux 6.3\r\n\r\nweb server: httpd-2.2.15-26.el6.x86_64\r\n\r\ndatabase: mysql-server-5.1.67-1.el6_3.x86_64\r\n\r\nphp version: php-5.3.3-22.el6.x86_64\r\n\r\nowncloud version: 5.0.0\r\n\r\n### client configuration\r\nbrowser: firefox 19, chrome 23\r\n\r\noperating system: fedora 17, windows 7\r\n\r\n### logs\r\n#### web server error log\r\n```\r\n[root@files data]# tcpdump port 636 -vvv\r\ntcpdump: listening on eth0, link-type en10mb (ethernet), capture size 65535 bytes\r\n\r\n12:13:20.939175 ip (tos 0x0, ttl 64, id 60848, offset 0, flags [df], proto tcp (6), length 52)\r\n    files.xxxxx.xxxx.org.45791 > xxxxx.xxx.xxxxx.org.ldaps: flags [s], cksum 0x73c3 (correct), seq 2175618000, win 14600, options [mss 1460,nop,nop,sackok,nop,wscale 7], length 0\r\n12:13:20.939603 ip (tos 0x0, ttl 126, id 7621, offset 0, flags [df], proto tcp (6), length 52)\r\n    xxxxxxxx.xxx.xxxx.org.ldaps > files.xxxxx.xxxx.org.45791: flags [s.], cksum 0x39de (correct), seq 2844764491, ack 2175618001, win 8192, options [mss 1460,nop,wscale 8,nop,nop,sackok], length 0\r\n12:13:20.939633 ip (tos 0x0, ttl 64, id 60849, offset 0, flags [df], proto tcp (6), length 40)\r\n    files.xxxxx.xxxx.org.45791 > xxxxxxxx.xxx.xxxx.org.ldaps: flags [.], cksum 0x9a3e (correct), seq 1, ack 1, win 115, length 0\r\n```\r\n\r\n#### owncloud ldap configuration\r\n![screenshot from 2013-03-27 12:24:49](https://f.cloud.github.com/assets/524645/309207/417e1456-96fb-11e2-9734-98908943fd8a.png)\r\n![screenshot from 2013-03-27 12:24:57](https://f.cloud.github.com/assets/524645/309208/441bf37c-96fb-11e2-980f-c46dad32a922.png)\r\n","closed_by":{"login":"k4k","id":524645,"avatar_url":"https://gravatar.com/avatar/d2370393332e368172e3c4010c60583e?d=https%3a%2f%2fidenticons.github.com%2f43224029fd81008db71a32b3d37e8c30.png&r=x","gravatar_id":"d2370393332e368172e3c4010c60583e","url":"https://api.github.com/users/k4k","html_url":"https://github.com/k4k","followers_url":"https://api.github.com/users/k4k/followers","following_url":"https://api.github.com/users/k4k/following{/other_user}","gists_url":"https://api.github.com/users/k4k/gists{/gist_id}","starred_url":"https://api.github.com/users/k4k/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k4k/subscriptions","organizations_url":"https://api.github.com/users/k4k/orgs","repos_url":"https://api.github.com/users/k4k/repos","events_url":"https://api.github.com/users/k4k/events{/privacy}","received_events_url":"https://api.github.com/users/k4k/received_events","type":"user","site_admin":false}}