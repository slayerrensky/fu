{"url":"https://api.github.com/repos/owncloud/core/issues/3605","labels_url":"https://api.github.com/repos/owncloud/core/issues/3605/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3605/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3605/events","html_url":"https://github.com/owncloud/core/issues/3605","id":15192075,"number":3605,"title":"failure on persistance of quotas in the db","user":{"login":"gilga-mesh","id":4624256,"avatar_url":"https://gravatar.com/avatar/b3226c77c8ac0b0dcc3b217bf2007cdb?d=https%3a%2f%2fidenticons.github.com%2f94fb30c6313e9c4a71868e032b277a3c.png&r=x","gravatar_id":"b3226c77c8ac0b0dcc3b217bf2007cdb","url":"https://api.github.com/users/gilga-mesh","html_url":"https://github.com/gilga-mesh","followers_url":"https://api.github.com/users/gilga-mesh/followers","following_url":"https://api.github.com/users/gilga-mesh/following{/other_user}","gists_url":"https://api.github.com/users/gilga-mesh/gists{/gist_id}","starred_url":"https://api.github.com/users/gilga-mesh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gilga-mesh/subscriptions","organizations_url":"https://api.github.com/users/gilga-mesh/orgs","repos_url":"https://api.github.com/users/gilga-mesh/repos","events_url":"https://api.github.com/users/gilga-mesh/events{/privacy}","received_events_url":"https://api.github.com/users/gilga-mesh/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":1,"created_at":"2013-06-05t20:31:06z","updated_at":"2013-08-16t22:08:21z","closed_at":"2013-08-16t22:08:21z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nwhen changing the individual quota for a user, either from the web interface as well updating the oc_preferences table, the new value should apply.\r\n\r\n### actual behaviour\r\nchanging the quota from the web interface: the new quota is temporary written into the db, but in a matter of minutes the previous value is restored. the same applies also after a direct \"update\" sql statement issued from the mysql console. \r\n\r\n### steps to reproduce\r\nfrom the web i/f: as usual.\r\nfrom the mysql console:\r\n\r\n1. login to the owncloud db using mysql\r\n\r\n2. check the db:\r\nselect * from oc_preferences where userid='xxxx';\r\n+--------+-------+-----------+-------------+\r\n| userid | appid | configkey | configvalue |\r\n+--------+-------+-----------+-------------+\r\n| xxxx | files | quota     | 104857600   |\r\n+--------+-------+-----------+-------------+\r\n\r\n3. issue an update: \r\nupdate oc_preferences set configvalue='1gb' where configkey='quota' and userid='xxxx';\r\n\r\n4. check the result:\r\nselect * from oc_preferences where userid='xxxx' and configkey='quota';\r\n+--------+-------+-----------+-------------+\r\n| userid | appid | configkey | configvalue |\r\n+--------+-------+-----------+-------------+\r\n| xxxx | files | quota     | 1gb   |\r\n+--------+-------+-----------+-------------+\r\n\r\n5. wait 5 minutes (or less) without leaving the mysql session.\r\n\r\n6. check again the db:\r\nselect * from oc_preferences where userid='xxxx';\r\n+--------+-------+-----------+-------------+\r\n| userid | appid | configkey | configvalue |\r\n+--------+-------+-----------+-------------+\r\n| xxxx | files | quota     | 104857600   |\r\n+--------+-------+-----------+-------------+\r\n\r\n### server configuration\r\noperating system: ubuntu server 12.04 lts\r\n\r\nweb server: apache2\r\n\r\ndatabase: mysql  ver 14.14 distrib 5.5.31, for debian-linux-gnu (x86_64) using readline 6.2\r\n\r\nphp version: 5.3.10\r\n\r\nowncloud version: 5.0.6\r\n\r\n### client configuration\r\nbrowser: n/a\r\n\r\noperating system: n/a\r\n\r\n### logs:\r\n#### web server error log: n/a\r\n\r\n#### owncloud log (data/owncloud.log) (i'm working into mysql, but anyway):\r\n.....\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: 49: invalid credentials\",\"level\":3,\"time\":1370463781}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: 49: invalid credentials\",\"level\":3,\"time\":1370463797}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: 49: invalid credentials\",\"level\":3,\"time\":1370463809}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: 49: invalid credentials\",\"level\":3,\"time\":1370463825}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: 49: invalid credentials\",\"level\":3,\"time\":1370463838}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: 49: invalid credentials\",\"level\":3,\"time\":1370463854}\r\n{\"app\":\"user_ldap\",\"message\":\"bind failed: 49: invalid credentials\",\"level\":3,\"time\":1370463866}\r\n\r\n","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}