{"url":"https://api.github.com/repos/owncloud/core/issues/2365","labels_url":"https://api.github.com/repos/owncloud/core/issues/2365/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2365/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2365/events","html_url":"https://github.com/owncloud/core/issues/2365","id":12079059,"number":2365,"title":"upgrading from 4.5.8 to 5.0 problems","user":{"login":"khartahk","id":2655332,"avatar_url":"https://gravatar.com/avatar/b6805507edf950c62a82caa2194cda53?d=https%3a%2f%2fidenticons.github.com%2f7e3f0d9d21a6802e1674e33645e2419b.png&r=x","gravatar_id":"b6805507edf950c62a82caa2194cda53","url":"https://api.github.com/users/khartahk","html_url":"https://github.com/khartahk","followers_url":"https://api.github.com/users/khartahk/followers","following_url":"https://api.github.com/users/khartahk/following{/other_user}","gists_url":"https://api.github.com/users/khartahk/gists{/gist_id}","starred_url":"https://api.github.com/users/khartahk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khartahk/subscriptions","organizations_url":"https://api.github.com/users/khartahk/orgs","repos_url":"https://api.github.com/users/khartahk/repos","events_url":"https://api.github.com/users/khartahk/events{/privacy}","received_events_url":"https://api.github.com/users/khartahk/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":12,"created_at":"2013-03-15t20:00:09z","updated_at":"2013-08-06t23:19:38z","closed_at":"2013-08-06t23:19:38z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nwhen upgrading from 4.5.8 to 5.0.0 the upgrade process should update the database and show all the files in the users folders, also the music library should be able to rescan the files and show new and old mp3 files \r\n\r\n### actual behaviour\r\nwhen the upgrade completes if it completes. the first time i got an error saying there is a problem and nothing else. the instant upload files were shown in the root folder, none of the music worked and only folders were shown of files. after i emptied the db file cache the files started to appear but not all of them. the pictures were shown but only a few folders, the music was not rescanned. i should point out the i have more than 40000 files most of which are pictures.\r\n\r\nthe second time the upgrade went through but the music was still not working and also the files were not all there\r\n\r\n### steps to reproduce\r\n1. have a working 4.5.8 with more than 40000 files\r\n2. delete al but config and data dir in oc install dir\r\n3. copy 5.0.0 files to the oc install dir\r\n4. go to oc domain and wait for the upgrade process to complete\r\n5. open pictures and check if all are there the folders and the files, try to play some music from previous install and try to do a rescan of the music library, also opening pictures in the picture gallery takes very long time\r\n\r\n### my observation\r\nif there is really that much oc has to do to scan all the files there should be a way to check the scanning process so that the user knows something is happening and aprox. how long is it going to take\r\n\r\n### server configuration\r\ncore 2 duo at 2ghz\r\n2gb ram\r\nubuntu 12.04\r\napache 2.2.22\r\nmysql 5.5.29\r\nphp 5.3.10\r\nowncloud version: 4.5.8 -> 5.0.0\r\n\r\n### client configuration\r\nmozilla firefox 19\r\nubuntu 12.04\r\n\r\n### logs\r\n#### web server error log & owncloud log (data/owncloud.log)\r\nhttps://oblak.cankar.eu/public.php?service=files&t=bae8e1f2e22bee15c35d7d0ed36e79d3\r\n\r\n### browser console error\r\nerror that says something like this in english in javascript console:connection to https://cloud.my.domain/index.php/apps/files/ajax/scan.php?force=false&dir=&requesttoken=cfbb421ef6fd798891be was denied.","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}