{"url":"https://api.github.com/repos/owncloud/core/issues/6493","labels_url":"https://api.github.com/repos/owncloud/core/issues/6493/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/6493/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/6493/events","html_url":"https://github.com/owncloud/core/issues/6493","id":24494518,"number":6493,"title":"migrate script to update home storage ids","user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/enhancement","name":"enhancement","color":"02e10c"}],"state":"open","assignee":null,"milestone":null,"comments":3,"created_at":"2013-12-18t14:57:32z","updated_at":"2013-12-20t11:36:21z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"write a \"migration\" or \"fix db\" script that admins can run from the command line.\r\n\r\nwhen users migrated from very old owncloud versions to oc 6, they might find themselves with a mix of different storage id formats like here: https://github.com/owncloud/core/issues/6463#issuecomment-30845563 which can cause unpredictable bugs (like #6463)\r\n\r\nthe purpose of the script is to convert all home storages to use the \"home::$username\" format.\r\n\r\nbut there might be some situations where admins might have tinkered with the storage ids to move user's mount points to different places, for example: \"local:://home/user1\" for user1 \"local::/someotherdir/user2\" where the subdir is not a subdir of the data folder. (which might be a reason why @deepdiver1975 was against having this in the automatic migration back then when we introduced the home storages)\r\n\r\nthe script must perform a test to check whether all home storages can be converted. if one or more cannot, the script will abort and show a warning.\r\n\r\nif all can be migrated, the migration will be done.\r\n\r\n@karlitschek @icewind1991 @deepdiver1975 @schiesbn ","closed_by":null}