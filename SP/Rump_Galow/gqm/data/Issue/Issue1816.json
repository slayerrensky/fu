{"url":"https://api.github.com/repos/owncloud/core/issues/1816","labels_url":"https://api.github.com/repos/owncloud/core/issues/1816/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1816/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1816/events","html_url":"https://github.com/owncloud/core/issues/1816","id":11224279,"number":1816,"title":"only one-way syncing (server -> client) with encryption enabled.","user":{"login":"jd073","id":3620023,"avatar_url":"https://gravatar.com/avatar/258bb9cf86a02ce7ad963c52e4e2f455?d=https%3a%2f%2fidenticons.github.com%2fb64dd47a4633a7709e2787386b85b2c5.png&r=x","gravatar_id":"258bb9cf86a02ce7ad963c52e4e2f455","url":"https://api.github.com/users/jd073","html_url":"https://github.com/jd073","followers_url":"https://api.github.com/users/jd073/followers","following_url":"https://api.github.com/users/jd073/following{/other_user}","gists_url":"https://api.github.com/users/jd073/gists{/gist_id}","starred_url":"https://api.github.com/users/jd073/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jd073/subscriptions","organizations_url":"https://api.github.com/users/jd073/orgs","repos_url":"https://api.github.com/users/jd073/repos","events_url":"https://api.github.com/users/jd073/events{/privacy}","received_events_url":"https://api.github.com/users/jd073/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":12,"created_at":"2013-02-21t01:40:20z","updated_at":"2013-09-06t14:11:39z","closed_at":"2013-09-06t14:11:39z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"###expected behaviour:\r\nfiles placed in a locally synced directory should be synced to the server.\r\nfiles deleted in a locally synced directory should be deleted on the server.\r\n\r\n###actual behaviour:\r\nonly when encryption is enabled:\r\nfiles placed into locally synced directories do not sync to the server.  files uploaded via the web interface get synced down to the local directory as expected.\r\n\r\nfile deletions in the local directory do not replicate to the server: the deleted file is synced back to the client, rather than deleted on the server.\r\n\r\n###steps to reproduce:\r\n1. disable all apps except encryption.\r\n2. place a new file in a locally synced directory\r\n3. wait for replication.\r\n4. observe that the file is not synced to the server\r\n\r\nand \r\n\r\n1. disable all apps except encryption.\r\n2. upload a new file via the web interface.\r\n3. wait for replication.\r\n4. the file is replicated down to the client\r\n5. delete the local file\r\n6. wait for replication\r\n7. observe that the file is replicated down from the server again and not deleted on the server as would be expected.\r\n\r\nrepeat the above steps with encryption disabled.  the files are created and deleted as expected.\r\n\r\n###server configuration\r\noperating system: ubuntu 12.1\r\nweb server: apache 2.2.22\r\ndatabase: sqlite\r\nphp version: 5.4.6-1\r\nowncloud version: 5.0 beta\r\n\r\ntested with a 100% clean install.\r\n\r\n###client configuration\r\nbrowser: firefox 19.0\r\noperating system: windows 7\r\n\r\n###logs\r\n####web server error log\r\nempty\r\n\r\n#### owncloud log\r\none entry:\r\n{\"app\":\"encryption library\",\"message\":\"could not delete keyfile; does not exist: \\\"\\/username\\/files_encryption\\/keyfiles\\/octesting\\/test2.txt.key\",\"level\":3,\"time\":1361409130}\r\n\r\nnote: the following two files exist in owncloud/data/username/files_encryption/keyfiles/\r\n   \"octesting test.txt.part.key\"\r\n   \"octesting test2.txt.key\"\r\nit appears as though the folder name is being prepended to the key file names, rather than the \"octesting\" folder being created and the files placed in it.  that said, i manually created owncloud/data/username/files_encryption/keyfiles/octesting/ and moved the two .key files into it (and also set the ownership of the folder and files to www-data).  this did not resolve the problem.\r\n \r\n\r\n","closed_by":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false}}