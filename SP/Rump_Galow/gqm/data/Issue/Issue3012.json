{"url":"https://api.github.com/repos/owncloud/core/issues/3012","labels_url":"https://api.github.com/repos/owncloud/core/issues/3012/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3012/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3012/events","html_url":"https://github.com/owncloud/core/issues/3012","id":13375914,"number":3012,"title":"fedora rpm has incorrect selinux file contexts","user":{"login":"sshambar","id":640696,"avatar_url":"https://gravatar.com/avatar/fcbcb48341b2936fdd244f8dc6c78c38?d=https%3a%2f%2fidenticons.github.com%2fd6d4ef7d212d1895ccf6d7ff8e63710e.png&r=x","gravatar_id":"fcbcb48341b2936fdd244f8dc6c78c38","url":"https://api.github.com/users/sshambar","html_url":"https://github.com/sshambar","followers_url":"https://api.github.com/users/sshambar/followers","following_url":"https://api.github.com/users/sshambar/following{/other_user}","gists_url":"https://api.github.com/users/sshambar/gists{/gist_id}","starred_url":"https://api.github.com/users/sshambar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshambar/subscriptions","organizations_url":"https://api.github.com/users/sshambar/orgs","repos_url":"https://api.github.com/users/sshambar/repos","events_url":"https://api.github.com/users/sshambar/events{/privacy}","received_events_url":"https://api.github.com/users/sshambar/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/enhancement","name":"enhancement","color":"02e10c"},{"url":"https://api.github.com/repos/owncloud/core/labels/packaging","name":"packaging","color":"593493"}],"state":"open","assignee":{"login":"dragotin","id":1070214,"avatar_url":"https://gravatar.com/avatar/af829234b31fb915704c1c65ef48eee0?d=https%3a%2f%2fidenticons.github.com%2f3392afab7f424e10623ba95a941f4d34.png&r=x","gravatar_id":"af829234b31fb915704c1c65ef48eee0","url":"https://api.github.com/users/dragotin","html_url":"https://github.com/dragotin","followers_url":"https://api.github.com/users/dragotin/followers","following_url":"https://api.github.com/users/dragotin/following{/other_user}","gists_url":"https://api.github.com/users/dragotin/gists{/gist_id}","starred_url":"https://api.github.com/users/dragotin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragotin/subscriptions","organizations_url":"https://api.github.com/users/dragotin/orgs","repos_url":"https://api.github.com/users/dragotin/repos","events_url":"https://api.github.com/users/dragotin/events{/privacy}","received_events_url":"https://api.github.com/users/dragotin/received_events","type":"user","site_admin":false},"milestone":null,"comments":3,"created_at":"2013-04-18t22:08:35z","updated_at":"2013-08-07t19:58:52z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"i'm seeing selinux errors when owncloud attempts to update the config.php files, and tracked it down to an incorrect owncloud.spec file in the fedora 18 package on the opensuse.org packages (and possibly others like centos and rhel, didn't check).\r\n\r\nthe problem is the read/write file contexts are created for the data/config/apps directory, but aren't recursive.  there's also a typo in the uninstall part that causes the postun to not remove a file context.\r\n\r\ni've created a patch to fix the spec file:\r\n```\r\n--- owncloud.spec-orig  2013-04-11 03:47:25.000000000 -0700\r\n+++ owncloud.spec       2013-04-18 15:06:18.562150258 -0700\r\n@@ -132,11 +132,11 @@\r\n %if 0%{?fedora_version} || 0%{?rhel_version} || 0%{?centos_version}\r\n if [ -x /usr/sbin/sestatus ] ; then \\\r\n   sestatus | grep '^current.*enforcing' > /dev/null && { \r\n-    semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/html/owncloud/data'\r\n+    semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/html/owncloud/data(/.*)?'\r\n     restorecon '/var/www/html/owncloud/data'\r\n-    semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/html/owncloud/config'\r\n+    semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/html/owncloud/config(/.*)?'\r\n     restorecon '/var/www/html/owncloud/config'\r\n-    semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/html/owncloud/apps'\r\n+    semanage fcontext -a -t httpd_sys_rw_content_t '/var/www/html/owncloud/apps(/.*)?'\r\n     restorecon '/var/www/html/owncloud/apps'\r\n   }\r\n fi\r\n@@ -149,16 +149,16 @@\r\n %if 0%{?fedora_version} || 0%{?rhel_version} || 0%{?centos_version}\r\n if [ -x /usr/sbin/sestatus ] ; then \\\r\n   sestatus | grep '^current.*enforcing' > /dev/null && {\r\n-    semanage fcontext -l | grep '/var/www/owncloud/data' && {\r\n-      semanage fcontext -d -t httpd_sys_rw_content_t '/var/www/html/owncloud/data'\r\n+    semanage fcontext -l | grep '/var/www/html/owncloud/data(/.*)?' && {\r\n+      semanage fcontext -d -t httpd_sys_rw_content_t '/var/www/html/owncloud/data(/.*)?'\r\n       restorecon '/var/www/html/owncloud/data'\r\n     }\r\n-    semanage fcontext -l | grep '/var/www/html/owncloud/config' && {\r\n-      semanage fcontext -d -t httpd_sys_rw_content_t '/var/www/html/owncloud/config'\r\n+    semanage fcontext -l | grep '/var/www/html/owncloud/config(/.*)?' && {\r\n+      semanage fcontext -d -t httpd_sys_rw_content_t '/var/www/html/owncloud/config(/.*)?'\r\n       restorecon '/var/www/html/owncloud/config'\r\n     }\r\n-    semanage fcontext -l | grep '/var/www/html/owncloud/apps' && {\r\n-      semanage fcontext -d -t httpd_sys_rw_content_t '/var/www/html/owncloud/apps'\r\n+    semanage fcontext -l | grep '/var/www/html/owncloud/apps(/.*)?' && {\r\n+      semanage fcontext -d -t httpd_sys_rw_content_t '/var/www/html/owncloud/apps(/.*)?'\r\n       restorecon '/var/www/html/owncloud/apps'\r\n     }\r\n   }\r\n```","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}