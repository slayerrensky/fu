{"url":"https://api.github.com/repos/owncloud/core/issues/1783","labels_url":"https://api.github.com/repos/owncloud/core/issues/1783/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1783/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1783/events","html_url":"https://github.com/owncloud/core/issues/1783","id":11161431,"number":1783,"title":"(file / folder) names starting with an accentued char","user":{"login":"quenenni","id":3638408,"avatar_url":"https://gravatar.com/avatar/e278a97542e00fd353b3f919126c7940?d=https%3a%2f%2fidenticons.github.com%2f4c3ef69b9e7593618013e9b5a70c2fb9.png&r=x","gravatar_id":"e278a97542e00fd353b3f919126c7940","url":"https://api.github.com/users/quenenni","html_url":"https://github.com/quenenni","followers_url":"https://api.github.com/users/quenenni/followers","following_url":"https://api.github.com/users/quenenni/following{/other_user}","gists_url":"https://api.github.com/users/quenenni/gists{/gist_id}","starred_url":"https://api.github.com/users/quenenni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/quenenni/subscriptions","organizations_url":"https://api.github.com/users/quenenni/orgs","repos_url":"https://api.github.com/users/quenenni/repos","events_url":"https://api.github.com/users/quenenni/events{/privacy}","received_events_url":"https://api.github.com/users/quenenni/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":5,"created_at":"2013-02-19t16:58:01z","updated_at":"2013-02-19t18:50:21z","closed_at":"2013-02-19t18:50:21z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\nwe can have filenames and foldernames starting with an accentued char (ã¢, ã‰, ..).\r\n\r\n### actual behaviour\r\nthe first char is cut (ã‰dition becomes ditions) -> impossible to access / rename / delete them.\r\nthe filename is good on the server and no problem when the accent is not the first char\r\n(rescanning the files doesn't resolve the issues)\r\n\r\nin the db, we can see in fscache table\r\n* before renaming:\r\n(`id`, `path`, `path_hash`, `parent`, `name`, `user`, `size`, `ctime`, `mtime`, `mimetype`, `mimepart`, `encrypted`, `versioned`, `writable`) \r\nvalues\r\n(13, '/admin/files/aa', 'c7219caba8fd4cc968838da48108832e', 1, 'aa', 'admin', 0, 1361292048, 1361292048, 'application/x-empty', 'application', 0, 0, 1);\r\n\r\n* after renaming:\r\n(`id`, `path`, `path_hash`, `parent`, `name`, `user`, `size`, `ctime`, `mtime`, `mimetype`, `mimepart`, `encrypted`, `versioned`, `writable`)\r\nvalues\r\n(13, '/admin/files/ã©aa', '3a3d7547902e55bb09fd47b9d2443b40', 1, 'aa', 'admin', 0, 1361292048, 1361292048, 'application/x-empty', 'application', 0, 0, 1);\r\n\r\n(the field 'path' seems good but the field 'name' didn't change)\r\n\r\n### steps to reproduce\r\n1. upload a file (or create a empty file), rename it an put an accentued char at the beginning. \r\nreload the files page, the first char is cut (ã‰dition -> ditions)\r\n2. using the \"rescan filsystem\" app when there are already lots of files / folders from before the upgrade make impossible to access all the files / folders that start with an accentued char.\r\nas for point 2, all the names don't have anymore the first char in their name\r\n\r\nbut the files / folders on the server are good.\r\n\r\n### server configuration\r\noperating system:  debian squeeze 6.0.6\r\n\r\nweb server: \r\nii  apache2                                       2.2.16-6+squeeze10 \r\nii  apache2-mpm-prefork                           2.2.16-6+squeeze10\r\nii  apache2-utils                                 2.2.16-6+squeeze10 \r\nii  apache2.2-bin                                 2.2.16-6+squeeze10  \r\nii  apache2.2-common                              2.2.16-6+squeeze10 \r\n\r\ndatabase:\r\nii  mysql-server                                  5.1.66-0+squeeze1\r\nii  mysql-server-5.1                              5.1.66-0+squeeze1\r\nii  mysql-server-core-5.1                         5.1.66-0+squeeze1\r\n\r\nphp version:\r\nii  php-pear                                      5.3.3-7+squeeze14 \r\nii  php-xml-parser                                1.3.2-4 \r\nii  php5                                          5.3.3-7+squeeze14 \r\nii  php5-cli                                      5.3.3-7+squeeze14 \r\nii  php5-common                                   5.3.3-7+squeeze14 \r\nii  php5-curl                                     5.3.3-7+squeeze14\r\nii  php5-dev                                      5.3.3-7+squeeze14\r\nii  php5-gd                                       5.3.3-7+squeeze14\r\nii  php5-mcrypt                                   5.3.3-7+squeeze14 \r\nii  php5-mysql                                    5.3.3-7+squeeze14 \r\nii  php5-sqlite                                   5.3.3-7+squeeze14\r\nii  php5-suhosin                                  0.9.32.1-1\r\n\r\nowncloud version:\r\n'version' => '4.90.7'\r\n\r\nlocale (active):\r\nfr_fr.utf-8@euro\r\n\r\nlocale (also installed):\r\nen_gb.utf-8 utf-8\r\n\r\n### client configuration\r\nbrowser:\r\niceweasel 20.0a2 (2013-02-01)\r\nsrware iron version 22.0.1250.0 (158531)\r\n\r\noperating system:\r\ndebian squeeze\r\n\r\n### logs\r\n#### web server error log\r\n* on rename:\r\n\"get /actic/?app=files&getfile=ajax/rename.php&dir=%2f&newname=%c3%a9aa&file=aa http/1.1\" 200 1305 \"https://cloud.domainepublic.net/actic/?app=files\" \"mozilla/5.0 (x11; linux x86_64; rv:20.0) gecko/20130201 firefox/20.0 iceweasel/20.0a2\"\r\n\r\n* on rescan:\r\n\"get /actic/?app=files&getfile=ajax/scan.php&force=true&dir=%2f&requesttoken=611f9d3ba326e42f7863 http/1.1\" 200 2294 \"https://cloud.domainepublic.net/actic/?app=files\" \"mozilla/5.0 (x11; linux x86_64; rv:20.0) gecko/20130201 firefox/20.0 iceweasel/20.0a2\"\r\n\"get /actic/?app=files http/1.1\" 200 4499 \"https://cloud.domainepublic.net/actic/?app=files\" \"mozilla/5.0 (x11; linux x86_64; rv:20.0) gecko/20130201 firefox/20.0 iceweasel/20.0a2\"\r\n\"get /actic/apps/files/js/jquery.iframe-transport.js http/1.1\" 304 820 \"https://cloud.domainepublic.net/actic/?app=files\" \"mozilla/5.0 (x11; linux x86_64; rv:20.0) gecko/20130201 firefox/20.0 iceweasel/20.0a2\"\r\n\"get /actic/apps/files/js/files.js http/1.1\" 304 708 \"https://cloud.domainepublic.net/actic/?app=files\" \"mozilla/5.0 (x11; linux x86_64; rv:20.0) gecko/20130201 firefox/20.0 iceweasel/20.0a2\r\n... (not pertinent)\r\n\r\n#### owncloud log (data/owncloud.log)\r\nnothing when i rename a file or do a rescan.\r\nafter a rename, if i try to rename it again, i have:\r\n{\"app\":\"core\",\"message\":\"unable to rename, file is not writable : files\\/aaa\",\"level\":3,\"time\":1361291596}\r\n\r\n#### browser log\r\njs console on rename:\r\nhttps://cloud.domainepublic.net/actic/?app=files&getfile=ajax/rename.php&dir=%2f&newname=%c3%a9bb&file=bb\r\nresponse:\r\n{\"data\":{\"dir\":\"\\/\",\"file\":\"bb\",\"newname\":\"\\u00e9bb\"},\"status\":\"success\"}\r\n\r\n","closed_by":{"login":"lukasreschke","id":878997,"avatar_url":"https://gravatar.com/avatar/f080e75d370a4d8e550983a4898bcf3b?d=https%3a%2f%2fidenticons.github.com%2ff12e47d5bb5359a9f58e8217413be790.png&r=x","gravatar_id":"f080e75d370a4d8e550983a4898bcf3b","url":"https://api.github.com/users/lukasreschke","html_url":"https://github.com/lukasreschke","followers_url":"https://api.github.com/users/lukasreschke/followers","following_url":"https://api.github.com/users/lukasreschke/following{/other_user}","gists_url":"https://api.github.com/users/lukasreschke/gists{/gist_id}","starred_url":"https://api.github.com/users/lukasreschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukasreschke/subscriptions","organizations_url":"https://api.github.com/users/lukasreschke/orgs","repos_url":"https://api.github.com/users/lukasreschke/repos","events_url":"https://api.github.com/users/lukasreschke/events{/privacy}","received_events_url":"https://api.github.com/users/lukasreschke/received_events","type":"user","site_admin":false}}