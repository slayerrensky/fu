{"url":"https://api.github.com/repos/owncloud/core/issues/4097","labels_url":"https://api.github.com/repos/owncloud/core/issues/4097/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4097/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4097/events","html_url":"https://github.com/owncloud/core/issues/4097","id":16853713,"number":4097,"title":"updating db schema can make owncloud unusable","user":{"login":"jvillafanez","id":1477829,"avatar_url":"https://gravatar.com/avatar/f422e6935e3ae694168c71e02b988ef2?d=https%3a%2f%2fidenticons.github.com%2f0929e47aa842da706b9c79f4c549ae04.png&r=x","gravatar_id":"f422e6935e3ae694168c71e02b988ef2","url":"https://api.github.com/users/jvillafanez","html_url":"https://github.com/jvillafanez","followers_url":"https://api.github.com/users/jvillafanez/followers","following_url":"https://api.github.com/users/jvillafanez/following{/other_user}","gists_url":"https://api.github.com/users/jvillafanez/gists{/gist_id}","starred_url":"https://api.github.com/users/jvillafanez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jvillafanez/subscriptions","organizations_url":"https://api.github.com/users/jvillafanez/orgs","repos_url":"https://api.github.com/users/jvillafanez/repos","events_url":"https://api.github.com/users/jvillafanez/events{/privacy}","received_events_url":"https://api.github.com/users/jvillafanez/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/db%3amysql","name":"db:mysql","color":"444444"}],"state":"closed","assignee":null,"milestone":null,"comments":5,"created_at":"2013-07-17t08:43:48z","updated_at":"2013-07-19t21:15:53z","closed_at":"2013-07-19t21:15:53z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"@mtrichards \r\n\r\nthere were some problems with the length of the indexes for mysql that prevented a clean upgrade of an app. after enabling the conflictive app, a white page with an sql error showed for every page i tried to enter, making owncloud unusable from an user point of view. the schema definition worked for sqlite3 but not for mysql.\r\n\r\n\r\n### expected behaviour\r\nthe system shouldn't allow to enable the conflictive app (if there is any error upgrading the schema definition) or auto-disable the app, notifying the user in both cases. this way, the user could still use owncloud.\r\n\r\n\r\n### actual behaviour\r\nwhite error page (seems a server crash) for every page the user enters. the page shows a db error updating the app.\r\n\r\n\r\n### server configuration\r\noperating system: ubuntu 12.04\r\n\r\nweb server: apache/2.2.22 (ubuntu)\r\n\r\ndatabase: mysql (could occur on other dbs where the db schema isn't supported)\r\n\r\nphp version: 5.3.10-1ubuntu3.7\r\n\r\nowncloud version: \"version\":\"5.80.5\"\r\n\r\n\r\nsample db schema which fails with mysql (sqlite3 won't complain)\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<database>\r\n  <name>*dbname*</name>\r\n  <create>true</create>\r\n  <overwrite>false</overwrite>\r\n  <charset>utf8</charset>\r\n  <table>\r\n    <name>*dbprefix*jjj</name>\r\n    <declaration>\r\n      <field>\r\n        <name>j_path</name>\r\n        <type>text</type>\r\n        <default></default>\r\n        <length>256</length>\r\n        <notnull>true</notnull>\r\n      </field>\r\n      <field>\r\n        <name>j_user</name>\r\n        <type>text</type>\r\n        <default></default>\r\n        <length>256</length>\r\n        <notnull>true</notnull>\r\n      </field>\r\n\r\n      <index>\r\n        <name>jive_path_index</name>\r\n        <unique>true</unique>\r\n        <field>\r\n          <name>j_path</name>\r\n          <sorting>ascending</sorting>\r\n        </field>\r\n        <field>\r\n          <name>j_user</name>\r\n        </field>\r\n      </index>\r\n    </declaration>\r\n  </table>\r\n</database>\r\n```\r\n","closed_by":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false}}