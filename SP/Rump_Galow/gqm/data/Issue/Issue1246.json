{"url":"https://api.github.com/repos/owncloud/core/issues/1246","labels_url":"https://api.github.com/repos/owncloud/core/issues/1246/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1246/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1246/events","html_url":"https://github.com/owncloud/core/issues/1246","id":10138764,"number":1246,"title":"external storage local - oc in particular conditions unresponsive for everybody","user":{"login":"mmattel","id":3321281,"avatar_url":"https://gravatar.com/avatar/2d576241f3ac901ec52f1ec4a9c3b77b?d=https%3a%2f%2fidenticons.github.com%2f62fba4fe6711d41fdbfc7ccc04efb8f4.png&r=x","gravatar_id":"2d576241f3ac901ec52f1ec4a9c3b77b","url":"https://api.github.com/users/mmattel","html_url":"https://github.com/mmattel","followers_url":"https://api.github.com/users/mmattel/followers","following_url":"https://api.github.com/users/mmattel/following{/other_user}","gists_url":"https://api.github.com/users/mmattel/gists{/gist_id}","starred_url":"https://api.github.com/users/mmattel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmattel/subscriptions","organizations_url":"https://api.github.com/users/mmattel/orgs","repos_url":"https://api.github.com/users/mmattel/repos","events_url":"https://api.github.com/users/mmattel/events{/privacy}","received_events_url":"https://api.github.com/users/mmattel/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3afiles_external","name":"app:files_external","color":"02d7e1"},{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"},{"url":"https://api.github.com/repos/owncloud/core/labels/enhancement","name":"enhancement","color":"02e10c"}],"state":"closed","assignee":null,"milestone":{"url":"https://api.github.com/repos/owncloud/core/milestones/2","labels_url":"https://api.github.com/repos/owncloud/core/milestones/2/labels","id":182810,"number":2,"title":"owncloud 5","description":"","creator":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"open_issues":0,"closed_issues":174,"state":"closed","created_at":"2012-09-24t16:33:41z","updated_at":"2013-08-07t14:29:42z","due_on":"2013-02-28t08:00:00z"},"comments":10,"created_at":"2013-01-20t17:50:13z","updated_at":"2013-01-22t22:19:49z","closed_at":"2013-01-22t22:19:49z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"oc 4.5.5 on ubuntu 12.04, external storage via smb, app rescan_fs and external storage\r\n\r\ni have a couple of smb mounts created via fstab which are linked to my external storage. this works pretty straight forward. info: some of the mounts have hundreds of gigabytes of data and thousands of files. in oc, i have created some users and groups, then i added the local mounts to oc and granted drive access either to users and/or groups. this means that groups get eg public accessed local drive  and users their own local drive. saying that, oc behaves somehow strange:\r\n\r\nin all described conditions, no logon can be done or any action for any logged on user can be done. in htoc you see, that apache takes during scanning about 20-25% cpu, memory is fine.\r\n\r\n1.) as a administrator, when adding a local drive i need to rescan to get content visible. but this means, that the rescan can not be restricted to the new drive only, everything getâ´s rescanned. oc becomes for pretty much time, dependent on the size of the drives, totally unresponsive. i speak from 10 min minimum... in my last test, i waited 30min+\r\n\r\n2.) logging off as admin and logging on as user to see if everything worked. oc seems to rescan all drives the user has again. oc becomes unresponsive.\r\n\r\nfirst question: why is a scannin / a userdependent file list necessary - yes searching, but why cant that be done on a global basis when the drive getâ´s mounted by the admin and in a way where oc can still serve data? as a admin, i can see local drives and the content of the drives i add anyway. wouldnâ´t it be a good idea to manage \"global\" data in a more easy way so that created data is valid for all users sharing that data?\r\n\r\nsecond question: can drive scanning be done in a way where oc stays responsive?\r\n \r\n3.) what i found out is, that if more than one drives having different music data, oc getâ´s confused to show up this data properly in the music tab. i have not found out the in/excluding respectively sort order when clicking the music tab.\r\n\r\n4.) adding a local drive as admin and granting access to a user, the drive does not always show up when the user first time logges on. the same when a drive getâ´s deleted or disgranted by the admin, the drive is still there when logging on as user.\r\n\r\n5.) having a storage where snapshots are possible, these snapshots are visible in the/each folder of the drive. there is a special folder called .snapshot where you find all snaps created. underneath you have all the data as it has been at the time creating the snap. having the .snapshot directory visible, oc scanâ´s <all> snapshots and all data again. this means when you have 100g of data and 15 snapshots, oc scans 1.5tb instead only 100g.\r\n\r\nthird question: is there a way exluding folders in a drive to be scanned\r\n\r\n","closed_by":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false}}