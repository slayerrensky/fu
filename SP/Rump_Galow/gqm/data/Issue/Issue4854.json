{"url":"https://api.github.com/repos/owncloud/core/issues/4854","labels_url":"https://api.github.com/repos/owncloud/core/issues/4854/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4854/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4854/events","html_url":"https://github.com/owncloud/core/issues/4854","id":19501692,"number":4854,"title":"not null violations on oc_filecache.unencrypted_size when syncing a file with size 0","user":{"login":"migtavares","id":536927,"avatar_url":"https://gravatar.com/avatar/04db5fcdcea6579627dded0ce41b8c9a?d=https%3a%2f%2fidenticons.github.com%2f883690f3faa91ddd11f159a1fc463caa.png&r=x","gravatar_id":"04db5fcdcea6579627dded0ce41b8c9a","url":"https://api.github.com/users/migtavares","html_url":"https://github.com/migtavares","followers_url":"https://api.github.com/users/migtavares/followers","following_url":"https://api.github.com/users/migtavares/following{/other_user}","gists_url":"https://api.github.com/users/migtavares/gists{/gist_id}","starred_url":"https://api.github.com/users/migtavares/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/migtavares/subscriptions","organizations_url":"https://api.github.com/users/migtavares/orgs","repos_url":"https://api.github.com/users/migtavares/repos","events_url":"https://api.github.com/users/migtavares/events{/privacy}","received_events_url":"https://api.github.com/users/migtavares/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":3,"created_at":"2013-09-14t13:16:32z","updated_at":"2013-09-24t17:55:41z","closed_at":"2013-09-24t17:55:41z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"a software i use creates a lock file of size zero when using a file (at the same directory of the file being used).\r\n\r\nif the lock file is synchronized to the owncloud server then the user account becomes inaccessible as the server locks when trying to sync that file (on any access, to any owncloud application).\r\n\r\nrelevant log entry:\r\n\t{\"app\":\"hook\",\"message\":\"error while running hook (\\\\oc\\\\files\\\\cache\\\\shared_updater::writehook): sqlstate[23502]: not null violation: 7 error:  null value in column \\\"unencrypted_size\\\" violates not-null constraint\\ndetail:  failing row contains (31016, 2, files\\/keysdatabase.kdb.lock, f018ac7d88f94aedc107068b09c734fa, 5, keysdatabase.kdb.lock, 8, 7, 0, 1379163846, 0, 52345ec70f9ab, null).\",\"level\":3,\"time\":\"2013-09-14t13:04:07+00:00\"}\r\n\r\nsystem info:\r\n\r\n* gentoo linux\r\n* lighttpd 1.4.32\r\n* postgresql 9.2.4\r\n\r\nworkaround:\r\n\talter table oc_filecache alter column unencrypted_size drop not null;\r\n\r\ni have no idea of the side effects of dropping the not null constraint... but it's probably not good.","closed_by":{"login":"kondou-ger","id":1410802,"avatar_url":"https://gravatar.com/avatar/917dab919ae812f8252b2f501c514b19?d=https%3a%2f%2fidenticons.github.com%2fd07869ed62cb1b7f88b731956ab913ee.png&r=x","gravatar_id":"917dab919ae812f8252b2f501c514b19","url":"https://api.github.com/users/kondou-ger","html_url":"https://github.com/kondou-ger","followers_url":"https://api.github.com/users/kondou-ger/followers","following_url":"https://api.github.com/users/kondou-ger/following{/other_user}","gists_url":"https://api.github.com/users/kondou-ger/gists{/gist_id}","starred_url":"https://api.github.com/users/kondou-ger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kondou-ger/subscriptions","organizations_url":"https://api.github.com/users/kondou-ger/orgs","repos_url":"https://api.github.com/users/kondou-ger/repos","events_url":"https://api.github.com/users/kondou-ger/events{/privacy}","received_events_url":"https://api.github.com/users/kondou-ger/received_events","type":"user","site_admin":false}}