{"url":"https://api.github.com/repos/owncloud/core/issues/4518","labels_url":"https://api.github.com/repos/owncloud/core/issues/4518/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4518/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4518/events","html_url":"https://github.com/owncloud/core/issues/4518","id":18238650,"number":4518,"title":"sql error indexing music with åœ on postgresql","user":{"login":"jqueuniet","id":5261422,"avatar_url":"https://gravatar.com/avatar/ffa4f0d0f78d5a5bb7da6148dee792b0?d=https%3a%2f%2fidenticons.github.com%2f0db3b7a3e1f2c54148c11d413b5e4a08.png&r=x","gravatar_id":"ffa4f0d0f78d5a5bb7da6148dee792b0","url":"https://api.github.com/users/jqueuniet","html_url":"https://github.com/jqueuniet","followers_url":"https://api.github.com/users/jqueuniet/followers","following_url":"https://api.github.com/users/jqueuniet/following{/other_user}","gists_url":"https://api.github.com/users/jqueuniet/gists{/gist_id}","starred_url":"https://api.github.com/users/jqueuniet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jqueuniet/subscriptions","organizations_url":"https://api.github.com/users/jqueuniet/orgs","repos_url":"https://api.github.com/users/jqueuniet/repos","events_url":"https://api.github.com/users/jqueuniet/events{/privacy}","received_events_url":"https://api.github.com/users/jqueuniet/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-08-19t13:13:59z","updated_at":"2013-08-19t14:20:12z","closed_at":"2013-08-19t14:04:14z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"owncloud fails indexing music with a åœ in the artist name. after the first song, it fails to find the already existing artist in the database and tries to insert duplicates.\r\n\r\n```\r\n{\"app\":\"php\",\"message\":\"sqlstate[23505]: unique violation: 7 erreur:  la valeur d'une cl\\u00e9 dupliqu\\u00e9e rompt la contrainte unique \\u00ab artist_name \\u00bb\\ndetail:  la cl\\u00e9 \\u00ab (artist_name)=(michiru \\u014cshima) \\u00bb existe d\\u00e9j\\u00e0. at {path}\\/lib\\/db.php#1031\",\"level\":4,\"time\":1376913690}\r\n```\r\n\r\nthese error completly blocks the scanning process.\r\n\r\nremoving the unique constraint on oc_media_artists.artist_name gets the process running again, but the problematic artists do not appear in the gui and owncloud basically creates an artist by song in the database.\r\n\r\n```\r\nowncloud=# select count(*) as count, artist_name from oc_media_artists group by artist_name having count(artist_name) > 1;\r\n count |   artist_name   \r\n-------+-----------------\r\n    43 | toshiyuki åœmori\r\n    60 | michiru åœshima\r\n    23 | kå? åœtani\r\n     2 | kenji åœtsuki\r\n(4 lignes)\r\n```\r\n\r\nthe low caps version å? do not seems to pose a problem.\r\n\r\ni use postgresql as database backend.","closed_by":{"login":"kondou-ger","id":1410802,"avatar_url":"https://gravatar.com/avatar/917dab919ae812f8252b2f501c514b19?d=https%3a%2f%2fidenticons.github.com%2fd07869ed62cb1b7f88b731956ab913ee.png&r=x","gravatar_id":"917dab919ae812f8252b2f501c514b19","url":"https://api.github.com/users/kondou-ger","html_url":"https://github.com/kondou-ger","followers_url":"https://api.github.com/users/kondou-ger/followers","following_url":"https://api.github.com/users/kondou-ger/following{/other_user}","gists_url":"https://api.github.com/users/kondou-ger/gists{/gist_id}","starred_url":"https://api.github.com/users/kondou-ger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kondou-ger/subscriptions","organizations_url":"https://api.github.com/users/kondou-ger/orgs","repos_url":"https://api.github.com/users/kondou-ger/repos","events_url":"https://api.github.com/users/kondou-ger/events{/privacy}","received_events_url":"https://api.github.com/users/kondou-ger/received_events","type":"user","site_admin":false}}