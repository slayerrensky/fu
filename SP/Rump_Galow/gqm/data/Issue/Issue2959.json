{"url":"https://api.github.com/repos/owncloud/core/issues/2959","labels_url":"https://api.github.com/repos/owncloud/core/issues/2959/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2959/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2959/events","html_url":"https://github.com/owncloud/core/issues/2959","id":13282399,"number":2959,"title":"migrate 4.5.5 to 5.0.4 (query_time values incorrect in mysql)","user":{"login":"4bendo","id":2917087,"avatar_url":"https://gravatar.com/avatar/eedcaad219625223dcb55ae0f0d12b71?d=https%3a%2f%2fidenticons.github.com%2f95c72c4c3c285cf95f4f5331b75ac104.png&r=x","gravatar_id":"eedcaad219625223dcb55ae0f0d12b71","url":"https://api.github.com/users/4bendo","html_url":"https://github.com/4bendo","followers_url":"https://api.github.com/users/4bendo/followers","following_url":"https://api.github.com/users/4bendo/following{/other_user}","gists_url":"https://api.github.com/users/4bendo/gists{/gist_id}","starred_url":"https://api.github.com/users/4bendo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/4bendo/subscriptions","organizations_url":"https://api.github.com/users/4bendo/orgs","repos_url":"https://api.github.com/users/4bendo/repos","events_url":"https://api.github.com/users/4bendo/events{/privacy}","received_events_url":"https://api.github.com/users/4bendo/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/update","name":"update","color":"e10c02"}],"state":"closed","assignee":null,"milestone":null,"comments":10,"created_at":"2013-04-17t06:11:24z","updated_at":"2013-04-17t20:02:37z","closed_at":"2013-04-17t10:40:35z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"i've used oc since 4.0.x versions and have yet to upgrade/update successfully over 3-5 upgrades.  in all past attempts i end up deleting mysql database and let oc rebuild the database in the new version to use the new version.\r\n\r\ncurrently, i have a stable oc4.5.5 install on:\r\n\r\nwin8\r\niis8\r\nmysql 5.5.28\r\nphp5.3.19\r\n\r\nafter seeing that things may have become more stable and i want to try new features with the 5.x line of oc.  i decide to try and upgrade.\r\n\r\ni use this page to upgrade:  \r\nhttp://doc.owncloud.org/server/5.0/admin_manual/maintenance/update.html\r\n\r\nmy first try is to follow instructions for upgrade to 4.5.9.  this ends in failure even though i follow all the directions correctly.  the error when i reload oc browser page is \"error while upgrading the database\"  every time in the past that i try to update i have gotten this error.  i cannot figure out what i must do to in order to update the database properly.  my past solution is to delete the database, and let oc reconfigure a new one.\r\n\r\nthen i restore backups and confirm that original 4.5.5 is working properly...it does.\r\n\r\nmy second try is to go directly to 5.0.4.  i follow again the directions on the oc documentation page listed above, except i do not try to update to 4.5.9 as suggested in the directions since we found this already doesn't work.  when i copy all new files and confirm permissions i get the following error in oc brower page \"owncloud is in maintenance mode\".  i change the switch in the config.php file to \"false\" for maintenance mode and retry.  i then get:\r\n\r\nturned on maintenance mode\r\nfailed to get existing database structure for updating (mdb2_schema error: schema validation error, default value of \"query_time\" is incorrect: \"\" is not of type \"time\")\r\n\r\ni don't know much about configuring databases, and as such don't do any backdoor tweaks.  the mysql db created has been from oc.\r\n\r\noc log\r\n\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/,c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): access is denied. (code: 5) at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): failed to open dir: no such file or directory at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"readdir() expects parameter 1 to be resource, boolean given at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#72\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/,c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): access is denied. (code: 5) at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): failed to open dir: no such file or directory at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"readdir() expects parameter 1 to be resource, boolean given at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#72\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/,c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): access is denied. (code: 5) at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): failed to open dir: no such file or directory at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"readdir() expects parameter 1 to be resource, boolean given at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#72\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/,c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): access is denied. (code: 5) at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"opendir(c:\\\\windows\\\\temp\\/owncloud-50d73b02db0f1\\/): failed to open dir: no such file or directory at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#71\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"readdir() expects parameter 1 to be resource, boolean given at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\lib\\\\cache\\\\fileglobal.php#72\",\"level\":2,\"time\":1366179966}\r\n{\"app\":\"php\",\"message\":\"non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\3rdparty\\\\mdb2\\\\schema.php#2794\",\"level\":2,\"time\":1366179968}\r\n{\"app\":\"php\",\"message\":\"non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context at c:\\\\inetpub\\\\wwwroot\\\\owncloud\\\\3rdparty\\\\mdb2\\\\schema.php#2794\",\"level\":2,\"time\":1366179968}\r\n{\"app\":\"core\",\"message\":\"failed to get existing database structure for updating (mdb2_schema error: schema validation error, default value of \\\"query_time\\\" is incorrect: \\\"\\\" is not of type \\\"time\\\")\",\"level\":4,\"time\":1366179968}\r\n\r\nphp log\r\n\r\n[16-apr-2013 05:54:00 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[16-apr-2013 05:54:00 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[16-apr-2013 05:54:19 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[16-apr-2013 05:54:19 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[16-apr-2013 05:55:57 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[16-apr-2013 05:55:57 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[16-apr-2013 06:22:00 utc] php fatal error:  call to undefined method oc\\files\\view::is_readable() in c:\\inetpub\\wwwroot\\owncloud\\lib\\filecache.php on line 451\r\n[16-apr-2013 19:15:07 utc] php fatal error:  call to undefined method oc\\files\\view::is_readable() in c:\\inetpub\\wwwroot\\owncloud\\lib\\filecache.php on line 451\r\n[16-apr-2013 19:15:10 utc] php fatal error:  call to undefined method oc\\files\\view::is_readable() in c:\\inetpub\\wwwroot\\owncloud\\lib\\filecache.php on line 451\r\n[16-apr-2013 19:15:13 utc] php fatal error:  call to undefined method oc\\files\\view::is_readable() in c:\\inetpub\\wwwroot\\owncloud\\lib\\filecache.php on line 451\r\n[17-apr-2013 03:03:35 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[17-apr-2013 03:03:35 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[17-apr-2013 03:04:52 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[17-apr-2013 03:04:52 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[17-apr-2013 03:05:02 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n[17-apr-2013 03:05:02 utc] php strict standards:  non-static method mdb2_schema::errormessage() should not be called statically, assuming $this from incompatible context in c:\\inetpub\\wwwroot\\owncloud\\3rdparty\\mdb2\\schema.php on line 2794\r\n","closed_by":{"login":"raydiation","id":195053,"avatar_url":"https://gravatar.com/avatar/aa0d7b7302e0d7f4f9513c23b571383a?d=https%3a%2f%2fidenticons.github.com%2faf0a25e27510f77d97634a6bbe653b13.png&r=x","gravatar_id":"aa0d7b7302e0d7f4f9513c23b571383a","url":"https://api.github.com/users/raydiation","html_url":"https://github.com/raydiation","followers_url":"https://api.github.com/users/raydiation/followers","following_url":"https://api.github.com/users/raydiation/following{/other_user}","gists_url":"https://api.github.com/users/raydiation/gists{/gist_id}","starred_url":"https://api.github.com/users/raydiation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raydiation/subscriptions","organizations_url":"https://api.github.com/users/raydiation/orgs","repos_url":"https://api.github.com/users/raydiation/repos","events_url":"https://api.github.com/users/raydiation/events{/privacy}","received_events_url":"https://api.github.com/users/raydiation/received_events","type":"user","site_admin":false}}