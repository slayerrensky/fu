{"url":"https://api.github.com/repos/owncloud/core/issues/4533","labels_url":"https://api.github.com/repos/owncloud/core/issues/4533/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4533/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4533/events","html_url":"https://github.com/owncloud/core/issues/4533","id":18311164,"number":4533,"title":"encryption error for shared folders by uploading with dav-device","user":{"login":"webmans","id":5271893,"avatar_url":"https://gravatar.com/avatar/4cd62e413f6daf5c0f66203e8e3cde19?d=https%3a%2f%2fidenticons.github.com%2f45524b3edc1817e3997006f0ce6f81db.png&r=x","gravatar_id":"4cd62e413f6daf5c0f66203e8e3cde19","url":"https://api.github.com/users/webmans","html_url":"https://github.com/webmans","followers_url":"https://api.github.com/users/webmans/followers","following_url":"https://api.github.com/users/webmans/following{/other_user}","gists_url":"https://api.github.com/users/webmans/gists{/gist_id}","starred_url":"https://api.github.com/users/webmans/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webmans/subscriptions","organizations_url":"https://api.github.com/users/webmans/orgs","repos_url":"https://api.github.com/users/webmans/repos","events_url":"https://api.github.com/users/webmans/events{/privacy}","received_events_url":"https://api.github.com/users/webmans/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"milestone":null,"comments":5,"created_at":"2013-08-20t18:03:55z","updated_at":"2013-09-06t14:10:46z","closed_at":"2013-09-06t14:10:46z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"hey, guys!\r\n\r\ni started working with owncloud and i'm so impressed by our great work. so, thanks for that!\r\n\r\nhowever, i found a bug in the encryption app in owncloud 5.0.10 + files_encryption 0.4. i am the owner of a folder, have shared this folder with a group and have mounted my cloud on windows as a network device via webdav and the integrated sabredav with the url https://[domain].com/remote.php/webdav/\r\n\r\n\r\n### expected behaviour\r\nif i upload a file via windows mounted web device, the file will be encrypted for me on server and also be encrypted correctly and available for all users the file or upper folder is shared with.\r\n\r\n### actual behaviour\r\nso, if i upload a file f to the group-shared folder, the file will be successfully encrypted for me and also copied for every group user in the sharing group, but the encryption for other users failed. because if one user of this group opens the file, it will stay encrypted and the user will not be able to see the real content of the file.\r\ni tried this with several test files and also with sharing just with one user, but the problem remains.\r\n\r\n### steps to reproduce\r\n1. share a folder with a group or user.\r\n2. mount the owncloud folder on your windows device via net use * \\\\[domain].com@ssl\\remote.php\\webdav\\ /user:[user] [passwd] /persistent:no\r\n3. upload/copy a file via windows explorer to the shared folder inside the device.\r\n4. try to access the file with a user within the sharing group.\r\n\r\n### server configuration\r\noperating system: linux, opensuse 12.3\r\n\r\nweb server: nginx 1.5.3\r\n\r\ndatabase: mysql\r\n\r\nphp version: 5.5\r\n\r\nowncloud version: 5.0.10\r\n\r\n### client configuration\r\nbrowser: google chrome 28.0.1500.95\r\n\r\noperating system: windows 8\r\n\r\n\r\n#### owncloud log (data/owncloud.log)\r\n{\"app\":\"encryption library\",\"message\":\"decryption (asymmetric) of sealed content with share-key \\\"\\\" failed\",\"level\":3,\"time\":\"2013-08-19t12:35:17+00:00\"}\r\n{\"app\":\"files_sharing\",\"message\":\"file source not found for: \\/\\/[folder]\\/[file]\",\"level\":3,\"time\":\"2013-08-19t12:35:17+00:00\"}\r\n{\"app\":\"php\",\"message\":\"encryption key not found for \\\"\\/[user]\\/files\\/shared\\/[folder]\\/[file]\\\" during attempted read via stream at \\/[path_to_owncloud]\\/apps\\/files_encryption\\/lib\\/stream.php#187\",\"level\":4,\"time\":\"2013-08-19t12:35:17+00:00\"}\r\n\r\n\r\n\r\nif i upload the file via the web interface, there will be no problem. the bug just occurs on using the sabre webdav mounted on my windows machine.\r\n\r\ni hope my report is detailed enough and helps to fix the issue.\r\nthanks for caring!\r\n\r\n","closed_by":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false}}