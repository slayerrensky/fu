{"url":"https://api.github.com/repos/owncloud/core/issues/1376","labels_url":"https://api.github.com/repos/owncloud/core/issues/1376/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1376/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1376/events","html_url":"https://github.com/owncloud/core/issues/1376","id":10456048,"number":1376,"title":"owncloud fails to activate apps inside a folder name that contains a dash (\"-\")","user":{"login":"arkascha","id":2156237,"avatar_url":"https://gravatar.com/avatar/9f792aed86f70eaed1b29e2f0398a881?d=https%3a%2f%2fidenticons.github.com%2fdb1707d51d6171a42a29fe8985cb531d.png&r=x","gravatar_id":"9f792aed86f70eaed1b29e2f0398a881","url":"https://api.github.com/users/arkascha","html_url":"https://github.com/arkascha","followers_url":"https://api.github.com/users/arkascha/followers","following_url":"https://api.github.com/users/arkascha/following{/other_user}","gists_url":"https://api.github.com/users/arkascha/gists{/gist_id}","starred_url":"https://api.github.com/users/arkascha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arkascha/subscriptions","organizations_url":"https://api.github.com/users/arkascha/orgs","repos_url":"https://api.github.com/users/arkascha/repos","events_url":"https://api.github.com/users/arkascha/events{/privacy}","received_events_url":"https://api.github.com/users/arkascha/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/enhancement","name":"enhancement","color":"02e10c"}],"state":"closed","assignee":null,"milestone":null,"comments":7,"created_at":"2013-01-30t12:01:49z","updated_at":"2013-08-05t12:34:32z","closed_at":"2013-08-05t12:34:32z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"current stable (oc-4.5.6) fails to active an app that is extracted into a folder that is named with a dash (\"-\") in the name. this often happens when apps are installed manually, since then the naming of the folder is up to the installing user. often names like <appname>-<version> are chosen. such naming scheme clearly makes sense from a technical point of view and is perfectly sane on a sytem level. also owncloud sees the app and offers it for activation. however during that activation an sql statement fails which is mean to to write the apps preferences: \r\n\r\n> fatal error: uncaught exception 'pdoexception' with message\r\n> 'sqlstate[23000]: integrity constraint violation: 1048 column 'appid'\r\n> cannot be null' in /var/www/bcloud/lib/db.php:731\r\n\r\nthe reason for column 'appid' being filled with an empty value simply is that owncloud considers the folder name the app has been installed into as naeme of the app. this is strange in my eyes. also it completely fails when the folders are named as described above. the name is treated as a mathematical expression by php which tries to build the difference of two invalid numerical values. this attempt results in a value false, so an empty value as appid. \r\n\r\ni see three issues that should all be corrected inside oc-core: \r\n1.) not the apps folder name should be taken as the apps name. i do know that this approach simplifies app handling. however it also leads to problems like the one described here. those are issues that could be avoided with a different approach. \r\n2.) the result of the decision which name to use for an app should be validated. maybe by testing the name (appid) against a regular expression. \r\n3.) the error generated is not helpful. neither is it displayed to the user (the user just gets a generic \"failed\" error message, if at all), nor does it contain any meaningful information which might help to solve the problem. \r\n\r\nsince owncloud allows to manually install apps the process of handling such apps should be robust enough. to prevent performance issues during normal operation it might make sense to limit checks of those names to handling during the installation/activation of apps. ","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}