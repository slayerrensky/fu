{"url":"https://api.github.com/repos/owncloud/core/issues/1184","labels_url":"https://api.github.com/repos/owncloud/core/issues/1184/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1184/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1184/events","html_url":"https://github.com/owncloud/core/issues/1184","id":9960383,"number":1184,"title":"files with special characters appear twice in filelist and are showing \"cloud not found\"","user":{"login":"lukasreschke","id":878997,"avatar_url":"https://gravatar.com/avatar/f080e75d370a4d8e550983a4898bcf3b?d=https%3a%2f%2fidenticons.github.com%2ff12e47d5bb5359a9f58e8217413be790.png&r=x","gravatar_id":"f080e75d370a4d8e550983a4898bcf3b","url":"https://api.github.com/users/lukasreschke","html_url":"https://github.com/lukasreschke","followers_url":"https://api.github.com/users/lukasreschke/followers","following_url":"https://api.github.com/users/lukasreschke/following{/other_user}","gists_url":"https://api.github.com/users/lukasreschke/gists{/gist_id}","starred_url":"https://api.github.com/users/lukasreschke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukasreschke/subscriptions","organizations_url":"https://api.github.com/users/lukasreschke/orgs","repos_url":"https://api.github.com/users/lukasreschke/repos","events_url":"https://api.github.com/users/lukasreschke/events{/privacy}","received_events_url":"https://api.github.com/users/lukasreschke/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3afiles","name":"app:files","color":"02d7e1"},{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-01-14t22:29:19z","updated_at":"2013-08-05t11:26:19z","closed_at":"2013-08-05t11:26:19z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### bug\r\nwhile trying to test #1117 i struggled into a bug: if i upload a file with special characters in it, the file appears twice in my filelist and both files are linking to a \"cloud not found\" error.\r\n\r\n![fmqy6fpv4_m3](https://f.cloud.github.com/assets/878997/66130/26ae0554-5e99-11e2-8bb0-a4114dcbc1c6.png)\r\n![cf6y2l 245ug](https://f.cloud.github.com/assets/878997/66131/384366ce-5e99-11e2-8478-3f224ad1537e.png)\r\n\r\nsurprisingly, the files are generated correctly on the filesystem:\r\n\r\n```\r\nrechenknecht:aple lukas$ ls -l\r\ntotal 24\r\n-rw-r--r--  1 lukas  admin  14 jan 14 23:15 ã¶ã¤ã¼ãÿ.txt\r\n-rw-r--r--  1 lukas  admin  13 jan 14 23:15 undaã§ao.doc\r\n-rw-r--r--  1 lukas  admin  25 jan 14 23:15 ä¸­æ–‡blahä¸­æ–‡blah.txt\r\n````\r\n\r\nthe database contains all the duplicates:\r\n```\r\nsqlite> select * from oc_fscache;\r\nid          path          path_hash                         parent      name        user        size        ctime       mtime       mimetype              mimepart    encrypted   versioned   writable  \r\n----------  ------------  --------------------------------  ----------  ----------  ----------  ----------  ----------  ----------  --------------------  ----------  ----------  ----------  ----------\r\n1           /admin/files  dbb5f96946862a55abb65ee90e3cf566  -1          files       admin       1408231     1358201699  1358201699  httpd/unix-directory  httpd       0           0           1         \r\n2           /admin/files  2726a85cbc2c4c1fff9e0a258fd54157  1           asd         admin       0           1357929565  1357929565  httpd/unix-directory  httpd       0           0           1         \r\n3           /admin/files  cf32b113e3ef73520c6541246f4cd33a  1           asd (2)     admin       885408      1357991254  1357991254  httpd/unix-directory  httpd       0           0           1         \r\n4           /admin/files  035dbe9fa2cb39cf325174deefdd88c4  1           asd (3)     admin       0           1357929570  1357929570  inode/x-empty         inode       0           0           1         \r\n5           /admin/files  b0cbedcc1d470ddb4c0c7fe11fbfb44b  1           xss\">       admin       0           1357929576  1357929576  inode/x-empty         inode       0           0           1         \r\n6           /admin/files  0fd07541d5481ea4bced03b7282fda91  1           script>     admin       0           1357929592  1357929592  inode/x-empty         inode       0           0           1         \r\n7           /admin/files  9b5a94232e3aa76b7bb809bfdbcd1b20  3           crypto.go-  admin       885408      1357991254  1357991254  application/zip       applicatio  0           0           1         \r\n8           /admin/files  6fdddd75cbfbd4855d8c0bef689e5afb  1           placeholde  admin       516653      1357991291  1357991291  regular file          .           0           0           1         \r\n9           /admin/files  68c55943066fc6fa482b48879f13fac7  1           .ds_store   admin       6148        1358036607  1358036607  regular file          .           0           0           1         \r\n10          /admin/files  f521904e373df8d6905d51198f4acd84  1           l10n        admin       22          1358036619  1358036619  httpd/unix-directory  httpd       0           0           1         \r\n11          /admin/files  911f170f33c1a55dcaedcb958473fd42  10          en.php      admin       22          1358036631  1358036631  application/x-php     applicatio  0           0           1         \r\n12          /test/files   4ede7615fcd5a6af9822707e57682565  -1          files       test        0           1358038694  1358038694  httpd/unix-directory  httpd       0           0           1         \r\n13          /test/files/  6b5b576c1fba2d0feb024c253c749dc8  12          test        test        0           1358038694  1358038694  httpd/unix-directory  httpd       0           0           1         \r\n10090       /admin/files  b0062baa436b2d1c1a5ffd840018203b  1           test        admin       0           1358038694  1358038694  httpd/unix-directory  httpd       0           0           1         \r\n11154       /admin/files  ae0ca8a230cdd8381c0e368b510634bc  1           clientsync  admin       0           1358090861  1358090861  httpd/unix-directory  httpd       0           0           1         \r\n11155       /admin/files  7405f2448e8b8df8b075d179623cf92d  1           test (2)    admin       0           1358201695  1358201695  httpd/unix-directory  httpd       0           0           1         \r\n11156       /admin/files  45888f52f4b39431ca8d96bbcb17d0c0  1           aple        admin       79          1358201705  1358201705  httpd/unix-directory  httpd       0           0           1         \r\n11157       /admin/files  6679add38f7dd5e9d2f8a88daedbb92e  11156       ã¶ã¤ã¼ãÿ.t  admin       14          1358201705  1358201705  text/plain            text        0           0           1         \r\n11158       /admin/files  e2363065cde797eb5e817ab019c44808  11156       undaã§ao.d  admin       13          1358201705  1358201705  application/msword    applicatio  0           0           1         \r\n11159       /admin/files  3f8dd97d18ca35a4ead3b5babba3dfa2  11156       ä¸­æ–‡blah  admin       25          1358201705  1358201705  text/plain            text        0           0           1         \r\n11160       /admin/files  6e447dae2eac094f1438511b139227cf  11156       ã¶ã¤ã¼?  admin       14          1358201705  1358201705  text/plain            text        0           0           1         \r\n11161       /admin/files  b5c676f1d506f31d986fb2bad5a61977  11156       undaã§ao.  admin       13          1358201705  1358201705  application/msword    applicatio  0           0           1         \r\n```\r\n\r\n### steps to reproduce\r\n1. upload a file called `ä¸­æ–‡blahä¸­æ–‡blah.txt`\r\n2. refresh\r\n3. try to open the file (links to: `http://localhost:8888/core/index.php/apps/files/download.php?file=/aple/%e4%b8%ad%e6%96%87blah%e4%b8%ad%e6%96%87blah.txt`)\r\n\r\n### server configuration\r\noperating system: os x 10.8.2 \r\nweb server: apache/2.2.22 (unix) mod_ssl/2.2.22 openssl/0.9.8r dav/2 php/5.4.4\r\ndatabase: sqlite\r\nphp version: 5.4.4\r\nowncloud version: master (53ca0db434f3ad8d043a0a9b76bd59f22af38f99)\r\n\r\n### client configuration\r\nbrowser: chrome 24.0.1312.52\r\noperating system: os x 10.8.2","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}