{"url":"https://api.github.com/repos/owncloud/core/issues/4416","labels_url":"https://api.github.com/repos/owncloud/core/issues/4416/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/4416/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/4416/events","html_url":"https://github.com/owncloud/core/issues/4416","id":18040677,"number":4416,"title":"db constraint problem with null value in column \"unencrypted_size\"","user":{"login":"sr-rolando","id":427607,"avatar_url":"https://gravatar.com/avatar/75a8e55811efbfcd11752f5c0154e596?d=https%3a%2f%2fidenticons.github.com%2fe4e35db480238710966800a86c4a7782.png&r=x","gravatar_id":"75a8e55811efbfcd11752f5c0154e596","url":"https://api.github.com/users/sr-rolando","html_url":"https://github.com/sr-rolando","followers_url":"https://api.github.com/users/sr-rolando/followers","following_url":"https://api.github.com/users/sr-rolando/following{/other_user}","gists_url":"https://api.github.com/users/sr-rolando/gists{/gist_id}","starred_url":"https://api.github.com/users/sr-rolando/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sr-rolando/subscriptions","organizations_url":"https://api.github.com/users/sr-rolando/orgs","repos_url":"https://api.github.com/users/sr-rolando/repos","events_url":"https://api.github.com/users/sr-rolando/events{/privacy}","received_events_url":"https://api.github.com/users/sr-rolando/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":8,"created_at":"2013-08-14t08:33:45z","updated_at":"2013-09-22t15:40:20z","closed_at":"2013-09-22t15:40:20z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"### expected behaviour\r\n\r\nfiles should be uploadable to owncloud.\r\n\r\n### actual behaviour\r\n\r\neach file upload fails with the following error being logged (in syslog):\r\n\r\n```\r\nerror:  null value in column \"unencrypted_size\" violates not-null constraint\r\ndetail:  failing row contains (1317, 2, files/clientsync/dummy.pdf, 8bdf3089ece69c0945ba725162dc228f, 685, dummy.pdf, 10, 9, 497912, 1376468768, 0, null, 520b3f20af51a).\r\nstatement:  insert into \"oc_filecache\"(\"mimepart\", \"mimetype\", \"mtime\", \"size\", \"etag\", \"path_hash\", \"path\", \"parent\", \"name\", \"encrypted\", \"storage\") values($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)\r\n```\r\n\r\n### steps to reproduce\r\n1. use postgresql in the server configuration (see below).\r\n2. copy a file into an owncloud synced directory.\r\n\r\n### server configuration\r\noperating system: freebsd 9.1\r\n\r\nweb server: nginx 1.4.2\r\n\r\ndatabase: postgresql 9.3\r\n\r\nphp version: 5.4.17\r\n\r\nowncloud version: 5.0.10\r\n\r\n### logs\r\n\r\n#### owncloud log (data/owncloud.log)\r\n```\r\n{\"app\":\"php\",\"message\":\"filesize(): stat failed for \\/home\\/www\\/owncloud\\/data\\/r\\/files\\/clientsync\\/dummy.pdf at \\/usr\\/local\\/www\\/owncloud\\/lib\\/files\\/storage\\/local.php#74\",\"level\":2,\"time\":\"2013-08-14t08:26:08+00:00\"}\r\n{\"app\":\"hook\",\"message\":\"error while running hook (\\\\oc\\\\files\\\\cache\\\\updater::writehook): sqlstate[23502]: not null violation: 7 error:  null value in column \\\"unencrypted_size\\\" violates not-null constraint\\ndetail:  failing row contains (1315, 2, files\\/clientsync\\/dummy.pdf, 8bdf3089ece69c0945ba725162dc228f, 685, dummy.pdf, 10, 9, 497912, 1376468768, 0, null, 520b3f209e422).\",\"level\":3,\"time\":\"2013-08-14t08:26:08+00:00\"}\r\n{\"app\":\"hook\",\"message\":\"error while running hook (\\\\oc\\\\files\\\\cache\\\\shared_updater::writehook): sqlstate[23502]: not null violation: 7 error:  null value in column \\\"unencrypted_size\\\" violates not-null constraint\\ndetail:  failing row contains (1316, 2, files\\/clientsync\\/dummy.pdf, 8bdf3089ece69c0945ba725162dc228f, 685, dummy.pdf, 10, 9, 497912, 1376468768, 0, null, 520b3f20a8019).\",\"level\":3,\"time\":\"2013-08-14t08:26:08+00:00\"}\r\n```\r\n\r\n#### browser log\r\n\r\n(no browser involved)","closed_by":{"login":"kabum","id":245432,"avatar_url":"https://gravatar.com/avatar/a1dea19f88f38ea0b5b5b4d19d5b3107?d=https%3a%2f%2fidenticons.github.com%2f53d8cbb3dbc087a02951dec47438ccdf.png&r=x","gravatar_id":"a1dea19f88f38ea0b5b5b4d19d5b3107","url":"https://api.github.com/users/kabum","html_url":"https://github.com/kabum","followers_url":"https://api.github.com/users/kabum/followers","following_url":"https://api.github.com/users/kabum/following{/other_user}","gists_url":"https://api.github.com/users/kabum/gists{/gist_id}","starred_url":"https://api.github.com/users/kabum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kabum/subscriptions","organizations_url":"https://api.github.com/users/kabum/orgs","repos_url":"https://api.github.com/users/kabum/repos","events_url":"https://api.github.com/users/kabum/events{/privacy}","received_events_url":"https://api.github.com/users/kabum/received_events","type":"user","site_admin":false}}