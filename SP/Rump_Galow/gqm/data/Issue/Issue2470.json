{"url":"https://api.github.com/repos/owncloud/core/issues/2470","labels_url":"https://api.github.com/repos/owncloud/core/issues/2470/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/2470/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/2470/events","html_url":"https://github.com/owncloud/core/issues/2470","id":12215968,"number":2470,"title":"git repositories within owncloud results in broken repository","user":{"login":"map7","id":8230,"avatar_url":"https://gravatar.com/avatar/d58a042e02e02b72aa35e3e1181a7a6f?d=https%3a%2f%2fidenticons.github.com%2fbd4a6d0563e0604510989eb8f9ff71f5.png&r=x","gravatar_id":"d58a042e02e02b72aa35e3e1181a7a6f","url":"https://api.github.com/users/map7","html_url":"https://github.com/map7","followers_url":"https://api.github.com/users/map7/followers","following_url":"https://api.github.com/users/map7/following{/other_user}","gists_url":"https://api.github.com/users/map7/gists{/gist_id}","starred_url":"https://api.github.com/users/map7/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/map7/subscriptions","organizations_url":"https://api.github.com/users/map7/orgs","repos_url":"https://api.github.com/users/map7/repos","events_url":"https://api.github.com/users/map7/events{/privacy}","received_events_url":"https://api.github.com/users/map7/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/app%3afiles","name":"app:files","color":"02d7e1"},{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":5,"created_at":"2013-03-20t07:37:44z","updated_at":"2013-08-06t23:19:49z","closed_at":"2013-08-06t23:19:49z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"my server runs owncloud 5.0 stable on ubuntu 12.04 64bit, under nginx.\r\n\r\ni've been storing some of my projects in my owncloud and these projects have a git repository. sometimes just after syncing owncloud deletes some of the object files which git relies on and it corrupts my projects git repository. it's happened to 4 projects now. some i've been able to recover from backups and copy the missing objects across others though and lost.\r\n\r\ni've reenacted the problem once (couldn’t do it again though). here is how i reenacted the issue:\r\nmkdir testgit\r\ngit init\r\ntouch foo\r\ng a .\r\ng ca -m 'initial commit'\r\ng co -b test\r\necho ‘hi’ > foo\r\ng ca -m 'testing1'\r\ntouch test\r\ng a .\r\ng ca -m 'testing2'\r\n\r\nwait a while (about 5 minutes) till owncloud syncs a few times and owncloud will report that it deleted a file from the .git/objects directory which in turn corrupts the repository.\r\ng fsck\r\nchecking object directories: 100% (256/256), done.\r\nerror: 7ed1ed842e7898c9e45360b5795cf924a05ef810: invalid sha1 pointer in cache-tree\r\nbroken link from  commit f006f4a611b6ea4ecdf2046f3f8c95ffb4b3691d\r\n             to    tree 7ed1ed842e7898c9e45360b5795cf924a05ef810\r\nmissing tree 7ed1ed842e7898c9e45360b5795cf924a05ef810\r\n\r\n","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}