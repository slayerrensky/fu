{"url":"https://api.github.com/repos/owncloud/core/issues/1152","labels_url":"https://api.github.com/repos/owncloud/core/issues/1152/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1152/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1152/events","html_url":"https://github.com/owncloud/core/issues/1152","id":9882061,"number":1152,"title":"oc_fscache lets negative numbers into mtime field, breaks syncing","user":{"login":"matthewbloch","id":1886531,"avatar_url":"https://gravatar.com/avatar/aaf0b825da5091450da43cef1c4c5a4f?d=https%3a%2f%2fidenticons.github.com%2fe9370a5e99cb50221f18853fefaca771.png&r=x","gravatar_id":"aaf0b825da5091450da43cef1c4c5a4f","url":"https://api.github.com/users/matthewbloch","html_url":"https://github.com/matthewbloch","followers_url":"https://api.github.com/users/matthewbloch/followers","following_url":"https://api.github.com/users/matthewbloch/following{/other_user}","gists_url":"https://api.github.com/users/matthewbloch/gists{/gist_id}","starred_url":"https://api.github.com/users/matthewbloch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matthewbloch/subscriptions","organizations_url":"https://api.github.com/users/matthewbloch/orgs","repos_url":"https://api.github.com/users/matthewbloch/repos","events_url":"https://api.github.com/users/matthewbloch/events{/privacy}","received_events_url":"https://api.github.com/users/matthewbloch/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":2,"created_at":"2013-01-11t14:51:41z","updated_at":"2013-08-05t12:45:53z","closed_at":"2013-08-05t12:45:53z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"i found this in my oc_fscache table:\r\n\r\n    mysql> select * from oc_fscache  where mtime < 0;\r\n    +------+-----------------------------------------------------------------------------------------------+----------------------------------+--------+---------------------+--------+------+------------+-------------+----------------------+----------+-----------+-----------+----------+\r\n    | id   | path                                                                                          | path_hash                        | parent | name                | user   | size | ctime      | mtime       | mimetype             | mimepart | encrypted | versioned | writable |\r\n    +------+-----------------------------------------------------------------------------------------------+----------------------------------+--------+---------------------+--------+------+------------+-------------+----------------------+----------+-----------+-----------+----------+\r\n    | 2653 | /mbloch/files/design/2011/flyers and folder 2011 artwork/flyers 2011 artwork/bigv_2011 folder | 21b78af382bbabddcbe85d06b86aff11 |   2608 | bigv_2011 folder    | mbloch |    0 | 1357838953 | -1726425422 | httpd/unix-directory | httpd    |         0 |         0 |        1 |\r\n    | 2663 | /mbloch/files/design/deliveries                                                               | de4cdd69da1226c02e16628b661a0a6d |      8 | deliveries          | mbloch |    0 | 1357838967 | -1726430953 | httpd/unix-directory | httpd    |         0 |         0 |        1 |\r\n    | 2676 | /mbloch/files/design/2011/flyers and folder 2011 artwork/folder 2011 artwork                  | bb8808f40ef37b761b534bbb40b9bcb7 |   2607 | folder 2011 artwork | mbloch |    0 | 1357838947 | -1726425205 | httpd/unix-directory | httpd    |         0 |         0 |        1 |\r\n    +------+-----------------------------------------------------------------------------------------------+----------------------------------+--------+---------------------+--------+------+------------+-------------+----------------------+----------+-----------+-----------+----------+\r\n    3 rows in set (0.00 sec)\r\n\r\nthe negative mtimes were causing the webdav implementation to throw 500s as php couldn't turn them into sensible dates, so my top level \"design\" stopped syncing. i fixed it with:\r\n\r\n    update oc_fscache set mtime=ctime where mtime<0;\r\n\r\nwhich i suspect might cause some unnecessary syncing. but i'm not sure those negative numbers should have been allowed into that table in the first place.","closed_by":{"login":"jancborchardt","id":925062,"avatar_url":"https://gravatar.com/avatar/2fd3f4d5d762955e5b603794a888fa97?d=https%3a%2f%2fidenticons.github.com%2f84ec51f9ceed468217d4e13abf78da9c.png&r=x","gravatar_id":"2fd3f4d5d762955e5b603794a888fa97","url":"https://api.github.com/users/jancborchardt","html_url":"https://github.com/jancborchardt","followers_url":"https://api.github.com/users/jancborchardt/followers","following_url":"https://api.github.com/users/jancborchardt/following{/other_user}","gists_url":"https://api.github.com/users/jancborchardt/gists{/gist_id}","starred_url":"https://api.github.com/users/jancborchardt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jancborchardt/subscriptions","organizations_url":"https://api.github.com/users/jancborchardt/orgs","repos_url":"https://api.github.com/users/jancborchardt/repos","events_url":"https://api.github.com/users/jancborchardt/events{/privacy}","received_events_url":"https://api.github.com/users/jancborchardt/received_events","type":"user","site_admin":false}}