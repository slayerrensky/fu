{"url":"https://api.github.com/repos/owncloud/core/issues/5003","labels_url":"https://api.github.com/repos/owncloud/core/issues/5003/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/5003/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/5003/events","html_url":"https://github.com/owncloud/core/issues/5003","id":20117239,"number":5003,"title":"upgrade script ignores failing ","user":{"login":"felixboehm","id":1204907,"avatar_url":"https://gravatar.com/avatar/99f44dd330a12e4184d1bee93a9838f8?d=https%3a%2f%2fidenticons.github.com%2f77345359f698ffa32e579578be64fdc6.png&r=x","gravatar_id":"99f44dd330a12e4184d1bee93a9838f8","url":"https://api.github.com/users/felixboehm","html_url":"https://github.com/felixboehm","followers_url":"https://api.github.com/users/felixboehm/followers","following_url":"https://api.github.com/users/felixboehm/following{/other_user}","gists_url":"https://api.github.com/users/felixboehm/gists{/gist_id}","starred_url":"https://api.github.com/users/felixboehm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixboehm/subscriptions","organizations_url":"https://api.github.com/users/felixboehm/orgs","repos_url":"https://api.github.com/users/felixboehm/repos","events_url":"https://api.github.com/users/felixboehm/events{/privacy}","received_events_url":"https://api.github.com/users/felixboehm/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"open","assignee":null,"milestone":null,"comments":4,"created_at":"2013-09-26t15:34:37z","updated_at":"2013-11-15t11:11:03z","closed_at":null,"pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"while testing some index setups for faster updates i made mistakes leading to an error during the update. but the upgrade script just ignored that there were errors and completed with \"update successful\".\r\nafter fixing the error i couldn't update anymore, as even the version number was changed to the new version. \r\n\r\nthe behavior should be: \r\nif an error is occurring during update, the update must be failing.\r\nthe version number may not be updated until the update is successful.\r\nbest error handling: the update changes should be reverted, if possible.\r\n\r\nconsole output from the update\r\n> php upgrade.php \r\nturned on maintenance mode\r\nfailed to update database structure (mdb2 error: unknown error, _doquery: [error message: could not execute statement]\r\n[last executed query: create index `properties_userid_path_name_index` on `oc_properties` (`userid`, `propertypath`, `propertyname`)]\r\n[native code: 1071]\r\n[native message: specified key was too long; max key length is 1000 bytes]\r\n)\r\nturned off maintenance mode\r\nupdate successful\r\n\r\nsystem infos:\r\ndebian, mysql\r\nupdate from 5.0.9 to 5.0.11\r\n","closed_by":null}