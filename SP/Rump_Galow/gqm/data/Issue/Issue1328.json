{"url":"https://api.github.com/repos/owncloud/core/issues/1328","labels_url":"https://api.github.com/repos/owncloud/core/issues/1328/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/1328/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/1328/events","html_url":"https://github.com/owncloud/core/issues/1328","id":10348715,"number":1328,"title":"owncloud doesn't recognize http accept-language header case-insensitively","user":{"login":"pellaeon","id":916913,"avatar_url":"https://gravatar.com/avatar/883be3137cf256de269737722f2ee350?d=https%3a%2f%2fidenticons.github.com%2f017d713d54115b5e2eaf9b3107c54e25.png&r=x","gravatar_id":"883be3137cf256de269737722f2ee350","url":"https://api.github.com/users/pellaeon","html_url":"https://github.com/pellaeon","followers_url":"https://api.github.com/users/pellaeon/followers","following_url":"https://api.github.com/users/pellaeon/following{/other_user}","gists_url":"https://api.github.com/users/pellaeon/gists{/gist_id}","starred_url":"https://api.github.com/users/pellaeon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pellaeon/subscriptions","organizations_url":"https://api.github.com/users/pellaeon/orgs","repos_url":"https://api.github.com/users/pellaeon/repos","events_url":"https://api.github.com/users/pellaeon/events{/privacy}","received_events_url":"https://api.github.com/users/pellaeon/received_events","type":"user","site_admin":false},"labels":[{"url":"https://api.github.com/repos/owncloud/core/labels/5+-+to+review","name":"5 - to review","color":"ededed"},{"url":"https://api.github.com/repos/owncloud/core/labels/bug","name":"bug","color":"fc2929"}],"state":"closed","assignee":null,"milestone":null,"comments":4,"created_at":"2013-01-27t05:39:37z","updated_at":"2013-08-27t15:51:31z","closed_at":"2013-01-31t21:38:06z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"![ _002](https://f.cloud.github.com/assets/916913/96414/90f5462a-66aa-11e2-9bc3-4243923ba920.png)\r\nin the screenshot to the right is the owncloud setup page, to the left is firefox's preferred language settings window, in which i have set zh_tw as top preferred language.\r\ni confirmed the zh_tw tralslation string exists in l10n/zh_tw/core.po#306, which is `msgstr \"å»ºç«‹ä¸€å€‹<strong>ç®¡ç?†è€…å¸³è™ÿ</strong>\"`, but the translation string owncloud used was l10n/zh_cn.gb2312/core.po#306 `msgstr \"å»ºç«‹ä¸€ä¸ª <strong>ç®¡ç?†å¸?æˆ·</strong>\"`.\r\n\r\na deeper analysis i found that firefox 18 sends this http header:\r\n`accept-language: zh-tw,zh;q=0.8,en-us;q=0.5,en;q=0.3`\r\nwhich makes owncloud displays simplified chinese (zh_cn).\r\nbut chromium 23 sends this header:\r\n`accept-language: zh-tw,zh;q=0.8,en-us;q=0.6,en;q=0.4`\r\nowncloud correctly displays traditional chinese (zh_tw)\r\n\r\nin firefox's case, i guess owncloud didn't recognize `zh-tw` and instead fallbacked to `zh`.\r\n\r\nfor more information, according to [rfc2616 section 3.10](http://www.w3.org/protocols/rfc2616/rfc2616-sec3.html#sec3.10), the language tag should be case-insensitive.\r\n\r\ni am working on a patch based on [this implementation](http://php.net/manual/en/reserved.variables.server.php#94237).","closed_by":{"login":"emerzh","id":177003,"avatar_url":"https://gravatar.com/avatar/8be57cd98b8864ebcc903ae7106ea420?d=https%3a%2f%2fidenticons.github.com%2f35789e0e5e2d4b3b73630bb168f26d12.png&r=x","gravatar_id":"8be57cd98b8864ebcc903ae7106ea420","url":"https://api.github.com/users/emerzh","html_url":"https://github.com/emerzh","followers_url":"https://api.github.com/users/emerzh/followers","following_url":"https://api.github.com/users/emerzh/following{/other_user}","gists_url":"https://api.github.com/users/emerzh/gists{/gist_id}","starred_url":"https://api.github.com/users/emerzh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emerzh/subscriptions","organizations_url":"https://api.github.com/users/emerzh/orgs","repos_url":"https://api.github.com/users/emerzh/repos","events_url":"https://api.github.com/users/emerzh/events{/privacy}","received_events_url":"https://api.github.com/users/emerzh/received_events","type":"user","site_admin":false}}