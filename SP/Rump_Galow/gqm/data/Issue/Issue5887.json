{"url":"https://api.github.com/repos/owncloud/core/issues/5887","labels_url":"https://api.github.com/repos/owncloud/core/issues/5887/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/5887/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/5887/events","html_url":"https://github.com/owncloud/core/issues/5887","id":22728982,"number":5887,"title":"improve backup/restore documentation","user":{"login":"frafra","id":4068,"avatar_url":"https://gravatar.com/avatar/f6fa1011b95c01b7fa795cba3e1e41ae?d=https%3a%2f%2fidenticons.github.com%2f23755432da68528f115c9633c0d7834f.png&r=x","gravatar_id":"f6fa1011b95c01b7fa795cba3e1e41ae","url":"https://api.github.com/users/frafra","html_url":"https://github.com/frafra","followers_url":"https://api.github.com/users/frafra/followers","following_url":"https://api.github.com/users/frafra/following{/other_user}","gists_url":"https://api.github.com/users/frafra/gists{/gist_id}","starred_url":"https://api.github.com/users/frafra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frafra/subscriptions","organizations_url":"https://api.github.com/users/frafra/orgs","repos_url":"https://api.github.com/users/frafra/repos","events_url":"https://api.github.com/users/frafra/events{/privacy}","received_events_url":"https://api.github.com/users/frafra/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":1,"created_at":"2013-11-15t12:15:12z","updated_at":"2013-11-19t13:39:47z","closed_at":"2013-11-19t13:39:47z","pull_request":{"html_url":null,"diff_url":null,"patch_url":null},"body":"owncloud documentation explains how to do a database backup, but not how to restore it.\r\ni had some troubles upgrading owncloud, so i tried to do restore everything and try another time and i fixed my problem only when i deleted and recreated my database. restoring using the output from the backup procedure isn't enough, because the database table could have new data.\r\n\r\ni figured out a simple solution for postgresql: change `pg_dump owncloud > owncloud.bak` to `pg_dump owncloud --clean -f owncloud.bak`. `--clean` generates instructions in order to remove previous data before repopulating everything. probably there is a similar option for others databases, but i don't know it. this is the page with the command: http://doc.owncloud.org/server/6.0/admin_manual/maintenance/backup.html\r\n\r\nthere is another option: add more information for restoring backups. in this page is explained how to generate database backups but not how to restore them: http://doc.owncloud.org/server/6.0/admin_manual/maintenance/backup.html\r\n\r\npersonally i also found something strange in the structure of documentation: http://doc.owncloud.org/server/6.0/admin_manual/maintenance/index.html\r\n\r\nthere are 3 pages in this order: \r\n1. migrating owncloud installations\r\n2. updating owncloud\r\n3. backing up owncloud\r\n\r\nin my opinion the order should be reversed:\r\n1. backing up owncloud\r\n2. updating owncloud\r\n3. migrating owncloud installations\r\n\r\nthose pages have different description for similar tasks. i propose a new structure:\r\n1. backing up owncloud (before doing anything you should execute this task)\r\n2. updating owncloud (have you executed task 1 before doing this?)\r\n3. restoring owncloud (something went wrong?)\r\n4. migrating owncloud installations (little appendix: just saying that you should execute tast 1 and task 3)\r\n\r\ni propose to merge the two different updating/upgrading procedures under \"updating owncloud\", just adding a single note: if you're doing a major upgrade, deactivate all third party application before doing this. if you don't like this proposal, we could just have a \"upgrading\" part and a little information box on top of the page saying: \"if you are doing a minor upgrade, you could use owncloud application 'updater' to perform this task'.\r\n\r\nit would be nice to have some commands to help people to execute this task. under \"upgrade\", step 4, \"delete everything from your owncloud installation directory, except data and config\", a possible option is to suggest to execute:\r\n```ls|grep -v '\\(data\\)\\|\\(config\\)'|xargs rm -rf```\r\n\r\nlook at \"upgrade\", step 6, \"make sure that the file permissions are correct.\": the user or admin could be \"how?\" and it could just skip this step. if this point is important, and i don't think it is if in owncloud documentation there's no other option except using wget to download a .tar.gz2 archive, it would be nice to specify how it could be done and saying a couple of words on how to fix possible problems.\r\n\r\nif we could provide better information and command to execute, there will be fewer chances to do mistakes and report useless bug reports.","closed_by":{"login":"frafra","id":4068,"avatar_url":"https://gravatar.com/avatar/f6fa1011b95c01b7fa795cba3e1e41ae?d=https%3a%2f%2fidenticons.github.com%2f23755432da68528f115c9633c0d7834f.png&r=x","gravatar_id":"f6fa1011b95c01b7fa795cba3e1e41ae","url":"https://api.github.com/users/frafra","html_url":"https://github.com/frafra","followers_url":"https://api.github.com/users/frafra/followers","following_url":"https://api.github.com/users/frafra/following{/other_user}","gists_url":"https://api.github.com/users/frafra/gists{/gist_id}","starred_url":"https://api.github.com/users/frafra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frafra/subscriptions","organizations_url":"https://api.github.com/users/frafra/orgs","repos_url":"https://api.github.com/users/frafra/repos","events_url":"https://api.github.com/users/frafra/events{/privacy}","received_events_url":"https://api.github.com/users/frafra/received_events","type":"user","site_admin":false}}