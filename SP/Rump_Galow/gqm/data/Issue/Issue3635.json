{"url":"https://api.github.com/repos/owncloud/core/issues/3635","labels_url":"https://api.github.com/repos/owncloud/core/issues/3635/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3635/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3635/events","html_url":"https://github.com/owncloud/core/pull/3635","id":15278863,"number":3635,"title":"give apps the option to wrap storage backends","user":{"login":"icewind1991","id":1283854,"avatar_url":"https://gravatar.com/avatar/7c20f90ca5df67dd2cad22a8e2f80d8f?d=https%3a%2f%2fidenticons.github.com%2fc818423776eba38604496a7caddc0251.png&r=x","gravatar_id":"7c20f90ca5df67dd2cad22a8e2f80d8f","url":"https://api.github.com/users/icewind1991","html_url":"https://github.com/icewind1991","followers_url":"https://api.github.com/users/icewind1991/followers","following_url":"https://api.github.com/users/icewind1991/following{/other_user}","gists_url":"https://api.github.com/users/icewind1991/gists{/gist_id}","starred_url":"https://api.github.com/users/icewind1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icewind1991/subscriptions","organizations_url":"https://api.github.com/users/icewind1991/orgs","repos_url":"https://api.github.com/users/icewind1991/repos","events_url":"https://api.github.com/users/icewind1991/events{/privacy}","received_events_url":"https://api.github.com/users/icewind1991/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":10,"created_at":"2013-06-07t15:58:43z","updated_at":"2013-07-22t12:14:18z","closed_at":"2013-06-29t11:00:04z","pull_request":{"html_url":"https://github.com/owncloud/core/pull/3635","diff_url":"https://github.com/owncloud/core/pull/3635.diff","patch_url":"https://github.com/owncloud/core/pull/3635.patch"},"body":"this gives apps the option to modify behavior of storage backends and serves as replacement for the fileproxy system currently in use by encryption and quota.\r\n\r\nthis gives more control to the apps to modify filesystem behavior and is cleaner in the implementation then the proxy system. and allow control over what storage is effected, i.e. encryption could be configured to only encrypt the root storage for each user and leave the mounted smb share alone.\r\n\r\nand example (pseudocode) implementation for encryption would be something like:\r\n\r\n    class encryptionwrapper extends wrapper{\r\n        public function file_put_contents($path, $data){\r\n            $data=encryptdata($data);\r\n            $this->storage->file_put_contents($path, $data);\r\n        }\r\n    }\r\n\r\n    \\oc\\files\\filesystem::getloader()->addstoragewrapper(function($mountpoint, $storage){\r\n        if (storageshouldbeencrypted($mountpoint, $storage) {\r\n            return new wrapper(array('storage' => $storage));\r\n        } else {\r\n            return $storage;\r\n        }\r\n    })\r\n\r\nthe quota stuff will be moved to the system in a different pr and i plan to remove the old proxy system in the future.\r\n\r\n@florinpeter @schiesbn this affects the integration of encryption in the filesystem\r\n\r\n@schiesbn this might also be usable for a better way of handeling the trashbin (overwriting the unlink/rmdir behaviour)\r\n\r\ncc @karlitschek @mtgap @deepdiver1975 ","closed_by":{"login":"bartv2","id":2227877,"avatar_url":"https://gravatar.com/avatar/c2d86a0a66a4be2c904e24034e842f44?d=https%3a%2f%2fidenticons.github.com%2f05e8b1362feb118a386dfd282b20fb84.png&r=x","gravatar_id":"c2d86a0a66a4be2c904e24034e842f44","url":"https://api.github.com/users/bartv2","html_url":"https://github.com/bartv2","followers_url":"https://api.github.com/users/bartv2/followers","following_url":"https://api.github.com/users/bartv2/following{/other_user}","gists_url":"https://api.github.com/users/bartv2/gists{/gist_id}","starred_url":"https://api.github.com/users/bartv2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bartv2/subscriptions","organizations_url":"https://api.github.com/users/bartv2/orgs","repos_url":"https://api.github.com/users/bartv2/repos","events_url":"https://api.github.com/users/bartv2/events{/privacy}","received_events_url":"https://api.github.com/users/bartv2/received_events","type":"user","site_admin":false}}