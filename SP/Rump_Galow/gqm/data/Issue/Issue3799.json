{"url":"https://api.github.com/repos/owncloud/core/issues/3799","labels_url":"https://api.github.com/repos/owncloud/core/issues/3799/labels{/name}","comments_url":"https://api.github.com/repos/owncloud/core/issues/3799/comments","events_url":"https://api.github.com/repos/owncloud/core/issues/3799/events","html_url":"https://github.com/owncloud/core/pull/3799","id":15800885,"number":3799,"title":"fix pdo statement wrapper numrows on modification","user":{"login":"butonic","id":956847,"avatar_url":"https://gravatar.com/avatar/9760c134cabf66e10dbba06d7525f5c7?d=https%3a%2f%2fidenticons.github.com%2f92925ec1ad893739ed57986f18e2f060.png&r=x","gravatar_id":"9760c134cabf66e10dbba06d7525f5c7","url":"https://api.github.com/users/butonic","html_url":"https://github.com/butonic","followers_url":"https://api.github.com/users/butonic/followers","following_url":"https://api.github.com/users/butonic/following{/other_user}","gists_url":"https://api.github.com/users/butonic/gists{/gist_id}","starred_url":"https://api.github.com/users/butonic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/butonic/subscriptions","organizations_url":"https://api.github.com/users/butonic/orgs","repos_url":"https://api.github.com/users/butonic/repos","events_url":"https://api.github.com/users/butonic/events{/privacy}","received_events_url":"https://api.github.com/users/butonic/received_events","type":"user","site_admin":false},"labels":[],"state":"closed","assignee":null,"milestone":null,"comments":7,"created_at":"2013-06-20t13:52:52z","updated_at":"2013-06-28t14:22:25z","closed_at":"2013-06-28t14:15:38z","pull_request":{"html_url":"https://github.com/owncloud/core/pull/3799","diff_url":"https://github.com/owncloud/core/pull/3799.diff","patch_url":"https://github.com/owncloud/core/pull/3799.patch"},"body":"this pr supersedes https://github.com/owncloud/core/pull/3780 by implementing the result/numrows behaviour as found in mdb2 and doctrine. executing a select statement returns a result object as usual. executing an insert, update or  delete statement returns the number of affected rows.\r\n\r\nfor this to work the mdb2 connection needs to be told the type of query when preparing a statement. the pdo statment wrapper needs to be told the type of query to choose the correct return type.\r\n\r\nthe type of statement will be guessed by inspecting the first 10 characters of the statement. this works for all current statements in owncloud. should it become necessary to override this guess the type of statement can be toggled by specyfying the new fourth parameter of `oc_db::prepare( $query , $limit = null, $offset = null, $ismanipulation = null)`\r\n\r\ntested on sqlite and mysql, oracle still has problems, but they i'll solve them in a different pr. first let's see what ci has to say about it.\r\n\r\n@blizzz touched your user_ldap, please review\r\n@schiesbn touched files_encryption (to supersede https://github.com/owncloud/core/pull/3780), please review\r\n@tanghus touched vcategories, please review\r\n@deepdiver1975 touched the testsuite, please review\r\n@mtgap @icewind1991 @bartv2 @karlitschek touched the db core pdo wrapper, pls have look\r\nsomeone have a look at the sabre dav locking that this touches, maybe @jakobsack ","closed_by":{"login":"bartv2","id":2227877,"avatar_url":"https://gravatar.com/avatar/c2d86a0a66a4be2c904e24034e842f44?d=https%3a%2f%2fidenticons.github.com%2f05e8b1362feb118a386dfd282b20fb84.png&r=x","gravatar_id":"c2d86a0a66a4be2c904e24034e842f44","url":"https://api.github.com/users/bartv2","html_url":"https://github.com/bartv2","followers_url":"https://api.github.com/users/bartv2/followers","following_url":"https://api.github.com/users/bartv2/following{/other_user}","gists_url":"https://api.github.com/users/bartv2/gists{/gist_id}","starred_url":"https://api.github.com/users/bartv2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bartv2/subscriptions","organizations_url":"https://api.github.com/users/bartv2/orgs","repos_url":"https://api.github.com/users/bartv2/repos","events_url":"https://api.github.com/users/bartv2/events{/privacy}","received_events_url":"https://api.github.com/users/bartv2/received_events","type":"user","site_admin":false}}