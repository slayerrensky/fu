[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28186785","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28186785","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28186785,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t10:08:03z","updated_at":"2013-11-11t10:08:03z","body":"this seems to happen in the method \"writehostkey()\"\r\n@hkjolhede @takuto88 not sure why cron.php needs to call sftp.php ?\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28234829","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28234829","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28234829,"user":{"login":"hkjolhede","id":3122741,"avatar_url":"https://gravatar.com/avatar/69916c92212563e9a72f1a92996392c8?d=https%3a%2f%2fidenticons.github.com%2f33389e45c4b86fbad02304ff279f0328.png&r=x","gravatar_id":"69916c92212563e9a72f1a92996392c8","url":"https://api.github.com/users/hkjolhede","html_url":"https://github.com/hkjolhede","followers_url":"https://api.github.com/users/hkjolhede/followers","following_url":"https://api.github.com/users/hkjolhede/following{/other_user}","gists_url":"https://api.github.com/users/hkjolhede/gists{/gist_id}","starred_url":"https://api.github.com/users/hkjolhede/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hkjolhede/subscriptions","organizations_url":"https://api.github.com/users/hkjolhede/orgs","repos_url":"https://api.github.com/users/hkjolhede/repos","events_url":"https://api.github.com/users/hkjolhede/events{/privacy}","received_events_url":"https://api.github.com/users/hkjolhede/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t20:18:17z","updated_at":"2013-11-11t21:30:53z","body":"two points:\r\n\r\n1. there is a bug in the function host_keys_path(), which shouldn't really contain a try-catch clause but should instead let a raised exception propagate, and should raise an exception if $storage_view is null.\r\n\r\n2. i don't currently have a functioning and debuggable installation of owncloud, so i am unsure why host_keys_path() fail to provide a correct path when cron.php is run. anyone?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28283393","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28283393","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28283393,"user":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"created_at":"2013-11-12t10:39:00z","updated_at":"2013-11-12t10:39:00z","body":"@pvince81  filesystem apps like external storage are loaded during cron because they might be needed.\r\n@hkjolhede perhaps something in the code relies on the apache environment variables to calculate the right path which is not set when running cron/cli. \r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28295482","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28295482","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28295482,"user":{"login":"j-ed","id":2572764,"avatar_url":"https://gravatar.com/avatar/2578b8d55efee3aa1bd7dec59d4c18c3?d=https%3a%2f%2fidenticons.github.com%2f5c998343ba958bae7db884388465bec3.png&r=x","gravatar_id":"2578b8d55efee3aa1bd7dec59d4c18c3","url":"https://api.github.com/users/j-ed","html_url":"https://github.com/j-ed","followers_url":"https://api.github.com/users/j-ed/followers","following_url":"https://api.github.com/users/j-ed/following{/other_user}","gists_url":"https://api.github.com/users/j-ed/gists{/gist_id}","starred_url":"https://api.github.com/users/j-ed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j-ed/subscriptions","organizations_url":"https://api.github.com/users/j-ed/orgs","repos_url":"https://api.github.com/users/j-ed/repos","events_url":"https://api.github.com/users/j-ed/events{/privacy}","received_events_url":"https://api.github.com/users/j-ed/received_events","type":"user","site_admin":false},"created_at":"2013-11-12t14:08:05z","updated_at":"2013-11-12t14:08:05z","body":"@hkjolhede i've just checked the return value of getstorage in the hostkeyspath function and it seems that an empty string is return when running the cron.php script. let me know if i should run further tests.\r\n\r\n```php\r\n        private function hostkeyspath() {\r\n                try {\r\n                        $storage_view = \\ocp\\files::getstorage('files_external');\r\nprint \"storage_view:$storage_view:\\n\";\r\n```\r\nresult:\r\n```\r\n# /usr/bin/php -f /var/www/htdocs/owncloud/cron.php\r\nstorage_view::\r\nstorage_view::\r\n\r\n```"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28320232","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28320232","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28320232,"user":{"login":"hkjolhede","id":3122741,"avatar_url":"https://gravatar.com/avatar/69916c92212563e9a72f1a92996392c8?d=https%3a%2f%2fidenticons.github.com%2f33389e45c4b86fbad02304ff279f0328.png&r=x","gravatar_id":"69916c92212563e9a72f1a92996392c8","url":"https://api.github.com/users/hkjolhede","html_url":"https://github.com/hkjolhede","followers_url":"https://api.github.com/users/hkjolhede/followers","following_url":"https://api.github.com/users/hkjolhede/following{/other_user}","gists_url":"https://api.github.com/users/hkjolhede/gists{/gist_id}","starred_url":"https://api.github.com/users/hkjolhede/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hkjolhede/subscriptions","organizations_url":"https://api.github.com/users/hkjolhede/orgs","repos_url":"https://api.github.com/users/hkjolhede/repos","events_url":"https://api.github.com/users/hkjolhede/events{/privacy}","received_events_url":"https://api.github.com/users/hkjolhede/received_events","type":"user","site_admin":false},"created_at":"2013-11-12t18:37:00z","updated_at":"2013-11-12t18:37:00z","body":"@j-ed do you have a log file from a cron run that you could post?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28403532","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28403532","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28403532,"user":{"login":"j-ed","id":2572764,"avatar_url":"https://gravatar.com/avatar/2578b8d55efee3aa1bd7dec59d4c18c3?d=https%3a%2f%2fidenticons.github.com%2f5c998343ba958bae7db884388465bec3.png&r=x","gravatar_id":"2578b8d55efee3aa1bd7dec59d4c18c3","url":"https://api.github.com/users/j-ed","html_url":"https://github.com/j-ed","followers_url":"https://api.github.com/users/j-ed/followers","following_url":"https://api.github.com/users/j-ed/following{/other_user}","gists_url":"https://api.github.com/users/j-ed/gists{/gist_id}","starred_url":"https://api.github.com/users/j-ed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j-ed/subscriptions","organizations_url":"https://api.github.com/users/j-ed/orgs","repos_url":"https://api.github.com/users/j-ed/repos","events_url":"https://api.github.com/users/j-ed/events{/privacy}","received_events_url":"https://api.github.com/users/j-ed/received_events","type":"user","site_admin":false},"created_at":"2013-11-13t15:27:13z","updated_at":"2013-11-13t15:27:13z","body":"log file of cron.php run:\r\n-------------------------\r\n\r\n```php\r\n{\"app\":\"core\",\"message\":\"db prepare : select `appid` from `oc_appconfig` where `configkey` = 'enabled' and `configvalue`='yes'\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `appid`, `configvalue` from `oc_appconfig` where `configkey` = 'installed_version'\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `id` from `oc_jobs` where `class` = ? and `argument` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'oc\\\\\\\\backgroundjob\\\\\\\\legacy\\\\\\\\regularjob',   1 => '[\\\"\\\\\\\\\\\\\\\\oc\\\\\\\\\\\\\\\\files\\\\\\\\\\\\\\\\cache\\\\\\\\\\\\\\\\backgroundwatcher\\\",\\\"checknext\\\"]', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `configvalue` from `oc_appconfig` where `appid` = ? and `configkey` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'shareapi_enabled', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'shareapi_enabled', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'shareapi_enabled', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'shareapi_enabled', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'shareapi_enabled', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `configvalue`, `appid` from `oc_appconfig` where `configkey` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'types', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'shareapi_enabled', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'shareapi_enabled', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'files_external',   1 => 'allow_user_mounting', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'oc\\\\\\\\backgroundjob\\\\\\\\legacy\\\\\\\\regularjob',   1 => '[\\\"oca\\\\\\\\\\\\\\\\music\\\\\\\\\\\\\\\\backgroundjob\\\\\\\\\\\\\\\\cleanup\\\",\\\"run\\\"]', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'roundcube',   1 => 'autologin', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'external',   1 => 'sites', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'oc\\\\\\\\cache\\\\\\\\fileglobalgc',   1 => 'null', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'backgroundjobs_mode', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'backgroundjobs_mode', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `id`, `class`, `last_run`, `argument` from `oc_jobs`\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : update `oc_jobs` set `last_run` = ? where `id` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 1384328864,   1 => '1', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'files',   1 => 'backgroundwatcher_previous_file', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'files',   1 => 'backgroundwatcher_previous_folder', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `fileid` from `oc_filecache` where `fileid` > ? and `mimetype` != ? order by `fileid` asc limit 1\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `id` from `oc_mimetypes` where `mimetype` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'httpd\\/unix-directory', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1635',   1 => '2', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `fileid` from `oc_filecache` where `fileid` > ? and `mimetype` = ? order by `fileid` asc limit 1\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'httpd\\/unix-directory', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1842',   1 => '2', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `configkey` from `oc_appconfig` where `appid` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'files', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : update `oc_appconfig` set `configvalue` = ? where `appid` = ? and `configkey` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1636',   1 => 'files',   2 => 'backgroundwatcher_previous_file', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'files', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1843',   1 => 'files',   2 => 'backgroundwatcher_previous_folder', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `storage`, `path` from `oc_filecache` where `fileid` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1636', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `id` from `oc_storages` where `numeric_id` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '3', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `user` from `oc_permissions` where `fileid` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1636', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select count(*) from `oc_users` where lower(`uid`) = lower(?)\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'jed', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'jed', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `displayname` from `oc_users` where `uid` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'jed', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'jed', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `numeric_id` from `oc_storages` where `id` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'local::\\/var\\/owncloud\\/data\\/jed\\/', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `gid` from `oc_groups` where `gid` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'family', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'family', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `uid` from `oc_group_user` where `gid` = ? and `uid` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'family',   1 => 'jed', )\",\"level\":0,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"can't get app storage, app files_external, user not logged in\",\"level\":3,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n{\"app\":\"core\",\"message\":\"can't get app storage, app files_external, user not logged in\",\"level\":3,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'smb::jed@my-server.privat.lan\\/\\/dateiarchiv\\/\\/mp3\\/', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `fileid`, `storage`, `path`, `parent`, `name`, `mimetype`, `mimepart`, `size`, `mtime`,\\n\\t\\t\\t\\t\\t   `storage_mtime`, `encrypted`, `unencrypted_size`, `etag`\\n\\t\\t\\t\\tfrom `oc_filecache` where `storage` = ? and `path_hash` = ?\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '3',   1 => 'b868ae6d5efb15586378b19574747c20', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select `id`, `mimetype` from `oc_mimetypes`\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1843', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '3', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '3',   1 => '3d659eaa867469974a5990dc9089cc43', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 1384328865,   1 => '2', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core',   1 => 'global_cache_gc_lastrun', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 'core', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 1384328865,   1 => 'core',   2 => 'global_cache_gc_lastrun', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => 1384328865,   1 => '7', )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : update `oc_music_albums` set `cover_file_id` = null where `cover_file_id` is not null and `cover_file_id` not in (select `fileid` from `oc_filecache`);\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : delete from `oc_music_tracks` where `file_id` not in (select `fileid` from `oc_filecache`);\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : delete from `oc_music_albums` where `id` not in (select `album_id` from `oc_music_tracks` group by `album_id`);\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : delete from `oc_music_album_artists` where `album_id` not in (select `id` from `oc_music_albums` group by `id`);\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:45+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : delete from `oc_music_artists` where `id` not in (select `artist_id` from `oc_music_album_artists` group by `artist_id`);\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : select distinct `albums`.`id`, `files`.`parent`\\n\\t\\t\\t\\tfrom `oc_music_albums` `albums`\\n\\t\\t\\t\\tjoin `oc_music_tracks` `tracks` on `albums`.`id` = `tracks`.`album_id`\\n\\t\\t\\t\\tjoin `oc_filecache` `files` on `tracks`.`file_id` = `files`.`fileid`\\n\\t\\t\\t\\twhere `albums`.`cover_file_id` is null;\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array ( )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db prepare : update `oc_music_albums`\\n\\t\\t\\t\\tset `cover_file_id` = (\\n\\t\\t\\t\\t\\tselect `fileid`\\n\\t\\t\\t\\t\\tfrom `oc_filecache`\\n\\t\\t\\t\\t\\tjoin `oc_mimetypes` on `oc_mimetypes`.`id` = `oc_filecache`.`mimetype`\\n\\t\\t\\t\\t\\twhere `parent` = ? and `oc_mimetypes`.`mimetype` like \\\"image%\\\" limit 1\\n\\t\\t\\t\\t) where `id` = ?;\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '75',   1 => '1', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '75',   1 => '2', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '75',   1 => '3', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '75',   1 => '4', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '105',   1 => '6', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '318',   1 => '13', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '286',   1 => '54', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1578',   1 => '83', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1797',   1 => '97', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '2718',   1 => '97', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '254',   1 => '98', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '254',   1 => '99', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '254',   1 => '100', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '1817',   1 => '102', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n{\"app\":\"core\",\"message\":\"db execute with arguments : array (   0 => '4340',   1 => '252', )\",\"level\":0,\"time\":\"2013-11-13 08:47:46+01:00\"}\r\n```\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28409819","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28409819","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28409819,"user":{"login":"hkjolhede","id":3122741,"avatar_url":"https://gravatar.com/avatar/69916c92212563e9a72f1a92996392c8?d=https%3a%2f%2fidenticons.github.com%2f33389e45c4b86fbad02304ff279f0328.png&r=x","gravatar_id":"69916c92212563e9a72f1a92996392c8","url":"https://api.github.com/users/hkjolhede","html_url":"https://github.com/hkjolhede","followers_url":"https://api.github.com/users/hkjolhede/followers","following_url":"https://api.github.com/users/hkjolhede/following{/other_user}","gists_url":"https://api.github.com/users/hkjolhede/gists{/gist_id}","starred_url":"https://api.github.com/users/hkjolhede/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hkjolhede/subscriptions","organizations_url":"https://api.github.com/users/hkjolhede/orgs","repos_url":"https://api.github.com/users/hkjolhede/repos","events_url":"https://api.github.com/users/hkjolhede/events{/privacy}","received_events_url":"https://api.github.com/users/hkjolhede/received_events","type":"user","site_admin":false},"created_at":"2013-11-13t16:33:32z","updated_at":"2013-11-13t16:33:32z","body":"as far as i understand it the problem is that cron.php can't get the app storage because the user is not logged in, as per the line:\r\n\r\n\"app\":\"core\",\"message\":\"can't get app storage, app files_external, user not logged in\",\"level\":3,\"time\":\"2013-11-13 08:47:44+01:00\"}\r\n\r\ni'm not entirely sure which background job is requesting access. \r\n\r\nthere is a coding error (as stated in an earlier comment) that i intend to fix and create a pull request for, but in a wider perspective is the fact that app storage not being available for cron jobs a desirable status? @karlitschek @pvince81 \r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28625706","html_url":"https://github.com/owncloud/core/issues/5675#issuecomment-28625706","issue_url":"https://api.github.com/repos/owncloud/core/issues/5675","id":28625706,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-16t12:35:13z","updated_at":"2013-11-16t12:35:13z","body":"for the storage availability i don't know. @icewind1991 ?\r\ni guess if we assume that cron job are running for all users, then they should have access to user's storages."}]