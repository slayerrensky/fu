[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30049007","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30049007","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30049007,"user":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"created_at":"2013-12-07t06:28:03z","updated_at":"2013-12-07t06:28:03z","body":"@schiesbn what do you think?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30053081","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30053081","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30053081,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-12-07t11:30:16z","updated_at":"2013-12-07t11:30:16z","body":"works for me in oc 6 rc 4 with the same steps and the 1.5.0beta1 linux desktop client.\r\n\r\nis this a new install or a migrated system @boran ?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30058368","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30058368","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30058368,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-12-07t16:21:47z","updated_at":"2013-12-07t16:27:05z","body":"like @pvince81 i can't reproduce it, i tried it with the sync client 1.4.2 on gnu/linux.\r\n\r\n@boran can you also tell use something about your server? which os, which webserver, php version,..."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30058465","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30058465","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30058465,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-12-07t16:26:34z","updated_at":"2013-12-07t16:26:34z","body":"@baron on your second try. please check following. after you created the file in the webui, you can read the file again, right?\r\n\r\nso at this point following keyfiles should exist:\r\n\r\n- ```/user/files_encryption/keyfiles/<filename>.key```\r\n- ```/user/files_encryption/share-keys/<filename>.<user>.sharekey```\r\n\r\nthan start the sync client and wait until the file was downloaded successfully. check the keyfiles again. does they still exists?\r\n\r\nnow modify and wait until the client tried to upload the file. check the keyfiles again. does they still exist?\r\n\r\nit sounds like at some point you lose the keyfiles..."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30067537","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30067537","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30067537,"user":{"login":"boran","id":405059,"avatar_url":"https://gravatar.com/avatar/a4e38a8bd7ae80f8043047000fd90ed4?d=https%3a%2f%2fidenticons.github.com%2faf5e92b644cc02723846a2d99d7c6357.png&r=x","gravatar_id":"a4e38a8bd7ae80f8043047000fd90ed4","url":"https://api.github.com/users/boran","html_url":"https://github.com/boran","followers_url":"https://api.github.com/users/boran/followers","following_url":"https://api.github.com/users/boran/following{/other_user}","gists_url":"https://api.github.com/users/boran/gists{/gist_id}","starred_url":"https://api.github.com/users/boran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/boran/subscriptions","organizations_url":"https://api.github.com/users/boran/orgs","repos_url":"https://api.github.com/users/boran/repos","events_url":"https://api.github.com/users/boran/events{/privacy}","received_events_url":"https://api.github.com/users/boran/received_events","type":"user","site_admin":false},"created_at":"2013-12-07t22:58:48z","updated_at":"2013-12-07t22:58:48z","body":"so by the sound of things its something that only affected me?\r\ni'm using ubuntu 12.04, with standard ubuntu packages, such as mysql.\r\n\r\nyes, it was a fresh install, but i'll run though the process from scratch\r\nnow again, to be sure. the detailed log of what i did is below, but to\r\nsummarise, *i can no longer reproduce the issue* - its works just fine.\r\n\r\nthis is good news in one way, but bad in the sense that there was an issue,\r\nbut i can't reproduce it again. i should have been more rigorous in noting\r\nthe test sequence the first time perhaps (perhaps i connected via the\r\nwindows client before encryption had finished?).\r\n\r\n--- <test sequence> --\r\n\r\n- drop the database and re-create an empty one\r\n\r\n- delete everything in the data directory, and config.php\r\n\r\n- visit the webui, give in db and admin settings\r\n\r\n\r\n- enable encryption, log off and back on (as admin)\r\n\r\n- verify that files in admin/files/documents look encrypted on the command\r\nline\r\n\r\n\r\nwindows\r\n\r\n- owncloud client: delete the folder synchronisation, stop the client.\r\n\r\n\r\nwebui\r\n\r\n- as admin, create anew user boran, log off and back on as boran.\r\n\r\n- in file, create file1.txt, edit and add a line\r\n\r\n- verify that boran/files and boran/files_encryption/keyfiles/file1.txt.key\r\nexist\r\n\r\n\r\nwindows:\r\n\r\n- use the account wizard to create a folder and sync with the boran account\r\n\r\n- verify that file1.txt is downloaded and contains the sample text\r\n\r\n\r\nadd another line to file1.txt on the webui, and verify that it arrives 30\r\nsecs or so later on the client.\r\n\r\n\r\nnow, modify file1.txt on the windows client!\r\n\r\nand on the webui.\r\n\r\n\r\n==> changes are seen each time, no problem at all.\r\n--- </test sequence> --\r\n\r\n\r\non 7 december 2013 17:26, bjã¶rn schieãÿle <notifications@github.com> wrote:\r\n\r\n> @baron <https://github.com/baron> on your second try. please check\r\n> following. after you created the file in the webui, you can read the file\r\n> again, right?\r\n>\r\n> so at this point following keyfiles should exist:\r\n>\r\n>    - /user/files_encryption/keyfiles/<filename>.key\r\n>    - /user/files_encryption/share-keys/<filename>.<user>.sharekey\r\n>\r\n> than start the sync client and wait until the file was downloaded\r\n> successfully. check the keyfiles again. does they still exists?\r\n>\r\n> now modify and wait until the client tried to upload the file. check the\r\n> keyfiles again. does they still exist?\r\n>\r\n> it sounds like at some point you lose the keyfiles...\r\n>\r\n> â€”\r\n> reply to this email directly or view it on github<https://github.com/owncloud/core/issues/6227#issuecomment-30058465>\r\n> .\r\n>"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30069170","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30069170","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30069170,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-12-07t23:25:54z","updated_at":"2013-12-07t23:25:54z","body":"either you did the steps slightly differently the first time, or you bumped over a weird hard to reproduce race condition.\r\n@schiesbn can you think of any case where a race condition could happen ?\r\n\r\nif you connect the client before the migration (initial encryption) is start, the client should not be able to connect / sync the files yet.\r\n\r\nif the client is started while the migration is run, not sure what could happen. would it start syncing the part of the dir that was already synced or will it be blocked until all files were migrated ? what do you think @schiesbn ?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30122923","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30122923","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30122923,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-12-09t11:03:10z","updated_at":"2013-12-09t11:03:10z","body":"> either you did the steps slightly differently the first time, or you bumped over a weird hard to reproduce race condition. @schiesbn can you think of any case where a race condition could happen ?\r\n\r\nat the moment i have no idea... but if it even happens again, please report the issue here, @boran. the crucial part is that we always need the keys i mentioned above. it is quite wired that the keys get lost in one of the steps, i never saw such a behaviour/bug, but this doesn't mean that there is no bug.\r\n\r\n> if you connect the client before the migration (initial encryption) is start, the client should not be able to connect / sync the files yet.\r\n\r\nyes, if the client was started before you enable the encryption than the client still maintains a session without the necessary encryption keys. this should result in client errors and the client should stop syncing files. but of course this shouldn't result in data lost.\r\n\r\n> if the client is started while the migration is run, not sure what could happen. would it start syncing the part of the dir that was already synced or will it be blocked until all files were migrated ?\r\n\r\nhm, good question. we make sure that the client doesn't start a second migration run. but i'm not sure if he will try to sync half-migrated files. this could be a problem but it should only result in broken files not in missing keys. we should probably block log-ins as long as the migration is running... i will look into this case. but i'm not sure if it is the root of the problem described by @boran "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/30147262","html_url":"https://github.com/owncloud/core/issues/6227#issuecomment-30147262","issue_url":"https://api.github.com/repos/owncloud/core/issues/6227","id":30147262,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-12-09t16:34:45z","updated_at":"2013-12-09t16:34:45z","body":"since nobody can re-produce it at the moment i close this issue for now.\r\n\r\n@boran feel free to re-open it if it happen again."}]