[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/23049358","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-23049358","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":23049358,"user":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"created_at":"2013-08-21t20:53:24z","updated_at":"2013-08-21t20:53:24z","body":"@vieridipaola are you connecting to a samba server or windows?\r\n\r\n@icewind1991 can you please have a look? thx"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/23073608","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-23073608","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":23073608,"user":{"login":"vieridipaola","id":5190191,"avatar_url":"https://gravatar.com/avatar/73eba2942a4bdc3c23876f2141581e90?d=https%3a%2f%2fidenticons.github.com%2fd2f3917ee2fb29607efcc5c1c9be3479.png&r=x","gravatar_id":"73eba2942a4bdc3c23876f2141581e90","url":"https://api.github.com/users/vieridipaola","html_url":"https://github.com/vieridipaola","followers_url":"https://api.github.com/users/vieridipaola/followers","following_url":"https://api.github.com/users/vieridipaola/following{/other_user}","gists_url":"https://api.github.com/users/vieridipaola/gists{/gist_id}","starred_url":"https://api.github.com/users/vieridipaola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vieridipaola/subscriptions","organizations_url":"https://api.github.com/users/vieridipaola/orgs","repos_url":"https://api.github.com/users/vieridipaola/repos","events_url":"https://api.github.com/users/vieridipaola/events{/privacy}","received_events_url":"https://api.github.com/users/vieridipaola/received_events","type":"user","site_admin":false},"created_at":"2013-08-22t07:55:09z","updated_at":"2013-08-22t07:55:09z","body":"the shares are on a windows server 2003."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/23780334","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-23780334","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":23780334,"user":{"login":"jtessier-oriso","id":5380878,"avatar_url":"https://gravatar.com/avatar/6e148218827a91f634894b2b875f38b1?d=https%3a%2f%2fidenticons.github.com%2fa42473f822a5b161aa34a89333e810d6.png&r=x","gravatar_id":"6e148218827a91f634894b2b875f38b1","url":"https://api.github.com/users/jtessier-oriso","html_url":"https://github.com/jtessier-oriso","followers_url":"https://api.github.com/users/jtessier-oriso/followers","following_url":"https://api.github.com/users/jtessier-oriso/following{/other_user}","gists_url":"https://api.github.com/users/jtessier-oriso/gists{/gist_id}","starred_url":"https://api.github.com/users/jtessier-oriso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtessier-oriso/subscriptions","organizations_url":"https://api.github.com/users/jtessier-oriso/orgs","repos_url":"https://api.github.com/users/jtessier-oriso/repos","events_url":"https://api.github.com/users/jtessier-oriso/events{/privacy}","received_events_url":"https://api.github.com/users/jtessier-oriso/received_events","type":"user","site_admin":false},"created_at":"2013-09-04t10:43:59z","updated_at":"2013-09-04t10:43:59z","body":"i'm having the same issue.\r\n\r\nrenaming folders work, but throws an error, same thing for files\r\nrenaming files in sub-folders leaves 0 bytes files behind\r\ndeleting files requires me to refresh the page before they appear 'deleted'\r\nand i just can't delete folders at the root of the fs\r\n\r\ni'm connecting to a samba server on windows 2k8"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28697171","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-28697171","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":28697171,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-18t13:24:01z","updated_at":"2013-11-18t13:24:01z","body":"the \"need to refresh the page after an operation\" is fixed by https://github.com/owncloud/core/pull/5878\r\ndeleting files should also work after this.\r\n\r\nbut deleting folders still seems to be broken. the smbclient call is using the \"del\" command for folders which is not suitable. it should use \"rmdir\" for empty folders. for non-empty folders, it should iterate over all subdirs and delete all files.\r\n\r\nkeeping this ticket for the \"can't delete folder\" part."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29001435","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29001435","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29001435,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-21t16:54:41z","updated_at":"2013-11-21t16:54:41z","body":"it looks like it's because all backends understand \"unlink()\" as \"delete this file\" or \"delete this folder\".\r\nbut for the smb backend specifically, we need to change it to detect whether we're deleting a file or a folder, then use either \"unlink()\" or \"rmdir()\".\r\n\r\nfor non-empty dir, a deltree algorithm needs to be implemented (or reused from this future pr https://github.com/owncloud/core/pull/3908/files)"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29001493","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29001493","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29001493,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-21t16:55:23z","updated_at":"2013-11-21t16:55:23z","body":"ah, the old dos times..."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29290853","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29290853","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29290853,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-26t13:13:17z","updated_at":"2013-11-26t13:13:17z","body":"it turns out that the rmdir() operation in private/files/storage/common.php already supports recursive deletion. it is even covered by the storage unit tests!\r\n\r\nthe trouble is that delete.php is calling unlink() on folders instead of rmdir(), which goes to the wrong code path.\r\ni seem to remember being able to delete folder through the webdav interface, which might explain why it worked there.\r\n\r\ni'll check this."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29290940","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29290940","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29290940,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-26t13:14:44z","updated_at":"2013-11-26t13:14:44z","body":"@icewind1991 it seems that some storage allow calling unlink() with a directory (the default one) but others like smb don't. i think we can make unlink() always work for dirs (making them use rmdir() internally)."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29291826","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29291826","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29291826,"user":{"login":"icewind1991","id":1283854,"avatar_url":"https://gravatar.com/avatar/7c20f90ca5df67dd2cad22a8e2f80d8f?d=https%3a%2f%2fidenticons.github.com%2fc818423776eba38604496a7caddc0251.png&r=x","gravatar_id":"7c20f90ca5df67dd2cad22a8e2f80d8f","url":"https://api.github.com/users/icewind1991","html_url":"https://github.com/icewind1991","followers_url":"https://api.github.com/users/icewind1991/followers","following_url":"https://api.github.com/users/icewind1991/following{/other_user}","gists_url":"https://api.github.com/users/icewind1991/gists{/gist_id}","starred_url":"https://api.github.com/users/icewind1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icewind1991/subscriptions","organizations_url":"https://api.github.com/users/icewind1991/orgs","repos_url":"https://api.github.com/users/icewind1991/repos","events_url":"https://api.github.com/users/icewind1991/events{/privacy}","received_events_url":"https://api.github.com/users/icewind1991/received_events","type":"user","site_admin":false},"created_at":"2013-11-26t13:29:09z","updated_at":"2013-11-26t13:29:09z","body":"how about:\r\n\r\n- add `delete($path)` to the storage interface\r\n- default implementation of `delete` in (`storage\\common`) calls either `unlink` or `rmdir`\r\n- change `view::unlink` to call `$storage->delete` instead of `$storage->unlink`\r\n- backends can overwrite the `delete` function if unlink and rmdir are done in the same way for the storage to save an `is_dir` call"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29292117","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29292117","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29292117,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-26t13:33:21z","updated_at":"2013-11-26t13:33:21z","body":"sounds sensible.\r\n\r\nthe first user of \"delete()\" will be the ajax delete.php call. i'll leave the others for now as it would need to much regression testing."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29292871","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29292871","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29292871,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-26t13:44:59z","updated_at":"2013-11-26t13:44:59z","body":"looks like `view::unlink()` is calling `basicoperation('unlink', ...)`. i don't feel comfortable changing this to `basicoperation('delete', ...)` as i feel it might break existing hooks.\r\n_delete.php_ calls `\\oc\\files\\filesystem::unlink()`.\r\n\r\ni think that redirecting `unlink()` to `delete()` then back to `unlink()` is confusing.\r\nit seems that so far the expectation was that `unlink()` is supposed to delete either file or folder.\r\n\r\nsince we're close to release i think i'll rather go the safe route and implement that logic directly in the affected storage classes (smb, ftp) which i tried locally and seem to work fine.\r\n\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29293691","html_url":"https://github.com/owncloud/core/issues/4531#issuecomment-29293691","issue_url":"https://api.github.com/repos/owncloud/core/issues/4531","id":29293691,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-26t13:56:36z","updated_at":"2013-11-26t13:56:36z","body":"the correct fix seem to be more complex than i expected.\r\nlike @icewind1991 there will be useless calls to is_dir() which will slow down recursive deletetion.\r\n\r\ni think i'll just fix delete.php for now.\r\n"}]