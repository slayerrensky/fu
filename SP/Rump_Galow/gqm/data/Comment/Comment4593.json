[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/23323259","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-23323259","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":23323259,"user":{"login":"kabum","id":245432,"avatar_url":"https://gravatar.com/avatar/a1dea19f88f38ea0b5b5b4d19d5b3107?d=https%3a%2f%2fidenticons.github.com%2f53d8cbb3dbc087a02951dec47438ccdf.png&r=x","gravatar_id":"a1dea19f88f38ea0b5b5b4d19d5b3107","url":"https://api.github.com/users/kabum","html_url":"https://github.com/kabum","followers_url":"https://api.github.com/users/kabum/followers","following_url":"https://api.github.com/users/kabum/following{/other_user}","gists_url":"https://api.github.com/users/kabum/gists{/gist_id}","starred_url":"https://api.github.com/users/kabum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kabum/subscriptions","organizations_url":"https://api.github.com/users/kabum/orgs","repos_url":"https://api.github.com/users/kabum/repos","events_url":"https://api.github.com/users/kabum/events{/privacy}","received_events_url":"https://api.github.com/users/kabum/received_events","type":"user","site_admin":false},"created_at":"2013-08-27t09:26:58z","updated_at":"2013-08-27t09:26:58z","body":"cc @deepdiver1975 @icewind1991 @kondou-ger "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/23325889","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-23325889","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":23325889,"user":{"login":"kondou-ger","id":1410802,"avatar_url":"https://gravatar.com/avatar/917dab919ae812f8252b2f501c514b19?d=https%3a%2f%2fidenticons.github.com%2fd07869ed62cb1b7f88b731956ab913ee.png&r=x","gravatar_id":"917dab919ae812f8252b2f501c514b19","url":"https://api.github.com/users/kondou-ger","html_url":"https://github.com/kondou-ger","followers_url":"https://api.github.com/users/kondou-ger/followers","following_url":"https://api.github.com/users/kondou-ger/following{/other_user}","gists_url":"https://api.github.com/users/kondou-ger/gists{/gist_id}","starred_url":"https://api.github.com/users/kondou-ger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kondou-ger/subscriptions","organizations_url":"https://api.github.com/users/kondou-ger/orgs","repos_url":"https://api.github.com/users/kondou-ger/repos","events_url":"https://api.github.com/users/kondou-ger/events{/privacy}","received_events_url":"https://api.github.com/users/kondou-ger/received_events","type":"user","site_admin":false},"created_at":"2013-08-27t10:20:48z","updated_at":"2013-08-27t10:22:30z","body":"can't reproduce on my server. (opensuse 12.3 – php 5.5.2 – latest master).\r\n\r\n1 gb shows up as 1023,5 mb though …"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28190200","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28190200","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28190200,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t11:04:02z","updated_at":"2013-11-11t11:04:02z","body":"works for me as well on oc 6 beta 3 (master) (opensuse 12.3, php 5.3.17)\r\n\r\n1 gb shows as 1 gb.\r\n\r\n@kabum can you try again ?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28196867","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28196867","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28196867,"user":{"login":"kabum","id":245432,"avatar_url":"https://gravatar.com/avatar/a1dea19f88f38ea0b5b5b4d19d5b3107?d=https%3a%2f%2fidenticons.github.com%2f53d8cbb3dbc087a02951dec47438ccdf.png&r=x","gravatar_id":"a1dea19f88f38ea0b5b5b4d19d5b3107","url":"https://api.github.com/users/kabum","html_url":"https://github.com/kabum","followers_url":"https://api.github.com/users/kabum/followers","following_url":"https://api.github.com/users/kabum/following{/other_user}","gists_url":"https://api.github.com/users/kabum/gists{/gist_id}","starred_url":"https://api.github.com/users/kabum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kabum/subscriptions","organizations_url":"https://api.github.com/users/kabum/orgs","repos_url":"https://api.github.com/users/kabum/repos","events_url":"https://api.github.com/users/kabum/events{/privacy}","received_events_url":"https://api.github.com/users/kabum/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t12:54:43z","updated_at":"2013-11-11t13:15:50z","body":"it seems that there is something completely wrong with the quota calculation:\r\n\r\n![bildschirmfoto von 2013-11-11 13 50 13](https://f.cloud.github.com/assets/245432/1512625/e8021cae-4acf-11e3-9473-a3a5205e381b.png)\r\n\r\nleft: quota 1gb\r\nsecond from left: trashbin -> empty, but i can access it (button is not disabled as it has to)\r\nsecond from right: my folder -> empty except the shared files, but they don't have to count on my quota\r\n~~right: quota displayed: 803 mb~~ edit: for a new user the quota is displayed correct.\r\n\r\nterminal: df -h * inside of the folder `data/mjob`\r\n\r\n```\r\n36k\t\tavatar.jpg\r\n4,0k\tcache\r\n176k\tdocuments\r\n4,0k\tfiles\r\n12k\t\tfiles_encryption\r\n16k\t\tfiles_external\r\n300m\tfiles_trashbin\r\n5,6m\tfiles_versions\r\n2,2m\tgallery\r\n40k\t\tlucene_index\r\n4,0k\tmount.json\r\n2,2m\tthumbnails\r\n```\r\n\r\n@schiesbn\r\n300 mb in the trashbin?\r\n5,6 mb in versions?\r\n\r\nthumbnails and gallery are also weird\r\n\r\ni will try to find the issue - or first of it all try to reproduce with a new user.\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28197000","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28197000","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28197000,"user":{"login":"kabum","id":245432,"avatar_url":"https://gravatar.com/avatar/a1dea19f88f38ea0b5b5b4d19d5b3107?d=https%3a%2f%2fidenticons.github.com%2f53d8cbb3dbc087a02951dec47438ccdf.png&r=x","gravatar_id":"a1dea19f88f38ea0b5b5b4d19d5b3107","url":"https://api.github.com/users/kabum","html_url":"https://github.com/kabum","followers_url":"https://api.github.com/users/kabum/followers","following_url":"https://api.github.com/users/kabum/following{/other_user}","gists_url":"https://api.github.com/users/kabum/gists{/gist_id}","starred_url":"https://api.github.com/users/kabum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kabum/subscriptions","organizations_url":"https://api.github.com/users/kabum/orgs","repos_url":"https://api.github.com/users/kabum/repos","events_url":"https://api.github.com/users/kabum/events{/privacy}","received_events_url":"https://api.github.com/users/kabum/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t12:56:29z","updated_at":"2013-11-11t12:56:29z","body":"btw: the wrong quota for 5 gb is caused by the harddrive ... there is no more space left."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28197343","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28197343","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28197343,"user":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t13:00:42z","updated_at":"2013-11-11t13:00:42z","body":"@pvince81 "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28197633","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28197633","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28197633,"user":{"login":"kabum","id":245432,"avatar_url":"https://gravatar.com/avatar/a1dea19f88f38ea0b5b5b4d19d5b3107?d=https%3a%2f%2fidenticons.github.com%2f53d8cbb3dbc087a02951dec47438ccdf.png&r=x","gravatar_id":"a1dea19f88f38ea0b5b5b4d19d5b3107","url":"https://api.github.com/users/kabum","html_url":"https://github.com/kabum","followers_url":"https://api.github.com/users/kabum/followers","following_url":"https://api.github.com/users/kabum/following{/other_user}","gists_url":"https://api.github.com/users/kabum/gists{/gist_id}","starred_url":"https://api.github.com/users/kabum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kabum/subscriptions","organizations_url":"https://api.github.com/users/kabum/orgs","repos_url":"https://api.github.com/users/kabum/repos","events_url":"https://api.github.com/users/kabum/events{/privacy}","received_events_url":"https://api.github.com/users/kabum/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t13:04:41z","updated_at":"2013-11-11t13:04:41z","body":"#2796 seems to takes the quota count for shared folders into account."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28198667","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28198667","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28198667,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-11t13:18:45z","updated_at":"2013-11-11t13:18:45z","body":"yes, there is a general problem with quota calculation, which also includes \"not refreshing the total used space\" when using shared dirs, etc. \r\nit's weird that the \"total allowed size\" isn't displayed correctly.\r\n\r\ni'll have a look at this once my prs for quota fixing are merged."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28400104","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28400104","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28400104,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-13t14:50:41z","updated_at":"2013-11-13t14:50:41z","body":"@kabum had a discussion with @schiesbn about quota calculation. we're not sure yet but it seems that it currently works in the following way:\r\n1) all scanned folders are counted as used space. some apps like versions and trashbin will substract their size from the used space.\r\n2) sometimes some folders like gallery, thumbnail, trashbin aren't scanned yet so in that case they might be omitted in the calculation.\r\n\r\nideally, all folders under the user's home should always be scanned and their sizes must count as used space.\r\nonly in special cases, like versions and trashbin, hooks can be used to substract a value from the used space to provide some \"virtual free space\" (space that is automatically freed when needed).\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28404089","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28404089","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28404089,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-13t15:32:56z","updated_at":"2013-11-13t15:32:56z","body":"@schiesbn it looks like something is wrong with the trashbin.\r\nhere are my steps:\r\n1. starting from an empty owncloud\r\n2. create a user \"user1\" with a quota of 1 gb\r\n3. upload 600 mb of files (i've uploaded them through the sync client 1.4.2)\r\n4. check the personal page: it shows 600 mb used of 1 gb\r\n5. now from the 600 mb i've deleted 100 mb (a subfolder)\r\n6. go back to the personal page: it shows 500 mb used of 900 mb\r\n7. check the db: the files_trashbin folder was scanned and has a size of about 100 mb\r\n\r\ni'd expect it to show \"500 mb used of 1 gb\" instead of \"500 mb used of 900 mb\" since my total quota is 1 gb.\r\n\r\n@icewind1991 can we assume that files_trashbin, versions, gallery, thumbnails and other files are always indexed in the cache ? (except the \"cache\" subdir with chunk files)\r\n\r\nthis way they would all count in the total size represented by the root entry of the home storage.\r\nthen, the trashbin app and versions app can subtract the size of \"files_trashbin\" and \"files_versions\" to display the \"virtual free space\"."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28404784","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28404784","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28404784,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-13t15:40:08z","updated_at":"2013-11-13t15:40:08z","body":"seems the gallery and thumbnails aren't in the cache, even when accessing the picture app.\r\nif i run \"scanfiles(true)\" in the chrome console, they will suddenly appear in the cache and influence the total size."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28410604","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28410604","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28410604,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-13t16:42:04z","updated_at":"2013-11-13t16:42:04z","body":"we had a discussion with @schiesbn and @jancborchardt about what should be counted in used space and quota, and the conclusion was to only count whatever is in \"/files\". this means that trashbin and versions don't count in the \"total used space\". this also makes it easier to understand for the user in the ui.\r\n\r\nto achieve this, we would need to:\r\n1) modify the quota storage wrapper: the \"get used space\" and \"get free space\" methods should operate on 2) \"/files\" instead of \"/\". any file that is written outside of \"/files\" through the storage wrapper does not count in the quota.\r\n2) disk operations going through view/storage classes would not trigger scanning/caching when outside of \"/files\".\r\n\r\nare you ok with this @icewind1991 ?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/28438321","html_url":"https://github.com/owncloud/core/issues/4593#issuecomment-28438321","issue_url":"https://api.github.com/repos/owncloud/core/issues/4593","id":28438321,"user":{"login":"kabum","id":245432,"avatar_url":"https://gravatar.com/avatar/a1dea19f88f38ea0b5b5b4d19d5b3107?d=https%3a%2f%2fidenticons.github.com%2f53d8cbb3dbc087a02951dec47438ccdf.png&r=x","gravatar_id":"a1dea19f88f38ea0b5b5b4d19d5b3107","url":"https://api.github.com/users/kabum","html_url":"https://github.com/kabum","followers_url":"https://api.github.com/users/kabum/followers","following_url":"https://api.github.com/users/kabum/following{/other_user}","gists_url":"https://api.github.com/users/kabum/gists{/gist_id}","starred_url":"https://api.github.com/users/kabum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kabum/subscriptions","organizations_url":"https://api.github.com/users/kabum/orgs","repos_url":"https://api.github.com/users/kabum/repos","events_url":"https://api.github.com/users/kabum/events{/privacy}","received_events_url":"https://api.github.com/users/kabum/received_events","type":"user","site_admin":false},"created_at":"2013-11-13t22:01:32z","updated_at":"2013-11-13t22:01:32z","body":"@pvince81 sounds good and is defintely more clear from a user point of view."}]