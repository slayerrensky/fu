[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15150341","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15150341","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15150341,"user":{"login":"raydiation","id":195053,"avatar_url":"https://gravatar.com/avatar/aa0d7b7302e0d7f4f9513c23b571383a?d=https%3a%2f%2fidenticons.github.com%2faf0a25e27510f77d97634a6bbe653b13.png&r=x","gravatar_id":"aa0d7b7302e0d7f4f9513c23b571383a","url":"https://api.github.com/users/raydiation","html_url":"https://github.com/raydiation","followers_url":"https://api.github.com/users/raydiation/followers","following_url":"https://api.github.com/users/raydiation/following{/other_user}","gists_url":"https://api.github.com/users/raydiation/gists{/gist_id}","starred_url":"https://api.github.com/users/raydiation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raydiation/subscriptions","organizations_url":"https://api.github.com/users/raydiation/orgs","repos_url":"https://api.github.com/users/raydiation/repos","events_url":"https://api.github.com/users/raydiation/events{/privacy}","received_events_url":"https://api.github.com/users/raydiation/received_events","type":"user","site_admin":false},"created_at":"2013-03-19t23:31:28z","updated_at":"2013-03-19t23:31:28z","body":"@icewind1991 "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15152385","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15152385","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15152385,"user":{"login":"icewind1991","id":1283854,"avatar_url":"https://gravatar.com/avatar/7c20f90ca5df67dd2cad22a8e2f80d8f?d=https%3a%2f%2fidenticons.github.com%2fc818423776eba38604496a7caddc0251.png&r=x","gravatar_id":"7c20f90ca5df67dd2cad22a8e2f80d8f","url":"https://api.github.com/users/icewind1991","html_url":"https://github.com/icewind1991","followers_url":"https://api.github.com/users/icewind1991/followers","following_url":"https://api.github.com/users/icewind1991/following{/other_user}","gists_url":"https://api.github.com/users/icewind1991/gists{/gist_id}","starred_url":"https://api.github.com/users/icewind1991/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/icewind1991/subscriptions","organizations_url":"https://api.github.com/users/icewind1991/orgs","repos_url":"https://api.github.com/users/icewind1991/repos","events_url":"https://api.github.com/users/icewind1991/events{/privacy}","received_events_url":"https://api.github.com/users/icewind1991/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t00:33:19z","updated_at":"2013-03-20t00:33:19z","body":"@mtgap "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15152501","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15152501","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15152501,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t00:36:53z","updated_at":"2013-03-20t00:36:53z","body":"i suppose the blame has been put on me now... \r\n\r\ni'm not quite sure what infinite repetition of queries means, it just doesn't ever stop after a page load or you just see the same queries every page load?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15152799","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15152799","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15152799,"user":{"login":"raydiation","id":195053,"avatar_url":"https://gravatar.com/avatar/aa0d7b7302e0d7f4f9513c23b571383a?d=https%3a%2f%2fidenticons.github.com%2faf0a25e27510f77d97634a6bbe653b13.png&r=x","gravatar_id":"aa0d7b7302e0d7f4f9513c23b571383a","url":"https://api.github.com/users/raydiation","html_url":"https://github.com/raydiation","followers_url":"https://api.github.com/users/raydiation/followers","following_url":"https://api.github.com/users/raydiation/following{/other_user}","gists_url":"https://api.github.com/users/raydiation/gists{/gist_id}","starred_url":"https://api.github.com/users/raydiation/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/raydiation/subscriptions","organizations_url":"https://api.github.com/users/raydiation/orgs","repos_url":"https://api.github.com/users/raydiation/repos","events_url":"https://api.github.com/users/raydiation/events{/privacy}","received_events_url":"https://api.github.com/users/raydiation/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t00:46:43z","updated_at":"2013-03-20t00:46:43z","body":"hooks maybe?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15157983","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15157983","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15157983,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t04:36:32z","updated_at":"2013-03-20t04:36:32z","body":"@blizzz is this by chance the same thing you were running into?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15164437","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15164437","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15164437,"user":{"login":"jcdevaux","id":3909065,"avatar_url":"https://gravatar.com/avatar/885fec5229329a31849bd89d2997e6da?d=https%3a%2f%2fidenticons.github.com%2ff9ac17a72e5e59e5412eda15cd4ce1cd.png&r=x","gravatar_id":"885fec5229329a31849bd89d2997e6da","url":"https://api.github.com/users/jcdevaux","html_url":"https://github.com/jcdevaux","followers_url":"https://api.github.com/users/jcdevaux/followers","following_url":"https://api.github.com/users/jcdevaux/following{/other_user}","gists_url":"https://api.github.com/users/jcdevaux/gists{/gist_id}","starred_url":"https://api.github.com/users/jcdevaux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jcdevaux/subscriptions","organizations_url":"https://api.github.com/users/jcdevaux/orgs","repos_url":"https://api.github.com/users/jcdevaux/repos","events_url":"https://api.github.com/users/jcdevaux/events{/privacy}","received_events_url":"https://api.github.com/users/jcdevaux/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t09:05:55z","updated_at":"2013-03-20t09:10:53z","body":"@mtgap \r\nwith web interface, after several actions (share/rename/create/delete) on files or folders, the page seams not to have any answer from server anymore. i've tried to close and open again the webpage but then i only have a blank page.\r\n\r\ni've looked into the mysql server log and even if all the pages are closed there are still many queries. this group of 19 queries is filling my log file with an incredible speed (the only change is configvalue in update `oc_preferences` set ...) until i restart mysql daemon.\r\n\r\njust ask for other logs if necessary.\r\n\r\none thing : i'm sharing a subfolder of clientsync with a group (\"group-board\") (all rights except re-share). user1, user2 and user3 are members of \"group-board\". it has been anonymized. user1 is the guy who shares."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15167647","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15167647","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15167647,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t10:30:41z","updated_at":"2013-03-20t10:30:41z","body":"@mtgap no, it is something else"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15189627","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15189627","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15189627,"user":{"login":"tilman-schieber","id":986273,"avatar_url":"https://gravatar.com/avatar/ccd636b589e31873d1b6d1d99e10b503?d=https%3a%2f%2fidenticons.github.com%2f4a049645a6259d57ee508c723fb2fa43.png&r=x","gravatar_id":"ccd636b589e31873d1b6d1d99e10b503","url":"https://api.github.com/users/tilman-schieber","html_url":"https://github.com/tilman-schieber","followers_url":"https://api.github.com/users/tilman-schieber/followers","following_url":"https://api.github.com/users/tilman-schieber/following{/other_user}","gists_url":"https://api.github.com/users/tilman-schieber/gists{/gist_id}","starred_url":"https://api.github.com/users/tilman-schieber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tilman-schieber/subscriptions","organizations_url":"https://api.github.com/users/tilman-schieber/orgs","repos_url":"https://api.github.com/users/tilman-schieber/repos","events_url":"https://api.github.com/users/tilman-schieber/events{/privacy}","received_events_url":"https://api.github.com/users/tilman-schieber/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t17:13:19z","updated_at":"2013-03-20t17:19:44z","body":"@mtgap its an infinite loop caused by a while condition that's never satisfied. it occurs when creating/deleting a file in a shared folder. but only when you share it with a group in which you are a member yourself.\r\n\r\nin the case of creating a new file the bug can be traced back to *apps/files_sharing/lib/updater.php*\r\nthe *while* condition in line 38 does not become false.\r\nit can be fixed by emptying $users when  $users==$reshareusers\r\n\r\ni.e. replace line 46 with\r\n\r\n     if ($reshareusers!=$users) $users = $reshareusers;\r\n     else $users=array();\r\n\r\nno idea if this fix makes sense as i didnt have time to read and understand the source properly but it seems to work correctly now.\r\nthis does not fix the infinite loop when deleting shared files.\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15190108","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15190108","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15190108,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t17:20:23z","updated_at":"2013-03-20t17:20:23z","body":"oh, then it sounds similar. was checking for queries before.\r\n\r\n@tilman-schieber could you check whether https://github.com/owncloud/core/pull/2474 helps?\r\n\r\ncc @schiesbn "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15195899","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15195899","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15195899,"user":{"login":"jcdevaux","id":3909065,"avatar_url":"https://gravatar.com/avatar/885fec5229329a31849bd89d2997e6da?d=https%3a%2f%2fidenticons.github.com%2ff9ac17a72e5e59e5412eda15cd4ce1cd.png&r=x","gravatar_id":"885fec5229329a31849bd89d2997e6da","url":"https://api.github.com/users/jcdevaux","html_url":"https://github.com/jcdevaux","followers_url":"https://api.github.com/users/jcdevaux/followers","following_url":"https://api.github.com/users/jcdevaux/following{/other_user}","gists_url":"https://api.github.com/users/jcdevaux/gists{/gist_id}","starred_url":"https://api.github.com/users/jcdevaux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jcdevaux/subscriptions","organizations_url":"https://api.github.com/users/jcdevaux/orgs","repos_url":"https://api.github.com/users/jcdevaux/repos","events_url":"https://api.github.com/users/jcdevaux/events{/privacy}","received_events_url":"https://api.github.com/users/jcdevaux/received_events","type":"user","site_admin":false},"created_at":"2013-03-20t18:52:38z","updated_at":"2013-03-20t18:52:38z","body":"@tilman-schieber didn't try that patch yet.\r\nbut the correction seams to have sense : when update has been applied for all concerned users, there is no more user concerned.\r\n\r\nmaybe, the same thing in sharehook function ?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15224597","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15224597","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15224597,"user":{"login":"jcdevaux","id":3909065,"avatar_url":"https://gravatar.com/avatar/885fec5229329a31849bd89d2997e6da?d=https%3a%2f%2fidenticons.github.com%2ff9ac17a72e5e59e5412eda15cd4ce1cd.png&r=x","gravatar_id":"885fec5229329a31849bd89d2997e6da","url":"https://api.github.com/users/jcdevaux","html_url":"https://github.com/jcdevaux","followers_url":"https://api.github.com/users/jcdevaux/followers","following_url":"https://api.github.com/users/jcdevaux/following{/other_user}","gists_url":"https://api.github.com/users/jcdevaux/gists{/gist_id}","starred_url":"https://api.github.com/users/jcdevaux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jcdevaux/subscriptions","organizations_url":"https://api.github.com/users/jcdevaux/orgs","repos_url":"https://api.github.com/users/jcdevaux/repos","events_url":"https://api.github.com/users/jcdevaux/events{/privacy}","received_events_url":"https://api.github.com/users/jcdevaux/received_events","type":"user","site_admin":false},"created_at":"2013-03-21t08:29:15z","updated_at":"2013-03-21t09:40:14z","body":"@k4k i've no connection error here nor high cpu usage. maybe not related."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15993235","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-15993235","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":15993235,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-06t09:10:18z","updated_at":"2013-04-06t09:10:18z","body":"@blizz\r\n\r\nfirst of all, i can also confirm the behavior described in this bug on a 5.0.3 install.\r\n\r\ni applied the fix @tilman-schieber suggested to apps/files_sharing/lib/updater.php on both correctfolders and sharehook but i can not confirm the endless queries on fscache (and the high flunctuations in rowcount in this table) have stopped with this fix applied. the queries still go on forever.\r\n\r\ni agree with @jcdevaux however that the idea behind this change seems logical because when all reshares have been satisfied, no more resharing is needed anyway.\r\n\r\nperhaps a different approach is worth exploring:\r\n\r\n- after looking at the code in \\ocp\\share for the methods getusersitemshared and getitems i actually wonder why the uidowner is provided to getusersitemshared from updater::sharehook and updater::correctfolders at all.\r\n- share::getitems has the uidowner as optional if omitted i think it will simply return all users a target is shared with, regardless of the owner\r\n- the owner gets filtered out by the fix suggested by @tilman-schieber applied on correctfolders and sharehook\r\n- then the second call to getusersitemshared inside the foreach loop can be omitted because (with omitting the uidowner) $users already contains all users the item is shared with in the first place\r\n\r\nlater this weekend i will try to apply this logic, if anyone has any ideas upfront i'm all ears!\r\n\r\n-- apart from this, in \\ocp\\share::getitems a pretty complex query is constructed without named parameters, this can (and in future probably will) lead to unexpected results. i'll try to suggest a cleanup version with named parameters in future.\r\n\r\ncc @karlitschek "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16005321","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16005321","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16005321,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-04-06t22:26:01z","updated_at":"2013-04-06t22:26:01z","body":"@tilman-schieber i can't reproduce this. i tried sharing a folder with a group and then editing/deleting files inside the shared folder as both the share owner and a user in the group shared with. nothing caused an infinite loop. "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16006307","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16006307","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16006307,"user":{"login":"tilman-schieber","id":986273,"avatar_url":"https://gravatar.com/avatar/ccd636b589e31873d1b6d1d99e10b503?d=https%3a%2f%2fidenticons.github.com%2f4a049645a6259d57ee508c723fb2fa43.png&r=x","gravatar_id":"ccd636b589e31873d1b6d1d99e10b503","url":"https://api.github.com/users/tilman-schieber","html_url":"https://github.com/tilman-schieber","followers_url":"https://api.github.com/users/tilman-schieber/followers","following_url":"https://api.github.com/users/tilman-schieber/following{/other_user}","gists_url":"https://api.github.com/users/tilman-schieber/gists{/gist_id}","starred_url":"https://api.github.com/users/tilman-schieber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tilman-schieber/subscriptions","organizations_url":"https://api.github.com/users/tilman-schieber/orgs","repos_url":"https://api.github.com/users/tilman-schieber/repos","events_url":"https://api.github.com/users/tilman-schieber/events{/privacy}","received_events_url":"https://api.github.com/users/tilman-schieber/received_events","type":"user","site_admin":false},"created_at":"2013-04-06t23:45:27z","updated_at":"2013-04-06t23:45:27z","body":"@mtgap  \r\nas i wrote earlier:\r\n> but only when you share it with a group in which you are a member yourself.\r\n\r\nso was this the case when you tried to reproduce the bug?\r\n\r\nsorry for not replying to the other comments earlier but i switched back to 4.5 for productive use. i have not been tinkering with this anymore. "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16006449","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16006449","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16006449,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-04-06t23:54:52z","updated_at":"2013-04-06t23:54:52z","body":"yes, that is what i tested. please provide exact steps with 5.0.3 if possible."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16012893","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16012893","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16012893,"user":{"login":"tilman-schieber","id":986273,"avatar_url":"https://gravatar.com/avatar/ccd636b589e31873d1b6d1d99e10b503?d=https%3a%2f%2fidenticons.github.com%2f4a049645a6259d57ee508c723fb2fa43.png&r=x","gravatar_id":"ccd636b589e31873d1b6d1d99e10b503","url":"https://api.github.com/users/tilman-schieber","html_url":"https://github.com/tilman-schieber","followers_url":"https://api.github.com/users/tilman-schieber/followers","following_url":"https://api.github.com/users/tilman-schieber/following{/other_user}","gists_url":"https://api.github.com/users/tilman-schieber/gists{/gist_id}","starred_url":"https://api.github.com/users/tilman-schieber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tilman-schieber/subscriptions","organizations_url":"https://api.github.com/users/tilman-schieber/orgs","repos_url":"https://api.github.com/users/tilman-schieber/repos","events_url":"https://api.github.com/users/tilman-schieber/events{/privacy}","received_events_url":"https://api.github.com/users/tilman-schieber/received_events","type":"user","site_admin":false},"created_at":"2013-04-07t10:42:37z","updated_at":"2013-04-07t10:42:37z","body":"i made a completely fresh 5.0.3 install and cannot reproduce the bug either. \r\n\r\nso perhaps it's already fixed or it was a more complex interaction than i assumed. (there was e.g. a ssh mount inside the data directory and i was using mysql server instead of sqlite)\r\nnext week i can take a look at the server where the bug originally occured for me and if it still occurs i'll detail the steps to reproduce it."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16014036","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16014036","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16014036,"user":{"login":"jcdevaux","id":3909065,"avatar_url":"https://gravatar.com/avatar/885fec5229329a31849bd89d2997e6da?d=https%3a%2f%2fidenticons.github.com%2ff9ac17a72e5e59e5412eda15cd4ce1cd.png&r=x","gravatar_id":"885fec5229329a31849bd89d2997e6da","url":"https://api.github.com/users/jcdevaux","html_url":"https://github.com/jcdevaux","followers_url":"https://api.github.com/users/jcdevaux/followers","following_url":"https://api.github.com/users/jcdevaux/following{/other_user}","gists_url":"https://api.github.com/users/jcdevaux/gists{/gist_id}","starred_url":"https://api.github.com/users/jcdevaux/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jcdevaux/subscriptions","organizations_url":"https://api.github.com/users/jcdevaux/orgs","repos_url":"https://api.github.com/users/jcdevaux/repos","events_url":"https://api.github.com/users/jcdevaux/events{/privacy}","received_events_url":"https://api.github.com/users/jcdevaux/received_events","type":"user","site_admin":false},"created_at":"2013-04-07t12:13:10z","updated_at":"2013-04-07t12:13:10z","body":"i'm also using mysql server (instead of sqlite) but no ssh mount."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16014665","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16014665","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16014665,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-07t12:59:09z","updated_at":"2013-04-07t12:59:09z","body":"actually i am getting the impression that in my case the visible fluctuation of tablerows (since its a table of >20k rows) may be caused by the fact that innodb doesnt have a fast rowcount fetch mechanism, if i perform a repeated manual:\r\n```sql\r\nselect count(fileid) from `oc_filecache` \r\n```\r\nthere the fluctuation is not experienced, so i will leave that as is.\r\n\r\nhowever i still think it is faster and more straightforward to omit he owneruid from the first call to getusersitemshared and simply dont do the repetitive calls, you can also strip out the while loop and the test for remaining users.\r\n\r\ni've altered the methods as follows, and tested it with sharing and resharing several files (also with groups) and this seems to work for me (i just commented out the lines i dont think are needed):\r\n\r\n```php\r\n\t/**\r\n\t* correct the parent folders' etags for all users shared the file at $target\r\n\t*\r\n\t* @param string $target\r\n\t*/\r\n\tstatic public function correctfolders($target) {\r\n\t\t$uid = \\ocp\\user::getuser();\r\n\t\t$uidowner = \\oc\\files\\filesystem::getowner($target);\r\n\t\t$info = \\oc\\files\\filesystem::getfileinfo($target);\r\n\t\t// correct shared folders of other users shared with\r\n\t\t$users = \\ocp\\share::getusersitemshared('file', $info['fileid'], null, true);\r\n\t\tif (!empty($users)) {\r\n\t\t\t//while (!empty($users)) {\r\n\t\t\t\t//$reshareusers = array();\r\n\t\t\t\tforeach ($users as $user) {\r\n\t\t\t\t\tif ( $user !== $uidowner ) {\r\n\t\t\t\t\t\t$etag = \\oc\\files\\filesystem::getetag('');\r\n\t\t\t\t\t\t\\ocp\\config::setuservalue($user, 'files_sharing', 'etag', $etag);\r\n\t\t\t\t\t\t// look for reshares\r\n\t\t\t\t\t\t//$reshareusers = array_merge($reshareusers, \\ocp\\share::getusersitemshared('file', $info['fileid'], $user, true));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//$users = $reshareusers;\r\n\t\t\t//}\r\n\t\t\t// correct folders of shared file owner\r\n\t\t\t$target = substr($target, 8);\r\n\t\t\tif ($uidowner !== $uid && $source = \\oc_share_backend_file::getsource($target)) {\r\n\t\t\t\t\\oc\\files\\filesystem::initmountpoints($uidowner);\r\n\t\t\t\t$source = '/'.$uidowner.'/'.$source['path'];\r\n\t\t\t\t\\oc\\files\\cache\\updater::correctfolder($source, $info['mtime']);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n```\r\n\r\n```php\r\n\t/**\r\n\t * @param array $params\r\n\t */\r\n\tstatic public function sharehook($params) {\r\n\t\tif ($params['itemtype'] === 'file' || $params['itemtype'] === 'folder') {\r\n\t\t\t$uidowner = \\ocp\\user::getuser();\r\n\t\t\t$users = \\ocp\\share::getusersitemshared($params['itemtype'], $params['filesource'], null, true);\r\n\t\t\tif (!empty($users)) {\r\n\t\t\t\t//while (!empty($users)) {\r\n\t\t\t\t\t//$reshareusers = array();\r\n\t\t\t\t\tforeach ($users as $user) {\r\n\t\t\t\t\t\tif ($user !== $uidowner) {\r\n\t\t\t\t\t\t\t$etag = \\oc\\files\\filesystem::getetag('');\r\n\t\t\t\t\t\t\t\\ocp\\config::setuservalue($user, 'files_sharing', 'etag', $etag);\r\n\t\t\t\t\t\t\t// look for reshares\r\n\t\t\t\t\t\t\t//$reshareusers = array_merge($reshareusers, \\ocp\\share::getusersitemshared('file', $params['filesource'], $user, true));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//$users = $reshareusers;\r\n\t\t\t\t//}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n```\r\ncan anyone confirm this? or am i looking in the wrong place here?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16027278","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16027278","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16027278,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-04-07t23:59:05z","updated_at":"2013-04-08t00:01:51z","body":"@hcderaad have you tested that with reshares as well? please create a pull request.\r\n\r\nnever mind, i just thought of a case where that doesn't work. if you reshare a file that is inside a shared folder and someone edits that file you need to update the etags. in this case the file ids aren't the same. so it looks like the original code doesn't always work as well. "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16034252","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16034252","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16034252,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t06:14:42z","updated_at":"2013-04-08t06:14:42z","body":"thanks for your input. ive tested resharing by creating a file with\r\ntestuser1, sharing it with testuser2, and from testuser2 reshared the file\r\nwith testuser3.\r\nedits by testuser1 were also applied on the file at testuser3 and edits by\r\ntestuser3 were visible by testuser1.\r\n\r\nis that correct or did i miss something?\r\n\r\nif it looks ok then i will do a pull request.\r\nop 8 apr. 2013 02:00 schreef \"michael gapczynski\" <notifications@github.com>\r\nhet volgende:\r\n\r\n> @hcderaad <https://github.com/hcderaad> have you tested that with\r\n> reshares as well? please create a pull request.\r\n>\r\n> â€”\r\n> reply to this email directly or view it on github<https://github.com/owncloud/core/issues/2453#issuecomment-16027278>\r\n> .[image: web bug from\r\n> https://github.com/notifications/beacon/mhmyy_vxrm6gjwybfcxy3tkv3btna6zxvaodx3okuiymwoenakpwdjglioe6myjw.gif]\r\n>"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16040558","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16040558","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16040558,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t09:25:48z","updated_at":"2013-04-08t09:28:30z","body":"@hcderaad just to make sure that we didn' t miss something: the etags affecting the sync client only, not the web interface. the important think which needs to be tested is to check whether the etags in the database gets changed for the shared folder for every user who has access to the file after the file was modified by someone.\r\n\r\nideally you should not only test this by sharing and re-sharing a single file but also by sharing a folder and than just re-share a sub-file or sub-folder to a third user. than edit the files by the third user, check the etags and try the same with the original user and the second user."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16040675","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16040675","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16040675,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t09:28:37z","updated_at":"2013-04-08t09:28:37z","body":"ok, thanks for the input! i do think that this is still happening because i\r\ndid not change setting the etag inside the loop, but i will test (hopefully\r\nlater today), and if that is the case i will open a pull request.\r\n\r\ndevhdr\r\nonderdeel van halenas v.o.f.\r\n\r\n*van sevenbergestraat 49\r\n2274 pk voorburg*\r\n\r\nkvk: 53493753\r\n\r\ntel: +316-83578847\r\n\r\nwww.hcderaad.nl\r\n\r\n\r\n2013/4/8 bjã¶rn schieãÿle <notifications@github.com>\r\n\r\n> @hcderaad <https://github.com/hcderaad> just to make sure that we didn' t\r\n> miss something: the etags affecting the sync client only, not the web\r\n> interface. the important think which needs to be tested is to check whether\r\n> the etags in the database gets changed for the shared folder for every user\r\n> who has access to the file after the file was modified by someone.\r\n>\r\n> â€”\r\n> reply to this email directly or view it on github<https://github.com/owncloud/core/issues/2453#issuecomment-16040558>\r\n> .[image: web bug from\r\n> https://github.com/notifications/beacon/mhmyy_vxrm6gjwybfcxy3tkv3btna6zxvaodx3okuiymwoenakpwdjglioe6myjw.gif]\r\n>"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16063356","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16063356","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16063356,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t16:58:36z","updated_at":"2013-04-08t16:58:36z","body":"tested the following:\r\n\r\ncreated a file as \"test\" and shared it with \"test2\" who reshared it with \"test3\"\r\non edit by test2 or test3 the etag for the user the file is shared with changes, the only etag that is not changed in this operation is that of the actual first file creator (also when that user edits the file it is not changed).\r\n\r\nsame is for (reshared) directories.\r\n\r\nas far as i can see, this works as intended, so if no further issues are thought of, i will open a pull request for further review!"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16063501","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16063501","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16063501,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t17:00:49z","updated_at":"2013-04-08t17:00:49z","body":"@hcderaad you're not testing what both @schiesbn and i suggested."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16065847","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16065847","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16065847,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t17:38:49z","updated_at":"2013-04-08t17:38:49z","body":"@mtgap my apologies, this is what i understood from the suggestions:\r\n\r\n- create a new file and share it\r\n- test the changed etag of a shared file\r\n- reshare the file and change it by the user it is reshared with\r\n\r\n- create a new shared folder\r\n- create a subfolder in the shared folder (by a different user) and reshare that\r\n- reshare the original shared folder with a different group\r\n- modify the contents of these folders.\r\n\r\nand this was also done with a user in a group with which the folder was shared (so no direct share).\r\n\r\ninbetween i've checked if the etags have been changed, also the parentfolders etags have changed.\r\ni have done this using both the webclient as the webdavclient (through kde dolphin).\r\n\r\ni will be more verbose in future, but, is this covering enough use cases or am i still missing something?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16065960","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16065960","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16065960,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t17:40:46z","updated_at":"2013-04-08t17:41:42z","body":"okay, that reshared subfolder inside a shared folder is what we were describing. open a pull request please."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16079121","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16079121","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16079121,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t21:14:16z","updated_at":"2013-04-08t21:14:16z","body":"@mtgap @schiesbn ok, i will have to get back on this, i wasnt entirely satisfied with my last testrun so i've done a fresh installation of owncloud (ie i've emptied and recreated both the db and the data dir, and the users, groups, and files).\r\n\r\nthis is what i have tested step by step:\r\n1. create user test1, test2, test3\r\n2. create group testgr1 -> test1, test2\r\n3. create group testgr2 -> test2, test3\r\n4. mkdir with test1 -> testdir1\r\n5. share with group testgr1\r\n6. make file with test2 (webdav)\r\n7. reshare testdir1 by user test2 -> testgr2\r\n8. make file with user test3 in testdir1 -> testfile2\r\n9. alter file testfile2 with test1\r\n\r\nalso i've inserted a logger in updater.php (correctfolders and sharehook) i am a bit dazed about its output, as these methods are not called on every update of the contents of a file/folder, here is the logger:\r\n\r\n```php\r\nfile_put_contents('/srv/www/htdocs/owncloud/data/users.log',date('y-m-d h:i:s') . ' - ' . __method__ . ' - ' . serialize($users) . ' - ' . serialize($target). php_eol,file_append);\r\n```\r\n\r\nactually only a direct edit by the owner him/herself invokes a log event through webdav, any other scenario doesnt.\r\nbut in the webclient, every update (be it by user test1, test2 or test3) invokes an entry.\r\n\r\ni think i am going to do a little more research between the differences in the webclient and the webdave client here before making any more statements or suggestions...\r\n\r\nany pointers (mostly oriented on when these methods are actually invoked) are more than welcome."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16081755","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16081755","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16081755,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t21:59:17z","updated_at":"2013-04-08t21:59:24z","body":"there shouldn't be any difference on the technical side for the webdav and web ui because both should be emitting the same hooks for file changes. but it sounds like the hooks aren't always being emitted for you. could you check to see if they are always being registered?\r\n\r\n@bartv2 do you have any idea what's going on with the hooks? i think i remember you moving some hooks to base.php before."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16082484","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16082484","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16082484,"user":{"login":"hcderaad","id":3189378,"avatar_url":"https://gravatar.com/avatar/bd6a8185631d2bce11babd2d112234de?d=https%3a%2f%2fidenticons.github.com%2f36af298718831a3db2877edc674d1893.png&r=x","gravatar_id":"bd6a8185631d2bce11babd2d112234de","url":"https://api.github.com/users/hcderaad","html_url":"https://github.com/hcderaad","followers_url":"https://api.github.com/users/hcderaad/followers","following_url":"https://api.github.com/users/hcderaad/following{/other_user}","gists_url":"https://api.github.com/users/hcderaad/gists{/gist_id}","starred_url":"https://api.github.com/users/hcderaad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hcderaad/subscriptions","organizations_url":"https://api.github.com/users/hcderaad/orgs","repos_url":"https://api.github.com/users/hcderaad/repos","events_url":"https://api.github.com/users/hcderaad/events{/privacy}","received_events_url":"https://api.github.com/users/hcderaad/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t22:14:37z","updated_at":"2013-04-08t22:14:37z","body":"thanks for your quick response, could you provide any hint on where to\r\ncheck the hookregistration?\r\nthere definitely is a difference in the handling of file/folder changes\r\nbetween the different connections/interfaces, which doesnt have to be a bad\r\nthing, as long as the difference is explained clearly.\r\nop 8 apr. 2013 23:59 schreef \"michael gapczynski\" <notifications@github.com>\r\nhet volgende:\r\n\r\n> there shouldn't be any difference on the technical side for the webdav and\r\n> web ui because both should be emitting the same hooks for file changes. but\r\n> it sounds like the hooks aren't always being emitted for you. could you\r\n> check to see if they are always being registered?\r\n>\r\n> @bartv2 <https://github.com/bartv2> do you have any idea what's going on\r\n> with the hooks. i think i remember you moving some hooks to base.php before.\r\n>\r\n> â€”\r\n> reply to this email directly or view it on github<https://github.com/owncloud/core/issues/2453#issuecomment-16081755>\r\n> .[image: web bug from\r\n> https://github.com/notifications/beacon/mhmyy_vxrm6gjwybfcxy3tkv3btna6zxvaodx3okuiymwoenakpwdjglioe6myjw.gif]\r\n>"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/16082545","html_url":"https://github.com/owncloud/core/issues/2453#issuecomment-16082545","issue_url":"https://api.github.com/repos/owncloud/core/issues/2453","id":16082545,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-04-08t22:15:59z","updated_at":"2013-04-08t22:15:59z","body":"well apps/files_sharing/appinfo/app.php should be autoloaded and the hooks registered. you could try to log the connect and emit functions in lib/hook.php i suppose."}]