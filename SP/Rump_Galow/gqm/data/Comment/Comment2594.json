[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15522507","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15522507","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15522507,"user":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"created_at":"2013-03-27t13:18:55z","updated_at":"2013-03-27t13:18:55z","body":"looks great :+1: "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15523196","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15523196","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15523196,"user":{"login":"butonic","id":956847,"avatar_url":"https://gravatar.com/avatar/9760c134cabf66e10dbba06d7525f5c7?d=https%3a%2f%2fidenticons.github.com%2f92925ec1ad893739ed57986f18e2f060.png&r=x","gravatar_id":"9760c134cabf66e10dbba06d7525f5c7","url":"https://api.github.com/users/butonic","html_url":"https://github.com/butonic","followers_url":"https://api.github.com/users/butonic/followers","following_url":"https://api.github.com/users/butonic/following{/other_user}","gists_url":"https://api.github.com/users/butonic/gists{/gist_id}","starred_url":"https://api.github.com/users/butonic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/butonic/subscriptions","organizations_url":"https://api.github.com/users/butonic/orgs","repos_url":"https://api.github.com/users/butonic/repos","events_url":"https://api.github.com/users/butonic/events{/privacy}","received_events_url":"https://api.github.com/users/butonic/received_events","type":"user","site_admin":false},"created_at":"2013-03-27t13:33:33z","updated_at":"2013-03-27t13:33:33z","body":"also pulling @tanghus @deepdiver1975 andd @bartv2 for review"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15524402","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15524402","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15524402,"user":{"login":"butonic","id":956847,"avatar_url":"https://gravatar.com/avatar/9760c134cabf66e10dbba06d7525f5c7?d=https%3a%2f%2fidenticons.github.com%2f92925ec1ad893739ed57986f18e2f060.png&r=x","gravatar_id":"9760c134cabf66e10dbba06d7525f5c7","url":"https://api.github.com/users/butonic","html_url":"https://github.com/butonic","followers_url":"https://api.github.com/users/butonic/followers","following_url":"https://api.github.com/users/butonic/following{/other_user}","gists_url":"https://api.github.com/users/butonic/gists{/gist_id}","starred_url":"https://api.github.com/users/butonic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/butonic/subscriptions","organizations_url":"https://api.github.com/users/butonic/orgs","repos_url":"https://api.github.com/users/butonic/repos","events_url":"https://api.github.com/users/butonic/events{/privacy}","received_events_url":"https://api.github.com/users/butonic/received_events","type":"user","site_admin":false},"created_at":"2013-03-27t13:56:34z","updated_at":"2013-03-27t13:56:34z","body":"to test:\r\n1. upload a file via webdav using cadaver and pause it before upload has finished (ctrl+z).\r\n2. browse to the folder in the web ui. -> no .part file should show up.\r\n3. finish uploading with cadaver (fg)\r\n4. browse to the folder in the web ui. -> the file should show up.\r\nno error should be logged in the apache error log and owncloud.log"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15535272","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15535272","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15535272,"user":{"login":"tanghus","id":533222,"avatar_url":"https://gravatar.com/avatar/e625b634822713b2e346ff7c67d26775?d=https%3a%2f%2fidenticons.github.com%2f6d9c90af1c12f5a88e4d5f216bbc1979.png&r=x","gravatar_id":"e625b634822713b2e346ff7c67d26775","url":"https://api.github.com/users/tanghus","html_url":"https://github.com/tanghus","followers_url":"https://api.github.com/users/tanghus/followers","following_url":"https://api.github.com/users/tanghus/following{/other_user}","gists_url":"https://api.github.com/users/tanghus/gists{/gist_id}","starred_url":"https://api.github.com/users/tanghus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tanghus/subscriptions","organizations_url":"https://api.github.com/users/tanghus/orgs","repos_url":"https://api.github.com/users/tanghus/repos","events_url":"https://api.github.com/users/tanghus/events{/privacy}","received_events_url":"https://api.github.com/users/tanghus/received_events","type":"user","site_admin":false},"created_at":"2013-03-27t16:46:02z","updated_at":"2013-03-27t16:46:02z","body":"i tested before applying the patch to have something to compare with, and i don't see the .part file in the web ui when paused, but it is present in the data folder, so it's hard to judge the difference ;)"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15535445","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15535445","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15535445,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-03-27t16:48:49z","updated_at":"2013-03-27t16:48:49z","body":"don't you need to suppress the hooks for rename as well - for when the .part files are renamed? i don't think it's necessary for copy.\r\n\r\nunfortunately, i don't have time to test. so, could someone please test that everything works as expected for uploading in shared folders also? there were issues in the past when .part was first implemented and shared folders.\r\n\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15542733","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15542733","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15542733,"user":{"login":"butonic","id":956847,"avatar_url":"https://gravatar.com/avatar/9760c134cabf66e10dbba06d7525f5c7?d=https%3a%2f%2fidenticons.github.com%2f92925ec1ad893739ed57986f18e2f060.png&r=x","gravatar_id":"9760c134cabf66e10dbba06d7525f5c7","url":"https://api.github.com/users/butonic","html_url":"https://github.com/butonic","followers_url":"https://api.github.com/users/butonic/followers","following_url":"https://api.github.com/users/butonic/following{/other_user}","gists_url":"https://api.github.com/users/butonic/gists{/gist_id}","starred_url":"https://api.github.com/users/butonic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/butonic/subscriptions","organizations_url":"https://api.github.com/users/butonic/orgs","repos_url":"https://api.github.com/users/butonic/repos","events_url":"https://api.github.com/users/butonic/events{/privacy}","received_events_url":"https://api.github.com/users/butonic/received_events","type":"user","site_admin":false},"created_at":"2013-03-27t18:21:04z","updated_at":"2013-03-27t18:21:04z","body":"@tanghus yes it must be in the data folder because we are writing data to it and the connection is still open, the webserver waiting for further data. before it might happen that the *.part file was left over in the web ui even after the upload was complete, which might have caused weird errors ... maybe with sharing as @mtgap mentioned.\r\n\r\n@mtgap the debug log i wrote in https://github.com/owncloud/core/pull/2528#issuecomment-15488888 shows what happens when the cache picks up a .part file. the cause for that is fixed by https://github.com/owncloud/core/commit/8818582886e8222af43998ebeaf79adf1cc55ad1 it alone will however still trigger the post write hook causing the php notification described by @schiesbn in https://github.com/owncloud/core/pull/2528#issuecomment-15392517 so there is still a code path in `ocp\\\\share::getitems()` that allows `collectiontypes` to be undefined in line 918. with https://github.com/owncloud/core/commit/f449780bbaa885b57eed89c5849913bda3d3b8e0 i now supress the file_put_contents hook and basicoperation hooks for *.part files which suffices to prevent any php notifications down the road. i could supress all or only the necessary hooks.\r\n\r\ni sticked to the least minimal change, although i admit i could move the .part check directly into hook.emit(). the file will get picked up by the cache anyway.\r\n\r\n@icewind1991 there seems to be an overhead of the filecache scanning the whole directory for every file that is uploaded. i don't really know if that happens with every upload or just when the webdav connector uses .part files to hide them until they are fully uploaded. maybe we can tune the performance there."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15555932","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15555932","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15555932,"user":{"login":"mtgap","id":1097106,"avatar_url":"https://gravatar.com/avatar/454a73ee5feeb428d0c163a48903332c?d=https%3a%2f%2fidenticons.github.com%2f52d29a66f285a1d61125dd69ac0766b2.png&r=x","gravatar_id":"454a73ee5feeb428d0c163a48903332c","url":"https://api.github.com/users/mtgap","html_url":"https://github.com/mtgap","followers_url":"https://api.github.com/users/mtgap/followers","following_url":"https://api.github.com/users/mtgap/following{/other_user}","gists_url":"https://api.github.com/users/mtgap/gists{/gist_id}","starred_url":"https://api.github.com/users/mtgap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mtgap/subscriptions","organizations_url":"https://api.github.com/users/mtgap/orgs","repos_url":"https://api.github.com/users/mtgap/repos","events_url":"https://api.github.com/users/mtgap/events{/privacy}","received_events_url":"https://api.github.com/users/mtgap/received_events","type":"user","site_admin":false},"created_at":"2013-03-27t22:01:01z","updated_at":"2013-03-27t22:01:01z","body":"sorry i don't have time to look into the undefined collectiontypes. it probably just needs an additional if there to make sure it is set. \r\n\r\nso, you're saying that the rename hook doesn't need to check the ignored files? from your log it looks like it goes into the scanner (the scanner checks ignored files itself now though), but won't it also go to the other hooks? \r\n\r\nis there still a need to force scanner to get the hook first?\r\n\r\nabout the scanning the whole folder, it looks like the scan function isn't handling single files correctly because of the onlychilds option. it's returning a size of 0 for individual files.\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15577361","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15577361","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15577361,"user":{"login":"dragotin","id":1070214,"avatar_url":"https://gravatar.com/avatar/af829234b31fb915704c1c65ef48eee0?d=https%3a%2f%2fidenticons.github.com%2f3392afab7f424e10623ba95a941f4d34.png&r=x","gravatar_id":"af829234b31fb915704c1c65ef48eee0","url":"https://api.github.com/users/dragotin","html_url":"https://github.com/dragotin","followers_url":"https://api.github.com/users/dragotin/followers","following_url":"https://api.github.com/users/dragotin/following{/other_user}","gists_url":"https://api.github.com/users/dragotin/gists{/gist_id}","starred_url":"https://api.github.com/users/dragotin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dragotin/subscriptions","organizations_url":"https://api.github.com/users/dragotin/orgs","repos_url":"https://api.github.com/users/dragotin/repos","events_url":"https://api.github.com/users/dragotin/events{/privacy}","received_events_url":"https://api.github.com/users/dragotin/received_events","type":"user","site_admin":false},"created_at":"2013-03-28t09:58:07z","updated_at":"2013-03-28t09:58:07z","body":"i also tested this branch with the method describe in pr #2595 . works as expected. also did a similar test with the command line sync client, also successful. no .part files. :+1: "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15579381","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15579381","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15579381,"user":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"created_at":"2013-03-28t10:34:27z","updated_at":"2013-03-28t10:34:27z","body":":+1: "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15581327","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15581327","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15581327,"user":{"login":"butonic","id":956847,"avatar_url":"https://gravatar.com/avatar/9760c134cabf66e10dbba06d7525f5c7?d=https%3a%2f%2fidenticons.github.com%2f92925ec1ad893739ed57986f18e2f060.png&r=x","gravatar_id":"9760c134cabf66e10dbba06d7525f5c7","url":"https://api.github.com/users/butonic","html_url":"https://github.com/butonic","followers_url":"https://api.github.com/users/butonic/followers","following_url":"https://api.github.com/users/butonic/following{/other_user}","gists_url":"https://api.github.com/users/butonic/gists{/gist_id}","starred_url":"https://api.github.com/users/butonic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/butonic/subscriptions","organizations_url":"https://api.github.com/users/butonic/orgs","repos_url":"https://api.github.com/users/butonic/repos","events_url":"https://api.github.com/users/butonic/events{/privacy}","received_events_url":"https://api.github.com/users/butonic/received_events","type":"user","site_admin":false},"created_at":"2013-03-28t11:01:23z","updated_at":"2013-03-28t11:24:32z","body":"@blizzz rebasing from master i saw that you must have been digging through the file cache updater, too. could you check that this pr does not break you fixes?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15824832","html_url":"https://github.com/owncloud/core/pull/2594#issuecomment-15824832","issue_url":"https://api.github.com/repos/owncloud/core/issues/2594","id":15824832,"user":{"login":"butonic","id":956847,"avatar_url":"https://gravatar.com/avatar/9760c134cabf66e10dbba06d7525f5c7?d=https%3a%2f%2fidenticons.github.com%2f92925ec1ad893739ed57986f18e2f060.png&r=x","gravatar_id":"9760c134cabf66e10dbba06d7525f5c7","url":"https://api.github.com/users/butonic","html_url":"https://github.com/butonic","followers_url":"https://api.github.com/users/butonic/followers","following_url":"https://api.github.com/users/butonic/following{/other_user}","gists_url":"https://api.github.com/users/butonic/gists{/gist_id}","starred_url":"https://api.github.com/users/butonic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/butonic/subscriptions","organizations_url":"https://api.github.com/users/butonic/orgs","repos_url":"https://api.github.com/users/butonic/repos","events_url":"https://api.github.com/users/butonic/events{/privacy}","received_events_url":"https://api.github.com/users/butonic/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t08:38:13z","updated_at":"2013-04-03t08:38:13z","body":"since this has been finally merged in 5.0.3 i'll merge it for master as well."}]