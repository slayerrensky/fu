[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22642478","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22642478","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22642478,"user":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"created_at":"2013-08-14t15:11:11z","updated_at":"2013-08-14t15:11:11z","body":"@schiesbn thx"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22646319","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22646319","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22646319,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-08-14t16:02:23z","updated_at":"2013-08-14t16:02:58z","body":"@tapete thanks for the detailed report. i switched completely to the oc filesystem api to create the missing directories. on gnu/linux this works fine. can you try the patch ( #4427 ) and report back if it also works on windows? thanks!"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22651559","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22651559","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22651559,"user":{"login":"tapete","id":5229149,"avatar_url":"https://gravatar.com/avatar/4f54264b945f0f27a1d4caac2984bc25?d=https%3a%2f%2fidenticons.github.com%2f8e95453fc551ec54b190cd0ec225fd23.png&r=x","gravatar_id":"4f54264b945f0f27a1d4caac2984bc25","url":"https://api.github.com/users/tapete","html_url":"https://github.com/tapete","followers_url":"https://api.github.com/users/tapete/followers","following_url":"https://api.github.com/users/tapete/following{/other_user}","gists_url":"https://api.github.com/users/tapete/gists{/gist_id}","starred_url":"https://api.github.com/users/tapete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tapete/subscriptions","organizations_url":"https://api.github.com/users/tapete/orgs","repos_url":"https://api.github.com/users/tapete/repos","events_url":"https://api.github.com/users/tapete/events{/privacy}","received_events_url":"https://api.github.com/users/tapete/received_events","type":"user","site_admin":false},"created_at":"2013-08-14t17:17:45z","updated_at":"2013-08-14t17:17:45z","body":"@schiesbn there are still some issues with this fix. this code should be added infront of the foreach loop:\r\n\t\t\t$begin_char = substr($dirname,0,1);\r\n\t\t\tif($begin_char==\"/\")\r\n\t\t\t{ $dirname = substr($dirname,1,strlen($dirname)-1);}\t\r\n\t\t\t\r\n\t\t\t$dirparts = explode('/', $dirname); \r\n\t\t\t\r\n\t\t\t\t  if(!$versions_view->file_exists(\"files-versions\")) { \r\n\t\t\t\t\t$users_view->mkdir(\"files-versions\"); \r\n\t\t\t\t  }\t\t\t\r\n\t\t    $dir = \"\";\r\n\r\notherwise \"files-versions\" won't be created if it does not exist before. with this code the correct directories will be created but the version file does not. don't know the reason yet."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22657765","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22657765","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22657765,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-08-14t18:46:06z","updated_at":"2013-08-14t18:56:08z","body":"i kept the leading / by purpose because this way the first element of the $dirparts array is empty (at least on gnu/linux, i would be surprised if it is different on windows), so the first iteration should create \"files_versions\" if it doesn't exist yet.\r\n\r\nedit: ok, to make it work i need to start with a root directory above \"files_versions\", see my last commit. now the dir creation should work. don't know why the files doesn't get copied on windows. here it works just fine."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22658694","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22658694","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22658694,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-08-14t18:59:10z","updated_at":"2013-08-14t18:59:10z","body":"btw: i just saw that you wrote \"files-versions\", but \"files_versions\" should be correct. that's the dir name used all over the code. @maestro7879 also pretend that it is \"files-versions\" on windows (see: #4079 ) ... confusing. @deepdiver1975 do you know if we do some mapping on windows which convert the '_' to a '-'?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22660236","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22660236","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22660236,"user":{"login":"tapete","id":5229149,"avatar_url":"https://gravatar.com/avatar/4f54264b945f0f27a1d4caac2984bc25?d=https%3a%2f%2fidenticons.github.com%2f8e95453fc551ec54b190cd0ec225fd23.png&r=x","gravatar_id":"4f54264b945f0f27a1d4caac2984bc25","url":"https://api.github.com/users/tapete","html_url":"https://github.com/tapete","followers_url":"https://api.github.com/users/tapete/followers","following_url":"https://api.github.com/users/tapete/following{/other_user}","gists_url":"https://api.github.com/users/tapete/gists{/gist_id}","starred_url":"https://api.github.com/users/tapete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tapete/subscriptions","organizations_url":"https://api.github.com/users/tapete/orgs","repos_url":"https://api.github.com/users/tapete/repos","events_url":"https://api.github.com/users/tapete/events{/privacy}","received_events_url":"https://api.github.com/users/tapete/received_events","type":"user","site_admin":false},"created_at":"2013-08-14t19:21:48z","updated_at":"2013-08-14t19:21:48z","body":"can i contact you via irc or jabber? my jabber: heinzwerner@jabber.ccc.de"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22661243","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22661243","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22661243,"user":{"login":"tapete","id":5229149,"avatar_url":"https://gravatar.com/avatar/4f54264b945f0f27a1d4caac2984bc25?d=https%3a%2f%2fidenticons.github.com%2f8e95453fc551ec54b190cd0ec225fd23.png&r=x","gravatar_id":"4f54264b945f0f27a1d4caac2984bc25","url":"https://api.github.com/users/tapete","html_url":"https://github.com/tapete","followers_url":"https://api.github.com/users/tapete/followers","following_url":"https://api.github.com/users/tapete/following{/other_user}","gists_url":"https://api.github.com/users/tapete/gists{/gist_id}","starred_url":"https://api.github.com/users/tapete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tapete/subscriptions","organizations_url":"https://api.github.com/users/tapete/orgs","repos_url":"https://api.github.com/users/tapete/repos","events_url":"https://api.github.com/users/tapete/events{/privacy}","received_events_url":"https://api.github.com/users/tapete/received_events","type":"user","site_admin":false},"created_at":"2013-08-14t19:35:58z","updated_at":"2013-08-14t19:35:58z","body":"just tested:\r\n>$text = \"files_versions\";\r\n>$text = preg_replace('~[^\\\\pl\\d\\.]+~u', '-', $text);\r\n>echo $text;\r\n\r\nresults in: files-versions\r\n\r\nthe preg_replace funktion is from slugify() in mapper.php"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22738100","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22738100","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22738100,"user":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"created_at":"2013-08-15t23:23:29z","updated_at":"2013-08-15t23:23:29z","body":"> do you know if we do some mapping on windows which convert the '_' to a '-'?\r\n\r\nyes - we apply a algorithm which is creating a slug based name (all lower case characters and numbers, - and .) is allowed.\r\n\r\nin addition there is a mapping in place with translated the file names back and forth.\r\nhave a look at oc\\files\\strorage\\mappedlocal\r\n\r\n@ringmaster can i ask you to step in here as you have some windows experience including testing and debugging capabilities - many thannks"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22778390","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22778390","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22778390,"user":{"login":"tapete","id":5229149,"avatar_url":"https://gravatar.com/avatar/4f54264b945f0f27a1d4caac2984bc25?d=https%3a%2f%2fidenticons.github.com%2f8e95453fc551ec54b190cd0ec225fd23.png&r=x","gravatar_id":"4f54264b945f0f27a1d4caac2984bc25","url":"https://api.github.com/users/tapete","html_url":"https://github.com/tapete","followers_url":"https://api.github.com/users/tapete/followers","following_url":"https://api.github.com/users/tapete/following{/other_user}","gists_url":"https://api.github.com/users/tapete/gists{/gist_id}","starred_url":"https://api.github.com/users/tapete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tapete/subscriptions","organizations_url":"https://api.github.com/users/tapete/orgs","repos_url":"https://api.github.com/users/tapete/repos","events_url":"https://api.github.com/users/tapete/events{/privacy}","received_events_url":"https://api.github.com/users/tapete/received_events","type":"user","site_admin":false},"created_at":"2013-08-16t16:45:04z","updated_at":"2013-08-16t16:45:04z","body":"@schiesbn at the moment it looks like this code solves the problem:\r\n\r\n\t\t\t// create all parent folders\r\n\t\t\t$dirname=  \\oc_filesystem::normalizepath(pathinfo($filename, pathinfo_dirname)); \r\n\t\t\t\r\n\t\t\t$begin_char = substr($dirname,0,1);\r\n\t\t\tif($begin_char==\"/\")\r\n\t\t\t{ \r\n\t\t\t\t$dirname = substr($dirname,1,strlen($dirname)-1);\r\n\t\t\t}\t\r\n\t\t\t\r\n\t\t\t$dirparts = explode('/', $dirname); \r\n\t\t\t\r\n\t\t\tif(!$versions_view->file_exists(\"files_versions\")) { \r\n\t\t\t\t$users_view->mkdir(\"files_versions\"); \r\n\t\t\t}\t\t\t\r\n\t\t    $dir = \"\";\r\n\t\t\t\r\n\t\t\tforeach ($dirparts as $part) { \r\n\t\t\t\t  $dir = $dir.'/'.$part; \t\t  \r\n\t\t\t\t  if(!$versions_view->file_exists($dir)) { \r\n\t\t\t\t\t$versions_view->mkdir($dir); \r\n\t\t\t\t  }\r\n\t\t\t}\r\n\r\ni tested path names and file names with special chars an the case that the \"files_versions\" folder does not exist. it worked and all versions have been created successfully. but i will go on trying to understand the reason for this behavior."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22793284","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22793284","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22793284,"user":{"login":"schiesbn","id":1589737,"avatar_url":"https://gravatar.com/avatar/8912b598c7b32dd25b87fd168e0b06b2?d=https%3a%2f%2fidenticons.github.com%2f0a323047dbe8329db30eae8dbe96e55e.png&r=x","gravatar_id":"8912b598c7b32dd25b87fd168e0b06b2","url":"https://api.github.com/users/schiesbn","html_url":"https://github.com/schiesbn","followers_url":"https://api.github.com/users/schiesbn/followers","following_url":"https://api.github.com/users/schiesbn/following{/other_user}","gists_url":"https://api.github.com/users/schiesbn/gists{/gist_id}","starred_url":"https://api.github.com/users/schiesbn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schiesbn/subscriptions","organizations_url":"https://api.github.com/users/schiesbn/orgs","repos_url":"https://api.github.com/users/schiesbn/repos","events_url":"https://api.github.com/users/schiesbn/events{/privacy}","received_events_url":"https://api.github.com/users/schiesbn/received_events","type":"user","site_admin":false},"created_at":"2013-08-16t20:55:05z","updated_at":"2013-08-16t20:55:05z","body":"@tapete can you try the latest code from #4427 ? this does basically the same but it starts directly in /data/user to avoid the special case if files_versions is not yet created. if you can verify that this works i would like to merge it for stable5, for master (aka oc6) i will add some more changes which will include a constructor which takes care that files_versions/ is created."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/22807221","html_url":"https://github.com/owncloud/core/issues/4425#issuecomment-22807221","issue_url":"https://api.github.com/repos/owncloud/core/issues/4425","id":22807221,"user":{"login":"tapete","id":5229149,"avatar_url":"https://gravatar.com/avatar/4f54264b945f0f27a1d4caac2984bc25?d=https%3a%2f%2fidenticons.github.com%2f8e95453fc551ec54b190cd0ec225fd23.png&r=x","gravatar_id":"4f54264b945f0f27a1d4caac2984bc25","url":"https://api.github.com/users/tapete","html_url":"https://github.com/tapete","followers_url":"https://api.github.com/users/tapete/followers","following_url":"https://api.github.com/users/tapete/following{/other_user}","gists_url":"https://api.github.com/users/tapete/gists{/gist_id}","starred_url":"https://api.github.com/users/tapete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tapete/subscriptions","organizations_url":"https://api.github.com/users/tapete/orgs","repos_url":"https://api.github.com/users/tapete/repos","events_url":"https://api.github.com/users/tapete/events{/privacy}","received_events_url":"https://api.github.com/users/tapete/received_events","type":"user","site_admin":false},"created_at":"2013-08-17t07:31:20z","updated_at":"2013-08-17t07:31:20z","body":"@schiesbn i tried #4427 before. did anything change?  i can't see the code there now. the code in my last comment is to fix two issuers in #4427 (the code, that has been there):\r\n1. creating \"files_versions\" if it does not exist\r\n2. check if $dirname starts with \"/\". this would lead to mkdir(\"/\") (error)\r\n\r\nit is important to test all fixes with a newly installed instance of owncloud. otherwise there are old pathnames in the database. i hope that all testpilots do it like this to avoid confusion.\r\n\r\ni guess that most windows related issues base on the different directory seperators. ownclouds way to handle it is not consistent. there are often path names like \"e:\\programme\\xampp\\htdocs\\owncloud2\\data/arbeit/files\" with changing seperators. apache can handle path names in this style but it might lead to bugs in the code.\r\n\r\ni saw that this issue also effects other apps. i think, to solve path name related issues, we should find a consistent way to handle path names that every developer knows. maybe there is a way but no one knows."}]