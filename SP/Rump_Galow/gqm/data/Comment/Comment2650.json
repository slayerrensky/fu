[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15778489","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15778489","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15778489,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-02t14:32:06z","updated_at":"2013-04-02t14:32:06z","body":"@icewind1991 probably \\oc\\files\\cache::getnewdata() does not get the mimetype?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15827772","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15827772","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15827772,"user":{"login":"torlasz","id":2997536,"avatar_url":"https://gravatar.com/avatar/d4184dba791f5d4ca7701cb4d40e21d2?d=https%3a%2f%2fidenticons.github.com%2fa0b69955c7185e378fc6dd2c04979570.png&r=x","gravatar_id":"d4184dba791f5d4ca7701cb4d40e21d2","url":"https://api.github.com/users/torlasz","html_url":"https://github.com/torlasz","followers_url":"https://api.github.com/users/torlasz/followers","following_url":"https://api.github.com/users/torlasz/following{/other_user}","gists_url":"https://api.github.com/users/torlasz/gists{/gist_id}","starred_url":"https://api.github.com/users/torlasz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/torlasz/subscriptions","organizations_url":"https://api.github.com/users/torlasz/orgs","repos_url":"https://api.github.com/users/torlasz/repos","events_url":"https://api.github.com/users/torlasz/events{/privacy}","received_events_url":"https://api.github.com/users/torlasz/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t09:49:03z","updated_at":"2013-04-03t09:49:03z","body":"i can confirm this, i get exactly the same error upgrading from 5.0.0 to 5.0.3"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15844659","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15844659","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15844659,"user":{"login":"soulianis","id":4049829,"avatar_url":"https://gravatar.com/avatar/b81b17b8459e5836c73cffaf5c361bf7?d=https%3a%2f%2fidenticons.github.com%2f33f3b1fec1f2c97b6ba47929387f7b81.png&r=x","gravatar_id":"b81b17b8459e5836c73cffaf5c361bf7","url":"https://api.github.com/users/soulianis","html_url":"https://github.com/soulianis","followers_url":"https://api.github.com/users/soulianis/followers","following_url":"https://api.github.com/users/soulianis/following{/other_user}","gists_url":"https://api.github.com/users/soulianis/gists{/gist_id}","starred_url":"https://api.github.com/users/soulianis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/soulianis/subscriptions","organizations_url":"https://api.github.com/users/soulianis/orgs","repos_url":"https://api.github.com/users/soulianis/repos","events_url":"https://api.github.com/users/soulianis/events{/privacy}","received_events_url":"https://api.github.com/users/soulianis/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t15:47:34z","updated_at":"2013-04-03t15:47:34z","body":"confirmed:\r\n\r\n1) clean update from 4.5.6 to 5.0.3\r\n-> sqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n\r\n2) clean update from 4.5.6 to 5.0.0\r\n-> ok\r\n\r\n3) clean update from 5.0.0 to 5.0.3\r\n-> sqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n\r\nchecking the contents of the oc_filecache and oc_fscache and oc_mimetypes tables, i don't have any null values in any mimetype column.\r\n\r\nthese are the warnings i find in the log:\r\n\r\nwarning\tphp\tundefined index: mimetype at owncloud/lib/files/cache/upgrade.php#137\t03.04.2013 17:35\r\nwarning\tphp\tundefined index: writable at owncloud/lib/files/cache/upgrade.php#135\t03.04.2013 17:35\r\nwarning\tphp\tundefined index: parent at owncloud/lib/files/cache/upgrade.php#134\t03.04.2013 17:35\r\nwarning\tphp\tundefined index: path at owncloud/lib/files/cache/upgrade.php#128\t03.04.2013 17:35\r\nwarning\tphp\tundefined offset: 1 at owncloud/lib/files/cache/legacy.php#88\t03.04.2013 17:35\r\nwarning\tphp\tundefined offset: 3 at owncloud/lib/files/cache/legacy.php#88\t03.04.2013 17:35\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15847774","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15847774","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15847774,"user":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t16:36:03z","updated_at":"2013-04-03t16:36:03z","body":"@icewind1991 @raydiation @bartv2 could you look into that?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15852612","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15852612","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15852612,"user":{"login":"smiddy","id":4051014,"avatar_url":"https://gravatar.com/avatar/ac9f3b1e8b002e099c8af320a555053c?d=https%3a%2f%2fidenticons.github.com%2f2c55551ecddeac019b3918c932774d99.png&r=x","gravatar_id":"ac9f3b1e8b002e099c8af320a555053c","url":"https://api.github.com/users/smiddy","html_url":"https://github.com/smiddy","followers_url":"https://api.github.com/users/smiddy/followers","following_url":"https://api.github.com/users/smiddy/following{/other_user}","gists_url":"https://api.github.com/users/smiddy/gists{/gist_id}","starred_url":"https://api.github.com/users/smiddy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smiddy/subscriptions","organizations_url":"https://api.github.com/users/smiddy/orgs","repos_url":"https://api.github.com/users/smiddy/repos","events_url":"https://api.github.com/users/smiddy/events{/privacy}","received_events_url":"https://api.github.com/users/smiddy/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t17:54:20z","updated_at":"2013-04-03t17:54:20z","body":"i have a similar problem.\r\n\r\nwhen updating from 4.5.8 to 5.0.3 i get:\r\n\r\nturned on maintenance mode\r\nupdated database\r\nsqlstate[23000]: integrity constraint violation: 19 oc_mimetypes.mimetype may not be null"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15852662","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15852662","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15852662,"user":{"login":"ernstae","id":3441274,"avatar_url":"https://gravatar.com/avatar/99b3db7a9bb4923c43667ee8e6739afa?d=https%3a%2f%2fidenticons.github.com%2f00a55b88396933c350df5831096340d0.png&r=x","gravatar_id":"99b3db7a9bb4923c43667ee8e6739afa","url":"https://api.github.com/users/ernstae","html_url":"https://github.com/ernstae","followers_url":"https://api.github.com/users/ernstae/followers","following_url":"https://api.github.com/users/ernstae/following{/other_user}","gists_url":"https://api.github.com/users/ernstae/gists{/gist_id}","starred_url":"https://api.github.com/users/ernstae/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernstae/subscriptions","organizations_url":"https://api.github.com/users/ernstae/orgs","repos_url":"https://api.github.com/users/ernstae/repos","events_url":"https://api.github.com/users/ernstae/events{/privacy}","received_events_url":"https://api.github.com/users/ernstae/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t17:54:56z","updated_at":"2013-04-03t17:54:56z","body":"i'm seeing the same things upon a 5.0.0 --> 5.0.3:\r\n\r\n... 34% done ...\r\n... 35% done ...\r\n... 36% done ...\r\n... 37% done ...\r\n... 38% done ...\r\nsqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n\r\nthe update was unsuccessful. please report this issue to the owncloud community.\r\n\r\nowncloud.log:\r\n\r\n{\"app\":\"php\",\"message\":\"undefined offset: 3 at \\/websftp\\/web\\/owncloud\\/lib\\/files\\/cache\\/legacy.php#88\",\"level\":2,\"time\":1365011435}\r\n{\"app\":\"php\",\"message\":\"undefined offset: 1 at \\/websftp\\/web\\/owncloud\\/lib\\/files\\/cache\\/legacy.php#88\",\"level\":2,\"time\":1365011435}\r\n{\"app\":\"php\",\"message\":\"undefined index: path at \\/websftp\\/web\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#128\",\"level\":2,\"time\":1365011435}\r\n{\"app\":\"php\",\"message\":\"undefined index: parent at \\/websftp\\/web\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#134\",\"level\":2,\"time\":1365011435}\r\n{\"app\":\"php\",\"message\":\"undefined index: writable at \\/websftp\\/web\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#135\",\"level\":2,\"time\":1365011435}\r\n{\"app\":\"php\",\"message\":\"undefined index: mimetype at \\/websftp\\/web\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#137\",\"level\":2,\"time\":1365011435}"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15857533","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15857533","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15857533,"user":{"login":"alyarmak","id":4051943,"avatar_url":"https://gravatar.com/avatar/e4c4f61ee86498a3005a7448455a30c0?d=https%3a%2f%2fidenticons.github.com%2f4fce3b62afcddf2eea52bb241616ab32.png&r=x","gravatar_id":"e4c4f61ee86498a3005a7448455a30c0","url":"https://api.github.com/users/alyarmak","html_url":"https://github.com/alyarmak","followers_url":"https://api.github.com/users/alyarmak/followers","following_url":"https://api.github.com/users/alyarmak/following{/other_user}","gists_url":"https://api.github.com/users/alyarmak/gists{/gist_id}","starred_url":"https://api.github.com/users/alyarmak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alyarmak/subscriptions","organizations_url":"https://api.github.com/users/alyarmak/orgs","repos_url":"https://api.github.com/users/alyarmak/repos","events_url":"https://api.github.com/users/alyarmak/events{/privacy}","received_events_url":"https://api.github.com/users/alyarmak/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t19:10:20z","updated_at":"2013-04-03t19:10:20z","body":"i have the same problem 5.0.0 --> 5.0.3\r\n\r\nturned on maintenance mode\r\nupdated database\r\nupdating filecache, this may take really long...\r\n... 16% done ...\r\nsqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15861676","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15861676","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15861676,"user":{"login":"felixgilles","id":900854,"avatar_url":"https://gravatar.com/avatar/495cd4626f5857f6290c3d929882c2dd?d=https%3a%2f%2fidenticons.github.com%2f4fca63e77bfdb43710e9a6a8ca1d6ba9.png&r=x","gravatar_id":"495cd4626f5857f6290c3d929882c2dd","url":"https://api.github.com/users/felixgilles","html_url":"https://github.com/felixgilles","followers_url":"https://api.github.com/users/felixgilles/followers","following_url":"https://api.github.com/users/felixgilles/following{/other_user}","gists_url":"https://api.github.com/users/felixgilles/gists{/gist_id}","starred_url":"https://api.github.com/users/felixgilles/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/felixgilles/subscriptions","organizations_url":"https://api.github.com/users/felixgilles/orgs","repos_url":"https://api.github.com/users/felixgilles/repos","events_url":"https://api.github.com/users/felixgilles/events{/privacy}","received_events_url":"https://api.github.com/users/felixgilles/received_events","type":"user","site_admin":false},"created_at":"2013-04-03t20:18:43z","updated_at":"2013-04-03t20:18:43z","body":"hi,\r\n\r\nsame issue, from 5.0.0 to 5.0.3\r\n\r\nturned on maintenance mode\r\nupdated database\r\nupdating filecache, this may take really long...\r\n... 25% done ...\r\n... 50% done ...\r\nsqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n\r\ncan i help (give you an error log file) ?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15884795","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15884795","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15884795,"user":{"login":"sesceu","id":1614558,"avatar_url":"https://gravatar.com/avatar/da58081055ec177534b891f07b6cd027?d=https%3a%2f%2fidenticons.github.com%2f44081e76d64fd3e2295a300ec1b03d6c.png&r=x","gravatar_id":"da58081055ec177534b891f07b6cd027","url":"https://api.github.com/users/sesceu","html_url":"https://github.com/sesceu","followers_url":"https://api.github.com/users/sesceu/followers","following_url":"https://api.github.com/users/sesceu/following{/other_user}","gists_url":"https://api.github.com/users/sesceu/gists{/gist_id}","starred_url":"https://api.github.com/users/sesceu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sesceu/subscriptions","organizations_url":"https://api.github.com/users/sesceu/orgs","repos_url":"https://api.github.com/users/sesceu/repos","events_url":"https://api.github.com/users/sesceu/events{/privacy}","received_events_url":"https://api.github.com/users/sesceu/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t08:12:05z","updated_at":"2013-04-04t08:12:05z","body":"the excact same thing happened to me: update from 5.0.0 to 5.0.3 leads to integrity constraint violation."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15885656","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15885656","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15885656,"user":{"login":"karlitschek","id":867445,"avatar_url":"https://gravatar.com/avatar/87ce2b4531ee1a0c32b50e0d8f049224?d=https%3a%2f%2fidenticons.github.com%2f06e7098636caebfc9c30c9f52eb905df.png&r=x","gravatar_id":"87ce2b4531ee1a0c32b50e0d8f049224","url":"https://api.github.com/users/karlitschek","html_url":"https://github.com/karlitschek","followers_url":"https://api.github.com/users/karlitschek/followers","following_url":"https://api.github.com/users/karlitschek/following{/other_user}","gists_url":"https://api.github.com/users/karlitschek/gists{/gist_id}","starred_url":"https://api.github.com/users/karlitschek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karlitschek/subscriptions","organizations_url":"https://api.github.com/users/karlitschek/orgs","repos_url":"https://api.github.com/users/karlitschek/repos","events_url":"https://api.github.com/users/karlitschek/events{/privacy}","received_events_url":"https://api.github.com/users/karlitschek/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t08:33:09z","updated_at":"2013-04-04t08:33:09z","body":"@icewind1991 @blizzz @bartv2 can you have a look?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15886954","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15886954","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15886954,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t09:10:59z","updated_at":"2013-04-04t09:10:59z","body":"@icewind1991 \r\nin https://github.com/owncloud/core/blob/stable5/lib/files/cache/upgrade.php#l137 and https://github.com/owncloud/core/blob/stable5/lib/files/cache/upgrade.php#l138 should not $newdata['mimetype'] and $newdata['mimepart'] be $data['mimetype'] and $data['mimepart']  instead?\r\n\r\ncould the others try with that change? "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15887040","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15887040","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15887040,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t09:13:08z","updated_at":"2013-04-04t09:13:08z","body":"as i am absolutely not unable to reproduce this, let us shoot a bit more into the blue.\r\n\r\nthose with the issue, could you try add following code before https://github.com/owncloud/core/blob/stable5/lib/files/cache/upgrade.php#l202\r\n```\r\nif(!$user) {\r\n    return;\r\n}\r\n```"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15887417","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15887417","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15887417,"user":{"login":"sesceu","id":1614558,"avatar_url":"https://gravatar.com/avatar/da58081055ec177534b891f07b6cd027?d=https%3a%2f%2fidenticons.github.com%2f44081e76d64fd3e2295a300ec1b03d6c.png&r=x","gravatar_id":"da58081055ec177534b891f07b6cd027","url":"https://api.github.com/users/sesceu","html_url":"https://github.com/sesceu","followers_url":"https://api.github.com/users/sesceu/followers","following_url":"https://api.github.com/users/sesceu/following{/other_user}","gists_url":"https://api.github.com/users/sesceu/gists{/gist_id}","starred_url":"https://api.github.com/users/sesceu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sesceu/subscriptions","organizations_url":"https://api.github.com/users/sesceu/orgs","repos_url":"https://api.github.com/users/sesceu/repos","events_url":"https://api.github.com/users/sesceu/events{/privacy}","received_events_url":"https://api.github.com/users/sesceu/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t09:23:40z","updated_at":"2013-04-04t09:25:13z","body":"i added the returnifusernotdefined-code and changed config/config.php:maintenance to false.\r\n\r\nwhen i now reload the page i see no difference:\r\n```\r\nturned on maintenance mode\r\nupdated database\r\nsqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n```\r\n\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15887745","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15887745","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15887745,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t09:30:49z","updated_at":"2013-04-04t09:30:49z","body":"did you also  change what i suggested in https://github.com/owncloud/core/issues/2650#issuecomment-15886954 ?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15888162","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15888162","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15888162,"user":{"login":"sesceu","id":1614558,"avatar_url":"https://gravatar.com/avatar/da58081055ec177534b891f07b6cd027?d=https%3a%2f%2fidenticons.github.com%2f44081e76d64fd3e2295a300ec1b03d6c.png&r=x","gravatar_id":"da58081055ec177534b891f07b6cd027","url":"https://api.github.com/users/sesceu","html_url":"https://github.com/sesceu","followers_url":"https://api.github.com/users/sesceu/followers","following_url":"https://api.github.com/users/sesceu/following{/other_user}","gists_url":"https://api.github.com/users/sesceu/gists{/gist_id}","starred_url":"https://api.github.com/users/sesceu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sesceu/subscriptions","organizations_url":"https://api.github.com/users/sesceu/orgs","repos_url":"https://api.github.com/users/sesceu/repos","events_url":"https://api.github.com/users/sesceu/events{/privacy}","received_events_url":"https://api.github.com/users/sesceu/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t09:40:23z","updated_at":"2013-04-04t09:40:23z","body":"not when i posted this: https://github.com/owncloud/core/issues/2650#issuecomment-15887417\r\n\r\n but i tried again with all your suggestions, but still no difference."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15889701","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15889701","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15889701,"user":{"login":"cnlpete","id":167434,"avatar_url":"https://gravatar.com/avatar/adb5cd325bfb7cb2a2bd19e1ddc16d6d?d=https%3a%2f%2fidenticons.github.com%2f9a31a833fc72260231972140bbd3a45e.png&r=x","gravatar_id":"adb5cd325bfb7cb2a2bd19e1ddc16d6d","url":"https://api.github.com/users/cnlpete","html_url":"https://github.com/cnlpete","followers_url":"https://api.github.com/users/cnlpete/followers","following_url":"https://api.github.com/users/cnlpete/following{/other_user}","gists_url":"https://api.github.com/users/cnlpete/gists{/gist_id}","starred_url":"https://api.github.com/users/cnlpete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cnlpete/subscriptions","organizations_url":"https://api.github.com/users/cnlpete/orgs","repos_url":"https://api.github.com/users/cnlpete/repos","events_url":"https://api.github.com/users/cnlpete/events{/privacy}","received_events_url":"https://api.github.com/users/cnlpete/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t10:22:08z","updated_at":"2013-04-04t10:22:08z","body":"hm, i had this issue as well, applying the !user fix in https://github.com/owncloud/core/issues/2650#issuecomment-15887040 , turning off maintenance and rerunning the update turned out ok"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15890511","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15890511","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15890511,"user":{"login":"sesceu","id":1614558,"avatar_url":"https://gravatar.com/avatar/da58081055ec177534b891f07b6cd027?d=https%3a%2f%2fidenticons.github.com%2f44081e76d64fd3e2295a300ec1b03d6c.png&r=x","gravatar_id":"da58081055ec177534b891f07b6cd027","url":"https://api.github.com/users/sesceu","html_url":"https://github.com/sesceu","followers_url":"https://api.github.com/users/sesceu/followers","following_url":"https://api.github.com/users/sesceu/following{/other_user}","gists_url":"https://api.github.com/users/sesceu/gists{/gist_id}","starred_url":"https://api.github.com/users/sesceu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sesceu/subscriptions","organizations_url":"https://api.github.com/users/sesceu/orgs","repos_url":"https://api.github.com/users/sesceu/repos","events_url":"https://api.github.com/users/sesceu/events{/privacy}","received_events_url":"https://api.github.com/users/sesceu/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t10:45:00z","updated_at":"2013-04-04t10:45:00z","body":"how did you rerun the update? did you just reload the page, or did you reinstall the updated files?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15890916","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15890916","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15890916,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t10:55:55z","updated_at":"2013-04-04t10:55:55z","body":"remove the maintenance mode line in config/config.php and refresh the browser."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15891279","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15891279","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15891279,"user":{"login":"sesceu","id":1614558,"avatar_url":"https://gravatar.com/avatar/da58081055ec177534b891f07b6cd027?d=https%3a%2f%2fidenticons.github.com%2f44081e76d64fd3e2295a300ec1b03d6c.png&r=x","gravatar_id":"da58081055ec177534b891f07b6cd027","url":"https://api.github.com/users/sesceu","html_url":"https://github.com/sesceu","followers_url":"https://api.github.com/users/sesceu/followers","following_url":"https://api.github.com/users/sesceu/following{/other_user}","gists_url":"https://api.github.com/users/sesceu/gists{/gist_id}","starred_url":"https://api.github.com/users/sesceu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sesceu/subscriptions","organizations_url":"https://api.github.com/users/sesceu/orgs","repos_url":"https://api.github.com/users/sesceu/repos","events_url":"https://api.github.com/users/sesceu/events{/privacy}","received_events_url":"https://api.github.com/users/sesceu/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t11:05:08z","updated_at":"2013-04-04t11:05:08z","body":"ok, that's what i did in https://github.com/owncloud/core/issues/2650#issuecomment-15887417 and didn't work. anyways, i tried it again right now, but i'm still seeing the same error message."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15892747","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15892747","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15892747,"user":{"login":"torlasz","id":2997536,"avatar_url":"https://gravatar.com/avatar/d4184dba791f5d4ca7701cb4d40e21d2?d=https%3a%2f%2fidenticons.github.com%2fa0b69955c7185e378fc6dd2c04979570.png&r=x","gravatar_id":"d4184dba791f5d4ca7701cb4d40e21d2","url":"https://api.github.com/users/torlasz","html_url":"https://github.com/torlasz","followers_url":"https://api.github.com/users/torlasz/followers","following_url":"https://api.github.com/users/torlasz/following{/other_user}","gists_url":"https://api.github.com/users/torlasz/gists{/gist_id}","starred_url":"https://api.github.com/users/torlasz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/torlasz/subscriptions","organizations_url":"https://api.github.com/users/torlasz/orgs","repos_url":"https://api.github.com/users/torlasz/repos","events_url":"https://api.github.com/users/torlasz/events{/privacy}","received_events_url":"https://api.github.com/users/torlasz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t11:46:09z","updated_at":"2013-04-04t11:46:09z","body":"@blizz you mean like this, right?\r\n     $newdata['mimetype'] = $this->getmimetypeid($data['mimetype'], $storage);\r\n     $newdata['mimepart'] = $this->getmimetypeid($data['mimepart'], $storage);\r\nthat's what i did in /lib/files/cache/upgrade.php, plus inserting the !$user part at the right place. doesn't matter if i do the changes before attempting the upgrade or after that, the error just stays the same, cannot finish the upgrade:\r\nsqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n\r\nhere is the owncloud log:\r\n{\"app\":\"core\",\"message\":\"adding user backend instance of oc_user_database.\",\"level\":0,\"time\":1365075733}\r\n{\"app\":\"core\",\"message\":\"starting upgrade from 5.0.0 to 5.0.3\",\"level\":0,\"time\":1365075733}\r\n{\"app\":\"core\",\"message\":\"adding user backend instance of oc_user_database.\",\"level\":0,\"time\":1365075733}\r\n{\"app\":\"core\",\"message\":\"adding user backend instance of oc_user_database.\",\"level\":0,\"time\":1365075733}\r\n{\"app\":\"php\",\"message\":\"undefined offset: 3 at \\/var\\/www\\/oc2\\/lib\\/files\\/cache\\/legacy.php#88\",\"level\":2,\"time\":1365075734}\r\n{\"app\":\"php\",\"message\":\"undefined offset: 1 at \\/var\\/www\\/oc2\\/lib\\/files\\/cache\\/legacy.php#88\",\"level\":2,\"time\":1365075734}\r\n{\"app\":\"php\",\"message\":\"undefined index: path at \\/var\\/www\\/oc2\\/lib\\/files\\/cache\\/upgrade.php#128\",\"level\":2,\"time\":1365075734}\r\n{\"app\":\"php\",\"message\":\"undefined index: parent at \\/var\\/www\\/oc2\\/lib\\/files\\/cache\\/upgrade.php#134\",\"level\":2,\"time\":1365075734}\r\n{\"app\":\"php\",\"message\":\"undefined index: writable at \\/var\\/www\\/oc2\\/lib\\/files\\/cache\\/upgrade.php#135\",\"level\":2,\"time\":1365075734}\r\n{\"app\":\"php\",\"message\":\"undefined index: mimetype at \\/var\\/www\\/oc2\\/lib\\/files\\/cache\\/upgrade.php#137\",\"level\":2,\"time\":1365075734}\r\n{\"app\":\"core\",\"message\":\"adding user backend instance of oc_user_database.\",\"level\":0,\"time\":1365075734}\r\n{\"app\":\"core\",\"message\":\"adding user backend instance of oc_user_database.\",\"level\":0,\"time\":1365075734}\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15899127","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15899127","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15899127,"user":{"login":"thg4gh","id":4059453,"avatar_url":"https://gravatar.com/avatar/dd03bb4f412d69c1e68a78b99fc15c86?d=https%3a%2f%2fidenticons.github.com%2f5c00f3eacd8233f311d8356f520bbe20.png&r=x","gravatar_id":"dd03bb4f412d69c1e68a78b99fc15c86","url":"https://api.github.com/users/thg4gh","html_url":"https://github.com/thg4gh","followers_url":"https://api.github.com/users/thg4gh/followers","following_url":"https://api.github.com/users/thg4gh/following{/other_user}","gists_url":"https://api.github.com/users/thg4gh/gists{/gist_id}","starred_url":"https://api.github.com/users/thg4gh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thg4gh/subscriptions","organizations_url":"https://api.github.com/users/thg4gh/orgs","repos_url":"https://api.github.com/users/thg4gh/repos","events_url":"https://api.github.com/users/thg4gh/events{/privacy}","received_events_url":"https://api.github.com/users/thg4gh/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t14:08:01z","updated_at":"2013-04-04t14:14:46z","body":"hi,\r\n\r\njust for information, i had the same issue when updating from 5.0.0 to 5.0.3:\r\n\r\n```\r\naktualisiere owncloud auf version 5.0.3. dies kã¶nnte eine weile dauern.\r\n\r\nturned on maintenance mode\r\nupdated database\r\nupdating filecache, this may take really long...\r\n... 8% done ...\r\n... 16% done ...\r\n... 25% done ...\r\n... 33% done ...\r\n... 41% done ...\r\nsqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n\r\nthe update was unsuccessful. please report this issue to the owncloud community.\r\n```\r\n\r\ni just restored a backup to get it working again ...\r\n\r\nthanks,\r\n\r\nthg"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15907162","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15907162","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15907162,"user":{"login":"ernstae","id":3441274,"avatar_url":"https://gravatar.com/avatar/99b3db7a9bb4923c43667ee8e6739afa?d=https%3a%2f%2fidenticons.github.com%2f00a55b88396933c350df5831096340d0.png&r=x","gravatar_id":"99b3db7a9bb4923c43667ee8e6739afa","url":"https://api.github.com/users/ernstae","html_url":"https://github.com/ernstae","followers_url":"https://api.github.com/users/ernstae/followers","following_url":"https://api.github.com/users/ernstae/following{/other_user}","gists_url":"https://api.github.com/users/ernstae/gists{/gist_id}","starred_url":"https://api.github.com/users/ernstae/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernstae/subscriptions","organizations_url":"https://api.github.com/users/ernstae/orgs","repos_url":"https://api.github.com/users/ernstae/repos","events_url":"https://api.github.com/users/ernstae/events{/privacy}","received_events_url":"https://api.github.com/users/ernstae/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t16:14:03z","updated_at":"2013-04-04t16:14:03z","body":"@blizzz -- i put the !user code on line 202 and completed a successful upgrade.  for users who want confirmation of what this should look like:\r\n\r\n\r\n       public static function dosilentupgrade($user) {\r\n          if(!$user) {\r\n            return;\r\n          }\r\n          if(!self::needupgrade($user)) {\r\n            return;\r\n          }\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15908511","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15908511","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15908511,"user":{"login":"thg4gh","id":4059453,"avatar_url":"https://gravatar.com/avatar/dd03bb4f412d69c1e68a78b99fc15c86?d=https%3a%2f%2fidenticons.github.com%2f5c00f3eacd8233f311d8356f520bbe20.png&r=x","gravatar_id":"dd03bb4f412d69c1e68a78b99fc15c86","url":"https://api.github.com/users/thg4gh","html_url":"https://github.com/thg4gh","followers_url":"https://api.github.com/users/thg4gh/followers","following_url":"https://api.github.com/users/thg4gh/following{/other_user}","gists_url":"https://api.github.com/users/thg4gh/gists{/gist_id}","starred_url":"https://api.github.com/users/thg4gh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thg4gh/subscriptions","organizations_url":"https://api.github.com/users/thg4gh/orgs","repos_url":"https://api.github.com/users/thg4gh/repos","events_url":"https://api.github.com/users/thg4gh/events{/privacy}","received_events_url":"https://api.github.com/users/thg4gh/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t16:36:54z","updated_at":"2013-04-04t16:36:54z","body":"hi blizzz,\r\n\r\nthanks for the suggestion, but it didn't changed.\r\n\r\ni reverted to the failed 5.0.3 from yesterday and i added the above to \"lib/files/cache/upgrade.php\", in the \"config/config.php\" i set 'maintenance' to false and made a browser refresh.\r\n\r\ni still get:\r\n```\r\n ... 41% done ...\r\nsqlstate[23000]: integrity constraint violation: 1048 column 'mimetype' cannot be null\r\n```"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15913504","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15913504","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15913504,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t18:04:10z","updated_at":"2013-04-04t18:04:10z","body":"@torlasz please write blizzz with 3 z. the spelling with only 2 z addresses a different user.\r\n\r\nbut that is exactly what i meant.\r\ncould please try the following:\r\n\r\nadd \r\n```\r\noc_log::write('core', 'filecache upgrade for user: '.$user, oc_log::debug);\r\n```\r\nin lib/files/cache/upgrade.php after the \r\n```\r\n\t\tif(!self::needupgrade($user)) {\r\n\t\t\treturn;\r\n\t\t}\r\n```\r\nblock please.\r\n\r\nplease also add in the same file in the function getnewdata before the list-line following:\r\n```\r\noc_log::write('core', 'old data: '.print_r($data, true), oc_log::debug);\r\n```\r\n\r\nrun the upgrade again and please post the log here. would be really great and helpful."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15914516","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15914516","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15914516,"user":{"login":"ernstae","id":3441274,"avatar_url":"https://gravatar.com/avatar/99b3db7a9bb4923c43667ee8e6739afa?d=https%3a%2f%2fidenticons.github.com%2f00a55b88396933c350df5831096340d0.png&r=x","gravatar_id":"99b3db7a9bb4923c43667ee8e6739afa","url":"https://api.github.com/users/ernstae","html_url":"https://github.com/ernstae","followers_url":"https://api.github.com/users/ernstae/followers","following_url":"https://api.github.com/users/ernstae/following{/other_user}","gists_url":"https://api.github.com/users/ernstae/gists{/gist_id}","starred_url":"https://api.github.com/users/ernstae/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernstae/subscriptions","organizations_url":"https://api.github.com/users/ernstae/orgs","repos_url":"https://api.github.com/users/ernstae/repos","events_url":"https://api.github.com/users/ernstae/events{/privacy}","received_events_url":"https://api.github.com/users/ernstae/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t18:21:54z","updated_at":"2013-04-04t18:21:54z","body":"my understanding of this issue... is that as the filesystem is traversed, there might be orphaned directories owned by users that have been removed from the owncloud system (e.g. in the case of active directory, a user who has been removed from the active ou that we're pulling our users from).  when the upgrade process is started, it encounters a directory for a non-existent user, and there wasn't a check to see if that user still exists?"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15916607","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15916607","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15916607,"user":{"login":"thg4gh","id":4059453,"avatar_url":"https://gravatar.com/avatar/dd03bb4f412d69c1e68a78b99fc15c86?d=https%3a%2f%2fidenticons.github.com%2f5c00f3eacd8233f311d8356f520bbe20.png&r=x","gravatar_id":"dd03bb4f412d69c1e68a78b99fc15c86","url":"https://api.github.com/users/thg4gh","html_url":"https://github.com/thg4gh","followers_url":"https://api.github.com/users/thg4gh/followers","following_url":"https://api.github.com/users/thg4gh/following{/other_user}","gists_url":"https://api.github.com/users/thg4gh/gists{/gist_id}","starred_url":"https://api.github.com/users/thg4gh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thg4gh/subscriptions","organizations_url":"https://api.github.com/users/thg4gh/orgs","repos_url":"https://api.github.com/users/thg4gh/repos","events_url":"https://api.github.com/users/thg4gh/events{/privacy}","received_events_url":"https://api.github.com/users/thg4gh/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t18:56:59z","updated_at":"2013-04-04t18:56:59z","body":"@blizzz:\r\n\r\ni have done as suggested, but now i'm in an endless loop:\r\n\r\n````\r\naktualisiere owncloud auf version 5.0.3. dies kã¶nnte eine weile dauern.\r\n\r\nturned on maintenance mode\r\nupdated database\r\nupdating filecache, this may take really long...\r\n... 8% done ...\r\n... 16% done ...\r\n... 25% done ...\r\n... 33% done ...\r\n... 41% done ...\r\nturned on maintenance mode\r\nupdated database\r\nupdating filecache, this may take really long...\r\n... 8% done ...\r\n... 16% done ...\r\n... 25% done ...\r\n... 33% done ...\r\n... 41% done ...\r\nturned on maintenance mode\r\nupdated database\r\nupdating filecache, this may take really long...\r\n... 8% done ...\r\n... 16% done ...\r\n...\r\n..\r\n.\r\n```\r\n\r\nand the \"data/owncloud.log\" says:\r\n\r\n```\r\n...\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365101506}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365101513}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365101517}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365101521}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365101525}\r\n```\r\n\r\n@ernstae: for my installation (on centos 5) i can say for sure, that there was no user change at all.\r\n\r\nany ideas?\r\n\r\nthanks a lot thg"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15917079","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15917079","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15917079,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t19:05:03z","updated_at":"2013-04-04t19:19:54z","body":"@thg4gh my bad, i am sorry, there needs to be a \\ in front of oc_log, like\r\n```\r\n\\oc_log::write('core', 'old data: '.print_r($data, true), \\oc_log::debug);\r\n```\r\n\r\nupdate: forgot even second \\"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15917210","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15917210","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15917210,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t19:07:40z","updated_at":"2013-04-04t19:07:40z","body":"@ernstae thanks for your thoughts, at least \"old\" files in the old cache could indeed play a roll.. i will check this."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15917983","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15917983","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15917983,"user":{"login":"thg4gh","id":4059453,"avatar_url":"https://gravatar.com/avatar/dd03bb4f412d69c1e68a78b99fc15c86?d=https%3a%2f%2fidenticons.github.com%2f5c00f3eacd8233f311d8356f520bbe20.png&r=x","gravatar_id":"dd03bb4f412d69c1e68a78b99fc15c86","url":"https://api.github.com/users/thg4gh","html_url":"https://github.com/thg4gh","followers_url":"https://api.github.com/users/thg4gh/followers","following_url":"https://api.github.com/users/thg4gh/following{/other_user}","gists_url":"https://api.github.com/users/thg4gh/gists{/gist_id}","starred_url":"https://api.github.com/users/thg4gh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thg4gh/subscriptions","organizations_url":"https://api.github.com/users/thg4gh/orgs","repos_url":"https://api.github.com/users/thg4gh/repos","events_url":"https://api.github.com/users/thg4gh/events{/privacy}","received_events_url":"https://api.github.com/users/thg4gh/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t19:21:20z","updated_at":"2013-04-04t19:21:20z","body":"hi,\r\n\r\nno still the same:\r\n\r\n```\r\n        function getnewdata($data) {\r\n                $newdata = $data;\r\n                /**\r\n                 * @var \\oc\\files\\storage\\storage $storage\r\n                 * @var string $internalpath;\r\n                 */\r\n\\oc_log::write('core', 'old data: '.print_r($data, true), oc_log::debug);\r\n                list($storage, $internalpath) = \\oc\\files\\filesystem::resolvepath($data['path']);\r\n                if ($storage) {\r\n...\r\n...\r\n...\r\n        public static function dosilentupgrade($user) {\r\n                if(!$user) {\r\n                        return;\r\n                }\r\n                if(!self::needupgrade($user)) {\r\n                        return;\r\n                }\r\n\\oc_log::write('core', 'filecache upgrade for user: '.$user, oc_log::debug);\r\n                $legacy = new \\oc\\files\\cache\\legacy($user);\r\n                if ($legacy->hasitems()) {\r\n                        \\oc_db::begintransaction();\r\n```\r\n\r\nthe log says:\r\n\r\n```\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102912}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102916}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102920}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102924}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102928}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102932}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102936}\r\n{\"app\":\"php\",\"message\":\"class 'oc\\\\files\\\\cache\\\\oc_log' not found at \\/srv\\/www\\/owncloud\\/lib\\/files\\/cache\\/upgrade.php#209\",\"level\":4,\"time\":1365102940}\r\n```\r\n\r\nthanks, thg"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/15918073","html_url":"https://github.com/owncloud/core/issues/2650#issuecomment-15918073","issue_url":"https://api.github.com/repos/owncloud/core/issues/2650","id":15918073,"user":{"login":"blizzz","id":2184312,"avatar_url":"https://gravatar.com/avatar/1898b25a9cb3aa1a0f0febd1359910b9?d=https%3a%2f%2fidenticons.github.com%2fca03acec6deadf508b75eb0cf9ba036c.png&r=x","gravatar_id":"1898b25a9cb3aa1a0f0febd1359910b9","url":"https://api.github.com/users/blizzz","html_url":"https://github.com/blizzz","followers_url":"https://api.github.com/users/blizzz/followers","following_url":"https://api.github.com/users/blizzz/following{/other_user}","gists_url":"https://api.github.com/users/blizzz/gists{/gist_id}","starred_url":"https://api.github.com/users/blizzz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blizzz/subscriptions","organizations_url":"https://api.github.com/users/blizzz/orgs","repos_url":"https://api.github.com/users/blizzz/repos","events_url":"https://api.github.com/users/blizzz/events{/privacy}","received_events_url":"https://api.github.com/users/blizzz/received_events","type":"user","site_admin":false},"created_at":"2013-04-04t19:22:48z","updated_at":"2013-04-04t19:22:48z","body":"@thg4gh also a \\ for the second oc_log"}]