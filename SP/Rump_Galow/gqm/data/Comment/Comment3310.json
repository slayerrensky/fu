[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/17770065","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-17770065","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":17770065,"user":{"login":"infoneo","id":4140590,"avatar_url":"https://gravatar.com/avatar/bc0a26326f8748680a48ed4ccc64a15b?d=https%3a%2f%2fidenticons.github.com%2ffbb06d5e5e769ae263f1c887fd5eadff.png&r=x","gravatar_id":"bc0a26326f8748680a48ed4ccc64a15b","url":"https://api.github.com/users/infoneo","html_url":"https://github.com/infoneo","followers_url":"https://api.github.com/users/infoneo/followers","following_url":"https://api.github.com/users/infoneo/following{/other_user}","gists_url":"https://api.github.com/users/infoneo/gists{/gist_id}","starred_url":"https://api.github.com/users/infoneo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/infoneo/subscriptions","organizations_url":"https://api.github.com/users/infoneo/orgs","repos_url":"https://api.github.com/users/infoneo/repos","events_url":"https://api.github.com/users/infoneo/events{/privacy}","received_events_url":"https://api.github.com/users/infoneo/received_events","type":"user","site_admin":false},"created_at":"2013-05-12t00:23:01z","updated_at":"2013-05-12t00:23:01z","body":"#3152 \r\n#2907 "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/17775242","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-17775242","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":17775242,"user":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"created_at":"2013-05-12t09:31:23z","updated_at":"2013-05-12t09:31:23z","body":"unit tests? "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/17779083","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-17779083","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":17779083,"user":{"login":"infoneo","id":4140590,"avatar_url":"https://gravatar.com/avatar/bc0a26326f8748680a48ed4ccc64a15b?d=https%3a%2f%2fidenticons.github.com%2ffbb06d5e5e769ae263f1c887fd5eadff.png&r=x","gravatar_id":"bc0a26326f8748680a48ed4ccc64a15b","url":"https://api.github.com/users/infoneo","html_url":"https://github.com/infoneo","followers_url":"https://api.github.com/users/infoneo/followers","following_url":"https://api.github.com/users/infoneo/following{/other_user}","gists_url":"https://api.github.com/users/infoneo/gists{/gist_id}","starred_url":"https://api.github.com/users/infoneo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/infoneo/subscriptions","organizations_url":"https://api.github.com/users/infoneo/orgs","repos_url":"https://api.github.com/users/infoneo/repos","events_url":"https://api.github.com/users/infoneo/events{/privacy}","received_events_url":"https://api.github.com/users/infoneo/received_events","type":"user","site_admin":false},"created_at":"2013-05-12t14:51:25z","updated_at":"2013-05-12t14:51:25z","body":"\r\n@deepdiver1975 i've created new pull request #3318, but it doesn't pass tests. please consider changing of general slugify rules (core / tests / lib / files / mapper.php). slugify function is executed just on strings (without folder/file recognition). \r\n\r\nfor example:\r\n\r\n$this->assertequals('d:/a/b/text-text.txt', $this->mapper->slugifypath('d:/a/b/text.text.txt'));\r\n\r\nit looks ok when text.text.txt is a file, but not ok when it is a folder. real folders path on the disk is \"d:/a/b/text-text.txt\", but when you try to create something inside it, lik \"d:/a/b/text-text.txt/something.txt\" the path is sligufied again results is of \"d:/a/b/text-text_txt/something.txt\" so on windows something.txt can't be created because parent folder (\"d:/a/b/text-text_txt\") hasn't been created before.\r\n\r\nmy proposal is (like in my pull request #3318) is to allow dots in the real paths in general, except parts of paths (foldernames or filenames) with ends with a dosts:\r\n\r\n$text = preg_replace('~\\.+$~', '', $text);\r\n\r\nit will prevent creation of \"..\", \".\", \"filename..\", \"filename.\", filename...\" etc.\r\n\r\nbefore operations on the file with an extension i've added condition of checking wheather filename and extension are not empty. because usually names \".something\" or \"..something\" are names of folders not files with empty filename with the extension like \"something\".\r\n\r\n\r\n\r\n\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/17793594","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-17793594","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":17793594,"user":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"created_at":"2013-05-13t05:37:43z","updated_at":"2013-05-13t05:37:43z","body":"thanks a lot for digging into this.\nbest would be to allow dots in general.\n\n\n\n\n-------- ursprã¼ngliche nachricht --------\nvon: infoneo <notifications@github.com> \ndatum:  \nan: owncloud/core <core@noreply.github.com> \ncc: thomas mã¼ller <thomas.mueller@tmit.eu> \nbetreff: re: [core] fixed problems with a dots in a filenames - issue #2875 (#3310) \n \n@deepdiver1975 i've created new pull request #3318, but it doesn't pass tests. please consider changing of general slugify rules (core / tests / lib / files / mapper.php). slugify function is executed just on strings (without folder/file recognition).\n\nfor example:\n\n$this->assertequals('d:/a/b/text-text.txt', $this->mapper->slugifypath('d:/a/b/text.text.txt'));\n\nit looks ok when text.text.txt is a file, but not ok when it is a folder. real folders path on the disk is \"d:/a/b/text-text.txt\", but when you try to create something inside it, lik \"d:/a/b/text-text.txt/something.txt\" the path is sligufied again results is of \"d:/a/b/text-text_txt/something.txt\" so on windows something.txt can't be created because parent folder (\"d:/a/b/text-text_txt\") hasn't been created before.\n\nmy proposal is (like in my pull request #3318) is to allow dots in the real paths in general, except parts of paths (foldernames or filenames) with ends with a dosts:\n\n$text = preg_replace('~.+$~', '', $text);\n\nit will prevent creation of \"..\", \".\", \"filename..\", \"filename.\", filename...\" etc.\n\nbefore operations on the file with an extension i've added condition of checking wheather filename and extension are not empty. because usually names \".something\" or \"..something\" are names of folders not files with empty filename with the extension like \"something\".\n\nâ€”\nreply to this email directly or view it on github."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/18445187","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-18445187","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":18445187,"user":{"login":"eisblubb","id":4526239,"avatar_url":"https://gravatar.com/avatar/6e4eab2b8f8ef6f2b9f77008d59c6359?d=https%3a%2f%2fidenticons.github.com%2f3e1ca291307cbe1722b9fef1174160b7.png&r=x","gravatar_id":"6e4eab2b8f8ef6f2b9f77008d59c6359","url":"https://api.github.com/users/eisblubb","html_url":"https://github.com/eisblubb","followers_url":"https://api.github.com/users/eisblubb/followers","following_url":"https://api.github.com/users/eisblubb/following{/other_user}","gists_url":"https://api.github.com/users/eisblubb/gists{/gist_id}","starred_url":"https://api.github.com/users/eisblubb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eisblubb/subscriptions","organizations_url":"https://api.github.com/users/eisblubb/orgs","repos_url":"https://api.github.com/users/eisblubb/repos","events_url":"https://api.github.com/users/eisblubb/events{/privacy}","received_events_url":"https://api.github.com/users/eisblubb/received_events","type":"user","site_admin":false},"created_at":"2013-05-25t10:47:49z","updated_at":"2013-05-25t10:49:06z","body":"@infoneo thank you for your work on this fix. helped me quite a bit. but its apparently incomplete. \r\n\r\ni have discovered additional problems with dots in foldernames. with this fix a folder with a dot in it is accepted and synced as long as it has characters in front and behind it. folders with a dot that have a space in front of it, behind it or both continue to fail.\r\n\r\nfoldername \r\ntest -> syncs\r\ntest.test -> syncs\r\ntest .test -> folder is created, but no files in it sync\r\ntest. test -> folder is created, but no files in it sync\r\ntest . test -> folder is created, but no files in it sync\r\n\r\ni lack the programmer skills to fix this. could someone look into it?\r\n\r\nthank you so much!"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/18445866","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-18445866","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":18445866,"user":{"login":"eisblubb","id":4526239,"avatar_url":"https://gravatar.com/avatar/6e4eab2b8f8ef6f2b9f77008d59c6359?d=https%3a%2f%2fidenticons.github.com%2f3e1ca291307cbe1722b9fef1174160b7.png&r=x","gravatar_id":"6e4eab2b8f8ef6f2b9f77008d59c6359","url":"https://api.github.com/users/eisblubb","html_url":"https://github.com/eisblubb","followers_url":"https://api.github.com/users/eisblubb/followers","following_url":"https://api.github.com/users/eisblubb/following{/other_user}","gists_url":"https://api.github.com/users/eisblubb/gists{/gist_id}","starred_url":"https://api.github.com/users/eisblubb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eisblubb/subscriptions","organizations_url":"https://api.github.com/users/eisblubb/orgs","repos_url":"https://api.github.com/users/eisblubb/repos","events_url":"https://api.github.com/users/eisblubb/events{/privacy}","received_events_url":"https://api.github.com/users/eisblubb/received_events","type":"user","site_admin":false},"created_at":"2013-05-25t11:45:23z","updated_at":"2013-05-25t11:45:23z","body":"ok, i changed the reg_exp for preg_replace and it seems to work for now, but maybe someone with insight can better judge if i potentially broke something with it. i simply added whitespaces to the ignored chars.\r\n\r\n$text = preg_replace('~[^\\\\pl\\d\\.]+~u', '-', $text); //on windows dots are allowed\r\nchanged to:\r\n$text = preg_replace('~[^\\\\pl\\d\\.\\s]+~u', '-', $text); //on windows dots are allowed"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/19436217","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-19436217","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":19436217,"user":{"login":"mayhem2408","id":4693903,"avatar_url":"https://gravatar.com/avatar/f75b40e4cec2ebbf0c7cf5318a016a4a?d=https%3a%2f%2fidenticons.github.com%2f69c16cb07117a788f8aa61b73adf3969.png&r=x","gravatar_id":"f75b40e4cec2ebbf0c7cf5318a016a4a","url":"https://api.github.com/users/mayhem2408","html_url":"https://github.com/mayhem2408","followers_url":"https://api.github.com/users/mayhem2408/followers","following_url":"https://api.github.com/users/mayhem2408/following{/other_user}","gists_url":"https://api.github.com/users/mayhem2408/gists{/gist_id}","starred_url":"https://api.github.com/users/mayhem2408/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayhem2408/subscriptions","organizations_url":"https://api.github.com/users/mayhem2408/orgs","repos_url":"https://api.github.com/users/mayhem2408/repos","events_url":"https://api.github.com/users/mayhem2408/events{/privacy}","received_events_url":"https://api.github.com/users/mayhem2408/received_events","type":"user","site_admin":false},"created_at":"2013-06-14t02:22:12z","updated_at":"2013-06-14t02:22:12z","body":"can someone explain to me why this was added to v5.0. v4.5 did not rename files or folders and i never had a problems. v5.0 causes a lot of headaches with folder names having dots and spaces in them.\r\n\r\nfor now, i have completely disabled the file renaming in the mapper.php\r\n\r\nin version 5.0.6 and 5.0.7, i did the following (lines numbers may change in later versions)\r\ncommented out line 217 \r\n//$text = preg_replace('~[^\\\\pl\\d]+~u', '-', $text);\r\n\r\ncommented out line 223-225\r\n//if (function_exists('iconv')) {\r\n//\t$text = iconv('utf-8', 'us-ascii//translit//ignore', $text);\r\n//}\r\n\r\ncommented out line 228\r\n//$text = strtolower($text);\r\n\r\ncommented out line 231\r\n//$text = preg_replace('~[^-\\w]+~', '', $text);\r\n\r\nthese four changes have disabled all the file and folder renaming that is going on. \r\nwarning: please be warned that if you try this, it must be on a clean install as it causes problems with files and folders that have already been written and renamed by mapper."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/19441132","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-19441132","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":19441132,"user":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"created_at":"2013-06-14t06:22:31z","updated_at":"2013-06-14t06:22:31z","body":"@mayhem2408 sorry for the headaches.\r\n\r\n> can someone explain to me why this was added to v5.0. v4.5 did not rename files or folders and i never had a problems. \r\n\r\nyou never had problems because your filenames most probably contain ascii characters only.\r\njust try to use file names with cyrillic or japanese characters and the trouble starts.\r\nsame for file names which differ only in casing.\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/19442325","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-19442325","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":19442325,"user":{"login":"mayhem2408","id":4693903,"avatar_url":"https://gravatar.com/avatar/f75b40e4cec2ebbf0c7cf5318a016a4a?d=https%3a%2f%2fidenticons.github.com%2f69c16cb07117a788f8aa61b73adf3969.png&r=x","gravatar_id":"f75b40e4cec2ebbf0c7cf5318a016a4a","url":"https://api.github.com/users/mayhem2408","html_url":"https://github.com/mayhem2408","followers_url":"https://api.github.com/users/mayhem2408/followers","following_url":"https://api.github.com/users/mayhem2408/following{/other_user}","gists_url":"https://api.github.com/users/mayhem2408/gists{/gist_id}","starred_url":"https://api.github.com/users/mayhem2408/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayhem2408/subscriptions","organizations_url":"https://api.github.com/users/mayhem2408/orgs","repos_url":"https://api.github.com/users/mayhem2408/repos","events_url":"https://api.github.com/users/mayhem2408/events{/privacy}","received_events_url":"https://api.github.com/users/mayhem2408/received_events","type":"user","site_admin":false},"created_at":"2013-06-14t07:04:44z","updated_at":"2013-06-14t07:04:44z","body":"thanks deepdiver1975, \r\n\r\nyou are correct in that most if not all my files used ascii characters. the problem i have now is that for me, v4.5 never caused a problem. v5.0.x causes me dozens of problems daily because of the file naming problems.\r\n\r\nfrom the webui or webdav, create a folder called \"test v1.0 folder\"\r\nthen again via the webui or webdav, try to create a text file in it. name is not important. v5.0 will not work. v4.5 will work without a problem."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/19442761","html_url":"https://github.com/owncloud/core/pull/3310#issuecomment-19442761","issue_url":"https://api.github.com/repos/owncloud/core/issues/3310","id":19442761,"user":{"login":"deepdiver1975","id":1005065,"avatar_url":"https://gravatar.com/avatar/bdba071ed68da9ce8edae53c364902ef?d=https%3a%2f%2fidenticons.github.com%2f67e101ad9531b7d25697b76e503e062e.png&r=x","gravatar_id":"bdba071ed68da9ce8edae53c364902ef","url":"https://api.github.com/users/deepdiver1975","html_url":"https://github.com/deepdiver1975","followers_url":"https://api.github.com/users/deepdiver1975/followers","following_url":"https://api.github.com/users/deepdiver1975/following{/other_user}","gists_url":"https://api.github.com/users/deepdiver1975/gists{/gist_id}","starred_url":"https://api.github.com/users/deepdiver1975/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepdiver1975/subscriptions","organizations_url":"https://api.github.com/users/deepdiver1975/orgs","repos_url":"https://api.github.com/users/deepdiver1975/repos","events_url":"https://api.github.com/users/deepdiver1975/events{/privacy}","received_events_url":"https://api.github.com/users/deepdiver1975/received_events","type":"user","site_admin":false},"created_at":"2013-06-14t07:18:35z","updated_at":"2013-06-14t07:18:35z","body":"i totally understand your point and it's a real pity the issue with the dots slipped in.\r\n\r\nthis problem has finally been solved now with #3640 in master - backport to stable5 will happen soon and it should be fixed in the 5.0.x"}]