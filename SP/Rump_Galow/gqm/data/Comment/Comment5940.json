[{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29004118","html_url":"https://github.com/owncloud/core/issues/5940#issuecomment-29004118","issue_url":"https://api.github.com/repos/owncloud/core/issues/5940","id":29004118,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-21t17:24:56z","updated_at":"2013-11-21t17:24:56z","body":"it looks like the following is happening:\r\n1. upload a file to a smb storage using a webdav client\r\n2. some part of the oc code will touch/create an empty file first\r\n3. some part of the oc code calls stat() and see that the file exists\r\n4. webdav client asks for overwrite\r\n5. if you don't confirm, the file will stay empty. if you confirm overwrite, the file will correctly be uploaded.\r\n\r\nneeds further investigation."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29004310","html_url":"https://github.com/owncloud/core/issues/5940#issuecomment-29004310","issue_url":"https://api.github.com/repos/owncloud/core/issues/5940","id":29004310,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-21t17:26:57z","updated_at":"2013-11-21t17:26:57z","body":"additional info: at step 3 the file doesn't really exist, but something is writing it already into the cache."},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29005230","html_url":"https://github.com/owncloud/core/issues/5940#issuecomment-29005230","issue_url":"https://api.github.com/repos/owncloud/core/issues/5940","id":29005230,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-21t17:37:06z","updated_at":"2013-11-21t17:37:06z","body":"ok, so it looks like kde's dolphin is doing a propfind first to see whether the file exists, and that triggers scanfile() on that file that doesn't exist yet, and for some reason it's being added into the cache with a size of zero !\r\n\r\nneed to find out why the find is \"found\" during explicit file scan, might be related to the smb impl.\r\n"},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29005665","html_url":"https://github.com/owncloud/core/issues/5940#issuecomment-29005665","issue_url":"https://api.github.com/repos/owncloud/core/issues/5940","id":29005665,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-21t17:42:12z","updated_at":"2013-11-21t17:42:12z","body":"i tried to debug the same path when uploading to the home storage using webdav.\r\nin that case the propfind is done as well on the non-existing file (to find out whether we'd overwrite something) and then scanner->getdata() fails on isreadable() because the file doesn't exist. bingo!\r\n\r\nbut in the smb impl isreadable() always returns true. which means that every ext storage impl that have isreadable() returning true will have this issue!\r\n\r\nanother weird thing is that isreadable() will spam the log with messages like:\r\n{\"app\":\"oc\\\\files\\\\cache\\\\scanner\",\"message\":\"!!! path 'files\\/tagesessen.pdf' is not readable !!!\",\"level\":0,\"time\":\"2013-11-21t17:40:21+00:00\"}\r\n\r\neither the \"file doesn't exist\" case needs to be detected earlier when running scan() directly on a file, or isreadable needs to be implemented correctly everywhere.\r\n\r\ni'll try to modify the extstorage streamwrapper's isreadable() to use stat() to check if a file exists at all.\r\n\r\ncc @icewind1991 "},{"url":"https://api.github.com/repos/owncloud/core/issues/comments/29300172","html_url":"https://github.com/owncloud/core/issues/5940#issuecomment-29300172","issue_url":"https://api.github.com/repos/owncloud/core/issues/5940","id":29300172,"user":{"login":"pvince81","id":277525,"avatar_url":"https://gravatar.com/avatar/e446b529679416eb70eafb4ca4da5bbe?d=https%3a%2f%2fidenticons.github.com%2f89d7c394e6dcdf87a91c75ac3b2ccbe8.png&r=x","gravatar_id":"e446b529679416eb70eafb4ca4da5bbe","url":"https://api.github.com/users/pvince81","html_url":"https://github.com/pvince81","followers_url":"https://api.github.com/users/pvince81/followers","following_url":"https://api.github.com/users/pvince81/following{/other_user}","gists_url":"https://api.github.com/users/pvince81/gists{/gist_id}","starred_url":"https://api.github.com/users/pvince81/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pvince81/subscriptions","organizations_url":"https://api.github.com/users/pvince81/orgs","repos_url":"https://api.github.com/users/pvince81/repos","events_url":"https://api.github.com/users/pvince81/events{/privacy}","received_events_url":"https://api.github.com/users/pvince81/received_events","type":"user","site_admin":false},"created_at":"2013-11-26t15:17:18z","updated_at":"2013-11-26t15:17:18z","body":"backported to stable5 as acd9ea7b2b0595afcc974ea3758e86d5f19cc148"}]